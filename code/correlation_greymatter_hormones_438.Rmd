---
title: "T2 Subfields and Hormones Correlations with Subject 438"
author: "Shuying Yu and Caitlin Taylor"
date: "08/24/2022"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 5
    theme: flatly
---

```{r setup, include = FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.align = "center")

#Attach libraries
library(tidyverse)
library(here)
library(janitor)
library(ggpubr)
library(patchwork)
library(readxl)
```


# Overview

This report provides exploratory and preliminary correlation analyses between sex hormones and T2 *unretouched*, raw hippocampal subfield data from the Healthy Aging Study sample (subjects 333 - 437, including 438). 

Black diamond point are the group means. Highlighted in purple triangle point and purple line is subject 438.

Cleaning data steps included:

1) Filter participants that have T2 subfield data from scan
2) Select sex hormone measures from when scan was conducted
3) Correct left and right volumes with TIV
3) Average left and right volumes to get an average measure for each subfield region


```{r data_wrangling}
########## Data 

#Read in the data
df <- read_xlsx(here("data", "HASHippDenoise_ASHS_raw.xlsx"))

#Add in 438 age and sex
df[106, 2] <- 64
df[106, 3] <- "Female"
df[106, 4] <- "Post"

#Clean columns and rest of data
#Remove rows after 438, rename x1 to subject_id as index
df <- clean_names(df) %>% 
  rename(subject_id = x1,
         repo_status = pre_peri_post) %>% 
  mutate(sex = recode(sex, 
                      "F" = "Female",
                      "M" = "Male")) %>% 
  drop_na(age, sex) %>% 
  slice(-c(108:112))


########## Correct using TIV, then average left and right


##### T2hipp

#Convert rca1 to numeric
df$rca1 <- as.numeric(df$rca1)

#Create function for apply to variables
dividebyTIV <- function(x, na.rm = FALSE) (x/df$tiv)

#Apply function to variables
df_avg <- df %>% 
  
  #Correct using TIV from SPM
  #CA1, CA23, DG, ERC,PHC, PRC, SUB
  mutate_at(vars(lca1:rsub),
            dividebyTIV) %>% 
  
  #Average left and right regions
  mutate(avg_ca1 = (lca1 + rca1)/2,
         avg_ca23 = (lca23 + rca23)/2,
         avg_dg = (ldg + rdg)/2,
         avg_erc = (lerc + rerc)/2,
         avg_phc = (lphc + rphc)/2,
         avg_prc = (lprc + rprc)/2,
         avg_sub = (lsub + rsub)/2)


#Save 438 as own df and clean the rest without her
df_438 <- df_avg[88,]
df_clean <- df_avg[-88,]

#Subset for women by repo status
df_clean_repo <- df_clean %>% 
  filter(sex == "Female") %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post")))
```



# T2 Subfield Volume {.tabset}

## CA1 

Subject 438: average volume of 0.545094

### Structural Comparison

```{r}
#Reproductive status
p1 <- ggplot(data = df_clean_repo, aes(y = avg_ca1,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged CA1 \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") +
   #Add 438
  geom_point(aes(x = factor("Post"), y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Sex
p2 <- ggplot(data = df_clean, aes(y = avg_ca1,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged CA1 \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") +
      #Add 438
  geom_point(aes(x = factor("Female"), y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Total
p3 <- ggplot(data = df_clean, aes(x = avg_ca1)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average CA1 Subfield Volume",
       y = "Count",
       title = "Total") +
  #Add 438 
  geom_vline(aes(xintercept = df_438$avg_ca1), color = "purple", size = 1.5)


#Combine
(p1+p2)/p3
```


### Hormone Correlation by Reproductive Status

```{r}
#Estradiol
c1 <- ggscatter(df_clean_repo, x = "estradiol_pg_m_l", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged CA1 Subfield Volume") +
    geom_point(aes(x = df_438$estradiol_pg_m_l, y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Progesterone
c2 <- ggscatter(df_clean_repo, x = "progesterone_ng_m_l", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged CA1 Subfield Volume") +
    geom_point(aes(x = df_438$progesterone_ng_m_l, y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#FSH
c3 <- ggscatter(df_clean_repo, x = "fsh_m_iu_m_l", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged CA1 Subfield Volume") +
    geom_point(aes(x = df_438$fsh_m_iu_m_l, y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#SHBG
c4 <- ggscatter(df_clean_repo, x = "shbg_nmol_l", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA1 Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c5 <- ggscatter(df_clean_repo, x = "dhea_s_ug_d_l", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA1 Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Testosterone
c6 <- ggscatter(df_clean_repo, x = "total_testosterone_ng_d_l", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged CA1 Subfield Volume") +
    geom_point(aes(x = df_438$total_testosterone_ng_d_l, y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
(c3+c4)
(c5+c6)
```


### Hormone Correlation by Reproductive Sex

```{r}
#SHBG
c1 <- ggscatter(df_clean, x = "shbg_nmol_l", y = "avg_ca1", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA1 Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c2 <- ggscatter(df_clean, x = "dhea_s_ug_d_l", y = "avg_ca1", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA1 Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_ca1),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
```





## CA2/3

Subject 438: average volume of 0.2098802

### Structural Comparison

```{r}
#Reproductive status
p1 <- ggplot(data = df_clean_repo, aes(y = avg_ca23,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged CA23 \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") +
   #Add 438
  geom_point(aes(x = factor("Post"), y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Sex
p2 <- ggplot(data = df_clean, aes(y = avg_ca23,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged CA23 \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") +
      #Add 438
  geom_point(aes(x = factor("Female"), y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Total
p3 <- ggplot(data = df_clean, aes(x = avg_ca23)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average CA23 Subfield Volume",
       y = "Count",
       title = "Total") +
  #Add 438 
  geom_vline(aes(xintercept = df_438$avg_ca23), color = "purple", size = 1.5)


#Combine
(p1+p2)/p3
```


### Hormone Correlation by Reproductive Status

```{r}
#Estradiol
c1 <- ggscatter(df_clean_repo, x = "estradiol_pg_m_l", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged CA23 Subfield Volume") +
    geom_point(aes(x = df_438$estradiol_pg_m_l, y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Progesterone
c2 <- ggscatter(df_clean_repo, x = "progesterone_ng_m_l", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged CA23 Subfield Volume") +
    geom_point(aes(x = df_438$progesterone_ng_m_l, y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#FSH
c3 <- ggscatter(df_clean_repo, x = "fsh_m_iu_m_l", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged CA23 Subfield Volume") +
    geom_point(aes(x = df_438$fsh_m_iu_m_l, y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#SHBG
c4 <- ggscatter(df_clean_repo, x = "shbg_nmol_l", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA23 Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c5 <- ggscatter(df_clean_repo, x = "dhea_s_ug_d_l", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA23 Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Testosterone
c6 <- ggscatter(df_clean_repo, x = "total_testosterone_ng_d_l", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged CA23 Subfield Volume") +
    geom_point(aes(x = df_438$total_testosterone_ng_d_l, y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
(c3+c4)
(c5+c6)
```


### Hormone Correlation by Reproductive Sex

```{r}
#SHBG
c1 <- ggscatter(df_clean, x = "shbg_nmol_l", y = "avg_ca23", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA23 Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c2 <- ggscatter(df_clean, x = "dhea_s_ug_d_l", y = "avg_ca23", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA23 Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_ca23),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)



#Present as patchwork
(c1+c2)
```



## DG

Subject 438: average volume of 0.6703311

### Structural Comparison

```{r}
#Reproductive status
p1 <- ggplot(data = df_clean_repo, aes(y = avg_dg,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged DG \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") +
   #Add 438
  geom_point(aes(x = factor("Post"), y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Sex
p2 <- ggplot(data = df_clean, aes(y = avg_dg,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged DG \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") +
      #Add 438
  geom_point(aes(x = factor("Female"), y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Total
p3 <- ggplot(data = df_clean, aes(x = avg_dg)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average DG Subfield Volume",
       y = "Count",
       title = "Total") +
  #Add 438 
  geom_vline(aes(xintercept = df_438$avg_dg), color = "purple", size = 1.5)


#Combine
(p1+p2)/p3
```


### Hormone Correlation by Reproductive Status

```{r}
#Estradiol
c1 <- ggscatter(df_clean_repo, x = "estradiol_pg_m_l", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged DG Subfield Volume") +
    geom_point(aes(x = df_438$estradiol_pg_m_l, y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Progesterone
c2 <- ggscatter(df_clean_repo, x = "progesterone_ng_m_l", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged DG Subfield Volume") +
    geom_point(aes(x = df_438$progesterone_ng_m_l, y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#FSH
c3 <- ggscatter(df_clean_repo, x = "fsh_m_iu_m_l", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged DG Subfield Volume") +
    geom_point(aes(x = df_438$fsh_m_iu_m_l, y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#SHBG
c4 <- ggscatter(df_clean_repo, x = "shbg_nmol_l", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged DG Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c5 <- ggscatter(df_clean_repo, x = "dhea_s_ug_d_l", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged DG Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Testosterone
c6 <- ggscatter(df_clean_repo, x = "total_testosterone_ng_d_l", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged DG Subfield Volume") +
    geom_point(aes(x = df_438$total_testosterone_ng_d_l, y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
(c3+c4)
(c5+c6)
```


### Hormone Correlation by Reproductive Sex

```{r}
#SHBG
c1 <- ggscatter(df_clean, x = "shbg_nmol_l", y = "avg_dg", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged DG Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c2 <- ggscatter(df_clean, x = "dhea_s_ug_d_l", y = "avg_dg", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged DG Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_dg),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)



#Present as patchwork
(c1+c2)
```












## ERC

Subject 438: average volume of 0.4225437

### Structural Comparison

```{r}
#Reproductive status
p1 <- ggplot(data = df_clean_repo, aes(y = avg_erc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged ERC \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") +
   #Add 438
  geom_point(aes(x = factor("Post"), y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Sex
p2 <- ggplot(data = df_clean, aes(y = avg_erc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged ERC \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") +
      #Add 438
  geom_point(aes(x = factor("Female"), y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Total
p3 <- ggplot(data = df_clean, aes(x = avg_erc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average ERC Subfield Volume",
       y = "Count",
       title = "Total") +
  #Add 438 
  geom_vline(aes(xintercept = df_438$avg_erc), color = "purple", size = 1.5)


#Combine
(p1+p2)/p3
```


### Hormone Correlation by Reproductive Status

```{r}
#Estradiol
c1 <- ggscatter(df_clean_repo, x = "estradiol_pg_m_l", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged ERC Subfield Volume") +
    geom_point(aes(x = df_438$estradiol_pg_m_l, y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Progesterone
c2 <- ggscatter(df_clean_repo, x = "progesterone_ng_m_l", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged ERC Subfield Volume") +
    geom_point(aes(x = df_438$progesterone_ng_m_l, y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#FSH
c3 <- ggscatter(df_clean_repo, x = "fsh_m_iu_m_l", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged ERC Subfield Volume") +
    geom_point(aes(x = df_438$fsh_m_iu_m_l, y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#SHBG
c4 <- ggscatter(df_clean_repo, x = "shbg_nmol_l", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged ERC Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c5 <- ggscatter(df_clean_repo, x = "dhea_s_ug_d_l", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged ERC Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Testosterone
c6 <- ggscatter(df_clean_repo, x = "total_testosterone_ng_d_l", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged ERC Subfield Volume") +
    geom_point(aes(x = df_438$total_testosterone_ng_d_l, y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
(c3+c4)
(c5+c6)
```


### Hormone Correlation by Reproductive Sex

```{r}
#SHBG
c1 <- ggscatter(df_clean, x = "shbg_nmol_l", y = "avg_erc", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged ERC Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c2 <- ggscatter(df_clean, x = "dhea_s_ug_d_l", y = "avg_erc", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged ERC Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_erc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
```



## PHC

Subject 438: average volume of 1.432311

### Structural Comparison

```{r}
#Reproductive status
p1 <- ggplot(data = df_clean_repo, aes(y = avg_phc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged PHC \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") +
   #Add 438
  geom_point(aes(x = factor("Post"), y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Sex
p2 <- ggplot(data = df_clean, aes(y = avg_phc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged PHC \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") +
      #Add 438
  geom_point(aes(x = factor("Female"), y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Total
p3 <- ggplot(data = df_clean, aes(x = avg_phc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average PHC Subfield Volume",
       y = "Count",
       title = "Total") +
  #Add 438 
  geom_vline(aes(xintercept = df_438$avg_phc), color = "purple", size = 1.5)


#Combine
(p1+p2)/p3
```


### Hormone Correlation by Reproductive Status

```{r}
#Estradiol
c1 <- ggscatter(df_clean_repo, x = "estradiol_pg_m_l", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged PHC Subfield Volume") +
    geom_point(aes(x = df_438$estradiol_pg_m_l, y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Progesterone
c2 <- ggscatter(df_clean_repo, x = "progesterone_ng_m_l", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged PHC Subfield Volume") +
    geom_point(aes(x = df_438$progesterone_ng_m_l, y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#FSH
c3 <- ggscatter(df_clean_repo, x = "fsh_m_iu_m_l", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged PHC Subfield Volume") +
    geom_point(aes(x = df_438$fsh_m_iu_m_l, y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#SHBG
c4 <- ggscatter(df_clean_repo, x = "shbg_nmol_l", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PHC Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c5 <- ggscatter(df_clean_repo, x = "dhea_s_ug_d_l", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PHC Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Testosterone
c6 <- ggscatter(df_clean_repo, x = "total_testosterone_ng_d_l", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged PHC Subfield Volume") +
    geom_point(aes(x = df_438$total_testosterone_ng_d_l, y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
(c3+c4)
(c5+c6)
```


### Hormone Correlation by Reproductive Sex

```{r}
#SHBG
c1 <- ggscatter(df_clean, x = "shbg_nmol_l", y = "avg_phc", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PHC Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c2 <- ggscatter(df_clean, x = "dhea_s_ug_d_l", y = "avg_phc", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PHC Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_phc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
```



## PRC

Subject 438: average volume of 1.574246

### Structural Comparison

```{r}
#Reproductive status
p1 <- ggplot(data = df_clean_repo, aes(y = avg_prc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged PRC Subfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") +
   #Add 438
  geom_point(aes(x = factor("Post"), y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Sex
p2 <- ggplot(data = df_clean, aes(y = avg_prc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged PRC Subfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") +
      #Add 438
  geom_point(aes(x = factor("Female"), y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Total
p3 <- ggplot(data = df_clean, aes(x = avg_prc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average PRC Subfield Volume",
       y = "Count",
       title = "Total") +
  #Add 438 
  geom_vline(aes(xintercept = df_438$avg_prc), color = "purple", size = 1.5)


#Combine
(p1+p2)/p3
```


### Hormone Correlation by Reproductive Status

```{r}
#Estradiol
c1 <- ggscatter(df_clean_repo, x = "estradiol_pg_m_l", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged PRC Subfield Volume") +
    geom_point(aes(x = df_438$estradiol_pg_m_l, y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Progesterone
c2 <- ggscatter(df_clean_repo, x = "progesterone_ng_m_l", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged PRC Subfield Volume") +
    geom_point(aes(x = df_438$progesterone_ng_m_l, y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#FSH
c3 <- ggscatter(df_clean_repo, x = "fsh_m_iu_m_l", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged PRC Subfield Volume") +
    geom_point(aes(x = df_438$fsh_m_iu_m_l, y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#SHBG
c4 <- ggscatter(df_clean_repo, x = "shbg_nmol_l", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PRC Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c5 <- ggscatter(df_clean_repo, x = "dhea_s_ug_d_l", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PRC Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Testosterone
c6 <- ggscatter(df_clean_repo, x = "total_testosterone_ng_d_l", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged PRC Subfield Volume") +
    geom_point(aes(x = df_438$total_testosterone_ng_d_l, y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
(c3+c4)
(c5+c6)
```


### Hormone Correlation by Reproductive Sex

```{r}
#SHBG
c1 <- ggscatter(df_clean, x = "shbg_nmol_l", y = "avg_prc", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PRC Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c2 <- ggscatter(df_clean, x = "dhea_s_ug_d_l", y = "avg_prc", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PRC Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Testosterone
c3 <- ggscatter(df_clean, x = "total_testosterone_ng_d_l", y = "avg_prc", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged PRC Subfield Volume") +
    geom_point(aes(x = df_438$total_testosterone_ng_d_l, y= df_438$avg_prc),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2+c3)
```




## SUB

Subject 438: average volume of 0.3014333

### Structural Comparison

```{r}
#Reproductive status
p1 <- ggplot(data = df_clean_repo, aes(y = avg_sub,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged SUB \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") +
   #Add 438
  geom_point(aes(x = factor("Post"), y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Sex
p2 <- ggplot(data = df_clean, aes(y = avg_sub,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged SUB \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") +
      #Add 438
  geom_point(aes(x = factor("Female"), y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Total
p3 <- ggplot(data = df_clean, aes(x = avg_sub)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average SUB Subfield Volume",
       y = "Count",
       title = "Total") +
  #Add 438 
  geom_vline(aes(xintercept = df_438$avg_sub), color = "purple", size = 1.5)


#Combine
(p1+p2)/p3
```


### Hormone Correlation by Reproductive Status

```{r}
#Estradiol
c1 <- ggscatter(df_clean_repo, x = "estradiol_pg_m_l", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged SUB Subfield Volume") +
    geom_point(aes(x = df_438$estradiol_pg_m_l, y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#Progesterone
c2 <- ggscatter(df_clean_repo, x = "progesterone_ng_m_l", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged SUB Subfield Volume") +
    geom_point(aes(x = df_438$progesterone_ng_m_l, y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#FSH
c3 <- ggscatter(df_clean_repo, x = "fsh_m_iu_m_l", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged SUB Subfield Volume") +
    geom_point(aes(x = df_438$fsh_m_iu_m_l, y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)

#SHBG
c4 <- ggscatter(df_clean_repo, x = "shbg_nmol_l", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged SUB Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c5 <- ggscatter(df_clean_repo, x = "dhea_s_ug_d_l", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged SUB Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Testosterone
c6 <- ggscatter(df_clean_repo, x = "total_testosterone_ng_d_l", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged SUB Subfield Volume") +
    geom_point(aes(x = df_438$total_testosterone_ng_d_l, y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
(c3+c4)
(c5+c6)
```


### Hormone Correlation by Reproductive Sex

```{r}
#SHBG
c1 <- ggscatter(df_clean, x = "shbg_nmol_l", y = "avg_sub", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged SUB Subfield Volume") +
    geom_point(aes(x = df_438$shbg_nmol_l, y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#DHEAS
c2 <- ggscatter(df_clean, x = "dhea_s_ug_d_l", y = "avg_sub", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged SUB Subfield Volume") +
    geom_point(aes(x = df_438$dhea_s_ug_d_l, y= df_438$avg_sub),
             color = "purple", shape = 17, size = 3,
             show.legend = FALSE)


#Present as patchwork
(c1+c2)
```






## {-}


# Summary

Initial findings include:

...






