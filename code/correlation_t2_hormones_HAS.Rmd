---
title: "Study 2, part 2: T2 Subfields and Hormones Correlations"
author: "Shuying Yu and Caitlin Taylor"
date: "08/24/2022"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 6
    theme: flatly
---


```{r setup, include = FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, include = FALSE,
                      warning = FALSE, message = FALSE, fig.align = "center")

#Attach libraries
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(ggpubr)
library(patchwork)
library(readxl)
library(knitr)
library(broom)
library(purrr)
```


*Modified on:* February 28th, 2023

# Overview

This report provides exploratory and preliminary correlation analyses between sex hormones and T2 *final* hippocampal subfield volume data from the Healthy Aging Study sample (ALL). 

**Cleaning data steps included (T2 subfields):**

1) Filter participants that have useable T2 subfield data from scan and completed spatial navigation behavior

2) Select sex hormone measures from when spatial study was conducted

3) Values were already averaged together (left and right) and already corrected with TIV

For left and right subfields, they have already been corrected with TIV


**Calculating Total Hippocampal Volume:**

- Sum up the averaged CA1, CA23, DG, SUB to get T2 total hippocampal volumes

- Left and right volumes are by adding respective left and right subfields


**Calculating Total MTL:**

- Sum up the averaged CA1, CA23, DG, SUB, ERC, PHC, PRC to get MTL volume

- Left and right volumes are by adding respective left and right subfields

```{r overall-HAS check}
#Read in the data
data <- read_csv(here("data", "HAS_SNAG_mastersheet_tidy.csv"))

#Filter for t1 data
data <- data %>% 
  filter(age_group == "Midlife") %>% 
  dplyr::select(subject_id, sex, 
         age_scan_years:testosterone_spatial_ng_dl) %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post", "Men")))
  #Further exclude these subjects:
  #filter(!subject_id %in% c(
    #"309", #bad participant
    #"316", #vertigo/took Wellbutrin for mood and Lipitor for cholesterol 7 days/week of scan
    # "329", #on prednisone 7 days/week of scan
    #"352", #current MDD/depression
    # "372" #past neuroschistosomiasis at 24 years old))

data %>% 
  group_by(repo_status) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years, na.rm=TRUE),
            age_Sd = sd(age_spatial_years, na.rm=TRUE))
```



```{r t1-check}
#Read in the data
data <- read_csv(here("data", "HAS_SNAG_mastersheet_tidy.csv"))

#Filter for t1 data
data <- data %>% 
  filter(age_group == "Midlife", 
         t1_status == "Yes") %>% 
  dplyr::select(subject_id, sex, t1_status,
         age_scan_years:testosterone_spatial_ng_dl) %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post", "Men"))) %>% 
  #Further exclude these subjects:
  filter(!subject_id %in% c(
    #"309", #bad participant
    #"316", #vertigo/took Wellbutrin for mood and Lipitor for cholesterol 7 days/week of scan
     "329", #on prednisone 7 days/week of scan
    #"352", #current MDD/depression
     "372" #past neuroschistosomiasis at 24 years old
  ))


#Subset for women by repo status
data_repo <- data %>% 
  filter(sex == "Female") %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post")))

#Subset for men
data_men <- data %>% 
  filter(sex == "Male")
```


```{r dsi-check}
#Read in the data
data <- read_csv(here("data", "HAS_SNAG_mastersheet_tidy.csv"))

#Filter for dsi data
data <- data %>% 
  filter(age_group == "Midlife", 
         dsi_status == "Yes") %>% 
  dplyr::select(subject_id, sex, dsi_status,
         age_scan_years:testosterone_spatial_ng_dl) %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post", "Men"))) %>% 
  #Further exclude these subjects:
  filter(!subject_id %in% c(
    #"309", #bad participant
    #"316", #vertigo/took Wellbutrin for mood and Lipitor for cholesterol 7 days/week of scan
     "329", #on prednisone 7 days/week of scan
    #"352", #current MDD/depression
     "372" #past neuroschistosomiasis at 24 years old
  ))


#Subset for women by repo status
data_repo <- data %>% 
  filter(sex == "Female") %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post")))

#Subset for men
data_men <- data %>% 
  filter(sex == "Male")


#Table overall
tab_overall <- data %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years))

#Table LOOP
tab_loop <- data %>% 
  filter(loop_useable == "Yes") %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years))

#Table MAZE
tab_maze <- data %>% 
  filter(maze_useable == "Yes") %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years))


#Table DSP
tab_dsp <- data %>% 
  filter(dsp_useable == "Yes") %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years))


#Join df based on sex
tab1 <- merge(tab_overall, tab_loop, by = "sex")

#Rename columns
tab1 <- tab1 %>% 
  rename(n_subject_overall = n_subject.x,
         age_mean_overall = age_mean.x,
         age_sd_overall = age_Sd.x,
         n_subject_loop = n_subject.y,
         age_mean_loop = age_mean.y,
         age_sd_loop = age_Sd.y)

#Rest of the merge
tab2 <- merge(tab1, tab_maze, by = "sex")
tab_final <- merge(tab2, tab_dsp, by = "sex")


#Rename columns
tab_final <- tab_final %>% 
  rename(n_subject_maze = n_subject.x,
         age_mean_maze = age_mean.x,
         age_sd_maze = age_Sd.x,
         n_subject_dsp = n_subject.y,
         age_mean_dsp = age_mean.y,
         age_sd_dsp = age_Sd.y)

#Kable presentation (ideal if we had all hormones)
tab_final %>% 
  kable(col.names = c("Sex", "n","Mean Age","SD Age",
                      "n","Mean Age","SD Age",
                      "n","Mean Age","SD Age",
                      "n","Mean Age","SD Age"),
        caption = "Sample size and age for women and men grouped by overall completion of spatial navigation behavior with useable DSI data.",
        digits = 2,
        align = c("l", rep("c", times = 11))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12) %>%
  add_header_above(c(" " = 1, "Overall" = 3, 
                     "LOOP" = 3, "MAZE" = 3, "DSP" = 3))

```


```{r data_wrangling}
########## Data 

#Read in the data
data <- read_csv(here("data", "HAS_SNAG_mastersheet_tidy.csv"))

#Filter for midlife, has spatial, has t2hipp data that is useable
data <- data %>% 
  filter(age_group == "Midlife", 
         t2hipp_useable == "Yes") %>% 
  dplyr::select(subject_id, sex, 
         age_scan_years:testosterone_spatial_ng_dl,
         t2hipp_vol_avg_ca1:t2hipp_vol_avg_sub,
         t2hipp_vol_left_ca1:t2hipp_vol_right_sub,
         t1_vbm_tiv) %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post", "Men"))) %>% 
  
  #Further exclude this subject:
  filter(!subject_id %in% c(
    #"309", #bad participant
    #"316", #vertigo/took Wellbutrin for mood and Lipitor for cholesterol 7 days/week of scan
     "329", #on prednisone 7 days/week of scan
    #"352", #current MDD/depression
     "372" #past neuroschistosomiasis at 24 years old
  ))


########## Create T2 total hipp and MTL volumes
data <- data %>% 
  
  #Rename columns
  rename(avg_ca1 = t2hipp_vol_avg_ca1,
         avg_ca23 = t2hipp_vol_avg_ca23,
         avg_dg = t2hipp_vol_avg_dg,
         avg_erc = t2hipp_vol_avg_erc,
         avg_phc = t2hipp_vol_avg_phc,
         avg_prc = t2hipp_vol_avg_prc,
         avg_sub = t2hipp_vol_avg_sub) %>% 
  
  #Rename left and right subfields
  rename(left_ca1 = t2hipp_vol_left_ca1,
         right_ca1 = t2hipp_vol_right_ca1,
         left_ca23 = t2hipp_vol_left_ca23,
         right_ca23 = t2hipp_vol_right_ca23,
         left_dg = t2hipp_vol_left_dg,
         right_dg = t2hipp_vol_right_dg,
         left_erc = t2hipp_vol_left_erc,
         right_erc = t2hipp_vol_right_erc,
         left_phc = t2hipp_vol_left_phc,
         right_phc = t2hipp_vol_right_phc,
         left_prc = t2hipp_vol_left_prc,
         right_prc = t2hipp_vol_right_prc,
         left_sub = t2hipp_vol_left_sub,
         right_sub = t2hipp_vol_right_sub) %>% 
  
  #Create T2 total hipp and MTL, averaged and L/R
  mutate(avg_total_hipp = avg_ca1 + avg_ca23 + avg_dg + avg_sub,
         left_total_hipp = left_ca1 + left_ca23 + left_dg + left_sub,
         right_total_hipp = right_ca1 + right_ca23 + right_dg + right_sub,
         
         avg_mtl = avg_ca1 + avg_ca23 + avg_dg + avg_sub + avg_erc + avg_phc + avg_prc,
         left_mtl = left_ca1 + left_ca23 + left_dg + left_sub + left_erc + left_phc + left_prc + left_sub,
         right_mtl = right_ca1 + right_ca23 + right_dg + right_sub + right_erc + right_phc + right_prc + right_sub)


########## Correct using TIV, then average left and right

##### T2hipp

# #Create function for apply to variables
# #t2hipp_vol_tiv
# dividebyTIV <- function(x, na.rm = FALSE) (x/data$t1_vbm_tiv)
# 
# #Correct left and right volumes with TIV
# data <- data %>% 
#   
#   #Correct using TIV from SPM
#   #CA1, CA23, DG, ERC,PHC, PRC, SUB, GMV
#   mutate_at(vars(t2hipp_vol_left_ca1:t2hipp_vol_right_sub),
#             dividebyTIV) %>% 
#   
#   #Average left and right subfields
#   mutate(avg_ca1 = (t2hipp_vol_left_ca1+t2hipp_vol_right_ca1) / 2,
#          avg_ca23 = (t2hipp_vol_left_ca23+t2hipp_vol_right_ca23) / 2,
#          avg_dg = (t2hipp_vol_left_dg+t2hipp_vol_right_dg) / 2,
#          avg_erc = (t2hipp_vol_left_erc+t2hipp_vol_right_erc) / 2,
#          avg_phc = (t2hipp_vol_left_phc+t2hipp_vol_right_phc) / 2,
#          avg_prc = (t2hipp_vol_left_prc+t2hipp_vol_right_prc) / 2,
#          avg_sub = (t2hipp_vol_left_sub+t2hipp_vol_right_sub) / 2) %>% 
#   
#   #Calculate total left and right hipp
#   mutate(total_l_hipp = (t2hipp_vol_left_ca1 + 
#                          t2hipp_vol_left_ca23 +
#                          t2hipp_vol_left_dg + 
#                          t2hipp_vol_left_sub),
#          total_r_hipp = (t2hipp_vol_right_ca1 + 
#                          t2hipp_vol_right_ca23 + 
#                          t2hipp_vol_right_dg + 
#                          t2hipp_vol_right_sub),
#          avg_total_hipp = (total_l_hipp + total_r_hipp)/2) %>% 
#   
#   #Calculate left and right MTL
#   mutate(lmtl = (t2hipp_vol_left_ca1 + 
#                  t2hipp_vol_left_ca23 +
#                  t2hipp_vol_left_dg + 
#                  t2hipp_vol_left_sub + 
#                  t2hipp_vol_left_erc + 
#                  t2hipp_vol_left_phc + 
#                  t2hipp_vol_left_prc),
#          rmtl = (t2hipp_vol_right_ca1 + 
#                  t2hipp_vol_right_ca23 +
#                  t2hipp_vol_right_dg + 
#                  t2hipp_vol_right_sub + 
#                  t2hipp_vol_right_erc + 
#                  t2hipp_vol_right_phc + 
#                  t2hipp_vol_right_prc),
#          avg_mtl = (lmtl + rmtl)/2)


#Subset for women by repo status
data_repo <- data %>% 
  filter(sex == "Female") %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post")))

#Subset for men
data_men <- data %>% 
  filter(sex == "Male")
```


```{r demo-table, include=TRUE, echo=FALSE}
#Table overall
tab_overall <- data %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_scan_years),
            age_Sd = sd(age_scan_years))
tab_overall

#check by repo status
data %>% group_by(repo_status) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_scan_years),
            age_Sd = sd(age_scan_years))
```

Above table shows the table of sample size and mean and standard deviation of age by sex for overall group who have completed spatial behavior and have a useable T2hipp scan.

```{r}
#Women status and useable
test <- read_csv(here("data", "HAS_SNAG_mastersheet_tidy.csv"))

#Women
test <- test %>% 
  filter(age_group == "Midlife", 
         t2hipp_status == "Yes",
         sex == "Female",
         completed_spatial == "Yes") #n = 60
test <- test %>% 
  filter(t2hipp_useable == "Yes") #n=55


#Men
test <- test %>% 
  filter(age_group == "Midlife", 
         t2hipp_status == "Yes",
         sex == "Male",
         completed_spatial == "Yes") #n = 25
test <- test %>% 
  filter(t2hipp_useable == "Yes") #n=22
```


For women, 60 had T2 hipp scan completed and completed an aspect of spatial navigation task but 5 were removed due to poor quality scans. For men, 25 had T2 hipp scan completed and completed an aspect of spatial navigation task but 3 were removed for poor quality scans. Thus *n* = 55 for women and *n* = 22 for men.

All sample size for T2hipp x hormone correlations for women are listed in the table above. For men, because some participants did not have all hormones evaluated (e.g, only testosterone available), the sample size for the correlations for that hormone and with T1 hipp volume will be different.

For men, the accurate sample sizes would be:

- LOOP: *n* = 10 DHEAS, *n* = 11 for SHBG and T

- MAZE: *n* = 13 DHEAS, *n* = 14 for SHBG and T

- DSP: *n* = 18 DHEAS, *n* = 19 for SHBG and T


```{r}
##### WOMEN
#LOOP
test <- data_repo %>% 
  filter(loop_useable == "Yes") %>% 
  select(subject_id,
         estradiol_spatial_pg_ml,
         progesterone_spatial_ng_ml,
         fsh_spatial_miu_ml,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #all n=15

#MAZE
test <- data_repo %>% 
  filter(maze_useable == "Yes") %>% 
  select(subject_id,
         estradiol_spatial_pg_ml,
         progesterone_spatial_ng_ml,
         fsh_spatial_miu_ml,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #all n=45

#DSP
test <- data_repo %>% 
  filter(dsp_useable == "Yes") %>% 
  select(subject_id,
         estradiol_spatial_pg_ml,
         progesterone_spatial_ng_ml,
         fsh_spatial_miu_ml,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #all n=32


#####MEN
#LOOP
test <- data_men %>% 
  filter(loop_useable == "Yes") %>% 
  select(subject_id,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #DHEAS n = 10, SHBG & T n = 11

#MAZE
test <- data_men %>% 
  filter(maze_useable == "Yes") %>% 
  select(subject_id,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #DHEAS n = 13, SHBG & T n = 14

#DSP
test <- data_men %>% 
  filter(dsp_useable == "Yes") %>% 
  select(subject_id,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #DHEAS n = 18, SHBG & T n = 19
```



# Structural Distributions 

```{r shapiro-tests, echo=FALSE, results='hide'}
#is DV significantly difference from normal?


#TotalHipp
shapiro.test(data$avg_total_hipp) #no
shapiro.test(data_repo$avg_total_hipp) #no
shapiro.test(data_men$avg_total_hipp) #no

#MTL
shapiro.test(data$avg_mtl) #no
shapiro.test(data_repo$avg_mtl) #no
shapiro.test(data_men$avg_mtl) #no


#CA1
shapiro.test(data$avg_ca1) #yes
shapiro.test(data_repo$avg_ca1) #yes
shapiro.test(data_men$avg_ca1) #no

#CA23
shapiro.test(data$avg_ca23) #no
shapiro.test(data_repo$avg_ca23) #no
shapiro.test(data_men$avg_ca23) #no

#DG
shapiro.test(data$avg_dg) #no
shapiro.test(data_repo$avg_dg) #no
shapiro.test(data_men$avg_dg) #no

#ERC
shapiro.test(data$avg_erc) #no
shapiro.test(data_repo$avg_erc) #no
shapiro.test(data_men$avg_erc) #no

#PHC
shapiro.test(data$avg_phc) #no
shapiro.test(data_repo$avg_phc) #yes
shapiro.test(data_men$avg_phc) #no

#PRC
shapiro.test(data$avg_prc) #no
shapiro.test(data_repo$avg_prc) #no
shapiro.test(data_men$avg_prc) #no

#SUB
shapiro.test(data$avg_sub) #no
shapiro.test(data_repo$avg_sub) #no
shapiro.test(data_men$avg_sub) #no
```

**Structure:** Shapiro-Wilk's test reveal that total hipp and MTL volumes were normally distributed.

**Subfields:** Shapiro-Wilk's test reveal that CA1 for overall and women, and PHC for women volumes were not normally distributed. Hormone and subfield/volume associations for these subfields will be using Spearman rank correlations.




# Hormone Distributions 

```{r echo=FALSE, results='hide'}
#RAW

#Estradiol
shapiro.test(data$estradiol_spatial_pg_ml) #yes
shapiro.test(data_repo$estradiol_spatial_pg_ml) #yes

#Progesterone
shapiro.test(data$progesterone_spatial_ng_ml) #yes
shapiro.test(data_repo$progesterone_spatial_ng_ml) #yes

#FSH
shapiro.test(data$fsh_spatial_miu_ml) #yes
shapiro.test(data_repo$fsh_spatial_miu_ml) #yes

#DHEAS
shapiro.test(data$dheas_spatial_ug_dl) #yes
shapiro.test(data_repo$dheas_spatial_ug_dl) #yes
shapiro.test(data_men$dheas_spatial_ug_dl) #no

#SHBG
shapiro.test(data$shbg_spatial_nmol_l) #yes
shapiro.test(data_repo$shbg_spatial_nmol_l) #yes
shapiro.test(data_men$shbg_spatial_nmol_l) #yes

#Testosterone
shapiro.test(data$testosterone_spatial_ng_dl) #yes
shapiro.test(data_repo$testosterone_spatial_ng_dl) #yes
shapiro.test(data_men$testosterone_spatial_ng_dl) #no



#################################################3

#### LOGGED

#Estradiol
shapiro.test(log(data$estradiol_spatial_pg_ml)) #no
shapiro.test(log(data_repo$estradiol_spatial_pg_ml)) #no

#Progesterone
shapiro.test(log(data$progesterone_spatial_ng_ml)) #no
shapiro.test(log(data_repo$progesterone_spatial_ng_ml)) #no

#FSH
shapiro.test(log(data$fsh_spatial_miu_ml)) #yes
shapiro.test(log(data_repo$fsh_spatial_miu_ml)) #yes

#DHEAS
shapiro.test(log(data$dheas_spatial_ug_dl)) #no
shapiro.test(log(data_repo$dheas_spatial_ug_dl)) #no
shapiro.test(log(data_men$dheas_spatial_ug_dl)) #no

#SHBG
shapiro.test(log(data$shbg_spatial_nmol_l)) #no
shapiro.test(log(data_repo$shbg_spatial_nmol_l)) #no
shapiro.test(log(data_men$shbg_spatial_nmol_l)) #no

#Testosterone
shapiro.test(log(data$testosterone_spatial_ng_dl)) #yes
shapiro.test(log(data_repo$testosterone_spatial_ng_dl)) #yes
shapiro.test(log(data_men$testosterone_spatial_ng_dl)) #no
```

Shapiro-Wilk tests reveal that all six hormones violated normality in the overall and women group. Most hormones for women subgroup distributions were still significantly different from normal after log transformation, so Spearman rank correlations will be applied to these hormone and subfield and structure associations. For men, only SHBG violated normality so all subfield and structure correlations with this hormone in men will be spearman rank.


```{r}
## Reproductive Status

### Repo stage: all histograms right-skewed, so apply transformation
h1 <- ggplot(data = data_repo, aes(x = estradiol_spatial_pg_ml)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Estradiol (pg/mL)",
       y = "Count",
       title = "Raw")
h1a <- ggplot(data = data_repo, aes(x = log(estradiol_spatial_pg_ml))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log Estradiol (pg/mL)",
       y = "Count",
       title = "Log Transformed")
h2 <- ggplot(data = data_repo, aes(x = progesterone_spatial_ng_ml)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Progesterone (ng/mL)",
       y = "Count",
       title = "Raw")
h2a <- ggplot(data = data_repo, aes(x = log(progesterone_spatial_ng_ml))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log Progesterone (ng/mL)",
       y = "Count",
       title = "Log Transformed")
h3 <- ggplot(data = data_repo, aes(x = fsh_spatial_miu_ml)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "FSH (mIU/mL)",
       y = "Count",
       title = "Raw")
h3a <- ggplot(data = data_repo, aes(x = log(fsh_spatial_miu_ml))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log FSH (mIU/mL)",
       y = "Count",
       title = "Log Transformed")
h4 <- ggplot(data = data_repo, aes(x = dheas_spatial_ug_dl)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "DHEAS (ug/dL)",
       y = "Count",
       title = "Raw")
h4a <- ggplot(data = data_repo, aes(x = log(dheas_spatial_ug_dl))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log DHEAS (ug/dL)",
       y = "Count",
       title = "Log Transformed")
h5 <- ggplot(data = data_repo, aes(x = shbg_spatial_nmol_l)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "SHBG (nmol/L)",
       y = "Count",
       title = "Raw")
h5a <- ggplot(data = data_repo, aes(x = log(shbg_spatial_nmol_l))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log SHBG (nmol/L)",
       y = "Count",
       title = "Log Transformed")
h6 <- ggplot(data = data_repo, aes(x = testosterone_spatial_ng_dl)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Testosterone (ng/dL)",
       y = "Count",
       title = "Raw")
h6a <- ggplot(data = data_repo, aes(x = log(testosterone_spatial_ng_dl))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log Testosterone (ng/dL)",
       y = "Count",
       title = "Log Transformed")

(h1+h1a)/(h2+h2a)
(h3+h3a)/(h4+h4a)
(h5+h5a)/(h6+h6a)






### Men and women: all right skewed, so transform
h4 <- ggplot(data = data, aes(x = dheas_spatial_ug_dl)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "DHEAS (ug/dL)",
       y = "Count",
       title = "Raw")
h4a <- ggplot(data = data, aes(x = log(dheas_spatial_ug_dl))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log DHEAS (ug/dL)",
       y = "Count",
       title = "Log Transformed")
h5 <- ggplot(data = data, aes(x = shbg_spatial_nmol_l)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "SHBG (nmol/L)",
       y = "Count",
       title = "Raw")
h5a <- ggplot(data = data, aes(x = log(shbg_spatial_nmol_l))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log SHBG (nmol/L)",
       y = "Count",
       title = "Log Transformed")
h6 <- ggplot(data = data, aes(x = testosterone_spatial_ng_dl)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Testosterone (ng/dL)",
       y = "Count",
       title = "Raw")
h6a <- ggplot(data = data, aes(x = log(testosterone_spatial_ng_dl))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log Testosterone (ng/dL)",
       y = "Count",
       title = "Log Transformed")

h4+h4a
h5+h5a
h6+h6a



### Men: DHEAS was normal, but allow all to be log transformed too
data_men <- data %>% 
  filter(sex == "Male")

h4 <- ggplot(data = data_men, aes(x = dheas_spatial_ug_dl)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "DHEAS (ug/dL)",
       y = "Count",
       title = "Raw")
h4a <- ggplot(data = data_men, aes(x = log(dheas_spatial_ug_dl))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log DHEAS (ug/dL)",
       y = "Count",
       title = "Log Transformed")
h5 <- ggplot(data = data_men, aes(x = shbg_spatial_nmol_l)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "SHBG (nmol/L)",
       y = "Count",
       title = "Raw")
h5a <- ggplot(data = data_men, aes(x = log(shbg_spatial_nmol_l))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log SHBG (nmol/L)",
       y = "Count",
       title = "Log Transformed")
h6 <- ggplot(data = data_men, aes(x = testosterone_spatial_ng_dl)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Testosterone (ng/dL)",
       y = "Count",
       title = "Raw")
h6a <- ggplot(data = data_men, aes(x = log(testosterone_spatial_ng_dl))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Log Testosterone (ng/dL)",
       y = "Count",
       title = "Log Transformed")

h4+h4a
h5+h5a
h6+h6a

# 
# For just men, log transformation will also be applied in the following Pearson correlations. Testosterone correlations among men will be using Spearman rank.
```




```{r log-transform}
#Transform hormones so the hormone correlations would run with Pearson
# data_repo <- data_repo %>% 
#   mutate_at(vars(estradiol_spatial_pg_ml:testosterone_spatial_ng_dl), log)
# 
# data <- data %>% 
#   mutate_at(vars(estradiol_spatial_pg_ml:testosterone_spatial_ng_dl), log)
# 
# df_438 <- df_438 %>% 
#   mutate_at(vars(estradiol_spatial_pg_ml:testosterone_spatial_ng_dl), log)
```


# Total Hippocampal Volume {.tabset}

## Structural Comparison

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_total_hipp,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5, show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Average Total \nHippocampal Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = avg_total_hipp,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Average Total \nHippocampal Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = avg_total_hipp)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average Total \nHippocampal Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```



```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(n_total_hipp = n(),
            mean_total_hipp = mean(avg_total_hipp, na.rm=TRUE),
            std_total_hipp = sd(avg_total_hipp, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Total Hipp Volume",
                      "SD Total Hipp Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(n_total_hipp = n(),
            mean_total_hipp = mean(avg_total_hipp, na.rm=TRUE),
            std_total_hipp = sd(avg_total_hipp, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Total Hipp Volume",
                      "SD Total Hipp Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of total hipp are displayed by reproductive status and by sex.


```{r}
#ANOVA of total hipp by repo stage
aov <- aov(avg_total_hipp ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing T2 hipp GMV by reproductive status was not significant.

```{r}
#T-test of total hipp by sex
ttest <- t.test(avg_total_hipp ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing GMV by sex was not significant. 

### LEFT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = left_total_hipp,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5, show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Left Total \nHippocampal Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = left_total_hipp,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Left Total \nHippocampal Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = left_total_hipp)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Left Total \nHippocampal Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```

```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(n_total_hipp = n(),
            mean_total_hipp = mean(left_total_hipp, na.rm=TRUE),
            std_total_hipp = sd(left_total_hipp, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Left Total Hipp Volume",
                      "SD Total Hipp Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(n_total_hipp = n(),
            mean_total_hipp = mean(left_total_hipp, na.rm=TRUE),
            std_total_hipp = sd(left_total_hipp, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Left Total Hipp Volume",
                      "SD Total Hipp Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of total hipp are displayed by reproductive status and by sex.


```{r}
#ANOVA of total hipp by repo stage
aov <- aov(left_total_hipp ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing T2 hipp GMV by reproductive status was not significant.

```{r}
#T-test of total hipp by sex
ttest <- t.test(left_total_hipp ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing GMV by sex was not significant. 

### RIGHT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = right_total_hipp,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5, show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Right Total \nHippocampal Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = right_total_hipp,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Right Total \nHippocampal Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = right_total_hipp)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Right Total \nHippocampal Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```

```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(n_total_hipp = n(),
            mean_total_hipp = mean(right_total_hipp, na.rm=TRUE),
            std_total_hipp = sd(right_total_hipp, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Right Total Hipp Volume",
                      "SD Total Hipp Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(n_total_hipp = n(),
            mean_total_hipp = mean(right_total_hipp, na.rm=TRUE),
            std_total_hipp = sd(right_total_hipp, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Right Total Hipp Volume",
                      "SD Total Hipp Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of total hipp are displayed by reproductive status and by sex.


```{r}
#ANOVA of total hipp by repo stage
aov <- aov(right_total_hipp ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing T2 hipp GMV by reproductive status was not significant.

```{r}
#T-test of total hipp by sex
ttest <- t.test(right_total_hipp ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing GMV by sex was not significant. 


## Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Average Total\n Hippocampal Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Average Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Average Total\n Hippocampal Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Average Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Average Total\n Hippocampal Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Average Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Average Total\n Hippocampal Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Average Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Average Total\n Hippocampal Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Average Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Average Total\n Hippocampal Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Average Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman. 


### LEFT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left Total\n Hippocampal Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left Total\n Hippocampal Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left Total\n Hippocampal Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left Total\n Hippocampal Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left Total\n Hippocampal Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left Total\n Hippocampal Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman

### RIGHT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right Total\n Hippocampal Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right Total\n Hippocampal Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right Total\n Hippocampal Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right Total\n Hippocampal Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right Total\n Hippocampal Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right Total\n Hippocampal Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_total_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right Total\n Hippocampal Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```
All correlations are Spearman

## Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_total_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged Total\n Hippocampal Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_total_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged Total\n Hippocampal Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_total_hipp", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged Total\n Hippocampal Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except for SHBG (Spearman)

### LEFT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "left_total_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left Total\n Hippocampal Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "left_total_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left Total\n Hippocampal Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "left_total_hipp", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left Total\n Hippocampal Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except for SHBG (Spearman)


### RIGHT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "right_total_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right Total\n Hippocampal Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "right_total_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right Total\n Hippocampal Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "right_total_hipp", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right Total\n Hippocampal Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except for SHBG (Spearman)


# {-}

# MTL {.tabset}

## Structural Comparison

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_mtl,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Avergage MTL Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = avg_mtl,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Average MTL Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = avg_mtl)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average MTL Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_mtl = mean(avg_mtl, na.rm=TRUE),
            std_mtl = sd(avg_mtl, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean MTL Volume",
                      "SD MTL Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)


data %>%
  group_by(sex) %>%
  summarize(count = n(),
            mean_mtl = mean(avg_mtl, na.rm=TRUE),
            std_mtl = sd(avg_mtl, na.rm=TRUE)) %>%
  kable(col.names = c("Sex", "n", "Mean MTL Volume",
                      "SD MTL Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>%
  kable_styling("striped", full_width = FALSE,
                position = "center",
                font_size = 12)
```

Means and standard deviations of MTL are displayed by reproductive status and by sex.


```{r}
#ANOVA of MTL by repo stage
aov <- aov(avg_mtl ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing MTL by reproductive status was not significant.

```{r}
#T-test of MTL by sex
ttest <- t.test(avg_mtl ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```


T-test results comparing MTL by sex was not significant. 

### LEFT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = left_mtl,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Left MTL Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = left_mtl,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Left MTL Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = left_mtl)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Left MTL Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_mtl = mean(left_mtl, na.rm=TRUE),
            std_mtl = sd(left_mtl, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Left MTL Volume",
                      "SD MTL Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)


data %>%
  group_by(sex) %>%
  summarize(count = n(),
            mean_mtl = mean(left_mtl, na.rm=TRUE),
            std_mtl = sd(left_mtl, na.rm=TRUE)) %>%
  kable(col.names = c("Sex", "n", "Mean Left MTL Volume",
                      "SD MTL Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>%
  kable_styling("striped", full_width = FALSE,
                position = "center",
                font_size = 12)
```

Means and standard deviations of MTL are displayed by reproductive status and by sex.


```{r}
#ANOVA of MTL by repo stage
aov <- aov(left_mtl ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing MTL by reproductive status was not significant.

```{r}
#T-test of MTL by sex
ttest <- t.test(left_mtl ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```


T-test results comparing MTL by sex was not significant. 

### RIGHT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = right_mtl,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Right MTL Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = right_mtl,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Right MTL Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = right_mtl)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Right MTL Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_mtl = mean(right_mtl, na.rm=TRUE),
            std_mtl = sd(right_mtl, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Right MTL Volume",
                      "SD MTL Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)


data %>%
  group_by(sex) %>%
  summarize(count = n(),
            mean_mtl = mean(right_mtl, na.rm=TRUE),
            std_mtl = sd(right_mtl, na.rm=TRUE)) %>%
  kable(col.names = c("Sex", "n", "Mean Right MTL Volume",
                      "SD MTL Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>%
  kable_styling("striped", full_width = FALSE,
                position = "center",
                font_size = 12)
```

Means and standard deviations of MTL are displayed by reproductive status and by sex.


```{r}
#ANOVA of MTL by repo stage
aov <- aov(right_mtl ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing MTL by reproductive status was not significant.

```{r}
#T-test of MTL by sex
ttest <- t.test(right_mtl ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```


T-test results comparing MTL by sex was not significant. 


## Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Average MTL Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Average MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Average MTL Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Average MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Average MTL Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Average MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Average MTL Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Average MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Average MTL Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Average MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Average MTL Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Average MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```


All correlations are Spearman.


### LEFT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left MTL Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left MTL Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left MTL Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left MTL Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left MTL Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left MTL Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```


All correlations are Spearman.


### RIGHT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right MTL Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right MTL Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right MTL Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right MTL Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right MTL Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right MTL Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_mtl", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right MTL Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```


All correlations are Spearman.

## Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_mtl",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged MTL Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_mtl",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged MTL Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_mtl", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged MTL Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```


All correlations are Pearson except SHBG (Spearman)

### LEFT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "left_mtl",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left MTL Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "left_mtl",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left MTL Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "left_mtl", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left MTL Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```


All correlations are Pearson except SHBG (Spearman)


### RIGHT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "right_mtl",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right MTL Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "right_mtl",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right MTL Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "right_mtl", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right MTL Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```


All correlations are Pearson except SHBG (Spearman)

# {-}


# T2 Subfield Volume {.tabset}

## CA1 {.tabset}

### Structural Comparison

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_ca1,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged CA1 \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = avg_ca1,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged CA1 \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = avg_ca1)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average CA1 Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_ca1 = mean(avg_ca1, na.rm=TRUE),
            std_ca1 = sd(avg_ca1, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean CA1 Volume",
                      "SD CA1 Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_ca1 = mean(avg_ca1, na.rm=TRUE),
            std_ca1 = sd(avg_ca1, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean CA1 Volume",
                      "SD CA1 Volume"),
        caption = "Sample size and means for subjects by sex status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex


```{r}
#ANOVA of subfield by repo stage
aov <- aov(avg_ca1 ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing CA1 subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(avg_ca1 ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```


T-test results comparing CA1 subfield by sex was not significant. 

#### LEFT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = left_ca1,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Left CA1 \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = left_ca1,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Left CA1 \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = left_ca1)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Left CA1 Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_ca1 = mean(left_ca1, na.rm=TRUE),
            std_ca1 = sd(left_ca1, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Left CA1 Volume",
                      "SD CA1 Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_ca1 = mean(left_ca1, na.rm=TRUE),
            std_ca1 = sd(left_ca1, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Left CA1 Volume",
                      "SD CA1 Volume"),
        caption = "Sample size and means for subjects by sex status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex


```{r}
#ANOVA of subfield by repo stage
aov <- aov(left_ca1 ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing CA1 subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(left_ca1 ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```


T-test results comparing CA1 subfield by sex was not significant. 

#### RIGHT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = right_ca1,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Right CA1 \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = right_ca1,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Right CA1 \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = right_ca1)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Right CA1 Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_ca1 = mean(right_ca1, na.rm=TRUE),
            std_ca1 = sd(right_ca1, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Right CA1 Volume",
                      "SD CA1 Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_ca1 = mean(right_ca1, na.rm=TRUE),
            std_ca1 = sd(right_ca1, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Right CA1 Volume",
                      "SD CA1 Volume"),
        caption = "Sample size and means for subjects by sex status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex


```{r}
#ANOVA of subfield by repo stage
aov <- aov(right_ca1 ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing CA1 subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(right_ca1 ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```


T-test results comparing CA1 subfield by sex was not significant. 

### Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged CA1 Subfield Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged CA1 Subfield Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged CA1 Subfield Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA1 Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA1 Subfield Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged CA1 Subfield Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman.

#### LEFT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left CA1 Subfield Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left CA1 Subfield Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left CA1 Subfield Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left CA1 Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left CA1 Subfield Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left CA1 Subfield Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman.


#### RIGHT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right CA1 Subfield Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right CA1 Subfield Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right CA1 Subfield Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right CA1 Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right CA1 Subfield Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right CA1 Subfield Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_ca1", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right CA1 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman.



### Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_ca1",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA1 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_ca1",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA1 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_ca1", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged CA1 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

Correlations are all Pearson except SHBG (Spearman)


#### LEFT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "left_ca1",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left CA1 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "left_ca1",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left CA1 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "left_ca1", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left CA1 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

Correlations are all Pearson except SHBG (Spearman)


#### RIGHT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "right_ca1",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right CA1 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "right_ca1",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right CA1 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "right_ca1", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right CA1 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

Correlations are all Pearson except SHBG (Spearman)

## {-}


## CA2/3 {.tabset}


### Structural Comparison

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_ca23,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged CA23 \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = avg_ca23,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged CA23 \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 

#Total
p3 <- ggplot(data = data, aes(x = avg_ca23)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average CA23 Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```

```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_ca23 = mean(avg_ca23, na.rm=TRUE),
            std_ca23 = sd(avg_ca23, na.rm=TRUE)) %>%
  kable(col.names = c("Reproductive Status", "n", "Mean CA23 Volume",
                      "SD CA23 Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_ca23 = mean(avg_ca23, na.rm=TRUE),
            std_ca23 = sd(avg_ca23, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean CA23 Volume",
                      "SD CA23 Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12) 
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex


```{r}
#ANOVA of subfield by repo stage
aov <- aov(avg_ca23 ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing CA23 subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(avg_ca23 ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing CA23 subfield by sex was not significant. 

#### LEFT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = left_ca23,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Left CA23 \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = left_ca23,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Left CA23 \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 

#Total
p3 <- ggplot(data = data, aes(x = left_ca23)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Left CA23 Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```

```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_ca23 = mean(left_ca23, na.rm=TRUE),
            std_ca23 = sd(left_ca23, na.rm=TRUE)) %>%
  kable(col.names = c("Reproductive Status", "n", "Mean Left CA23 Volume",
                      "SD CA23 Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_ca23 = mean(left_ca23, na.rm=TRUE),
            std_ca23 = sd(left_ca23, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Left CA23 Volume",
                      "SD CA23 Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12) 
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex


```{r}
#ANOVA of subfield by repo stage
aov <- aov(left_ca23 ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing CA23 subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(left_ca23 ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing CA23 subfield by sex was not significant.

#### RIGHT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = right_ca23,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Right CA23 \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = right_ca23,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Right CA23 \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 

#Total
p3 <- ggplot(data = data, aes(x = right_ca23)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Right CA23 Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```

```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_ca23 = mean(right_ca23, na.rm=TRUE),
            std_ca23 = sd(right_ca23, na.rm=TRUE)) %>%
  kable(col.names = c("Reproductive Status", "n", "Mean Right CA23 Volume",
                      "SD CA23 Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_ca23 = mean(right_ca23, na.rm=TRUE),
            std_ca23 = sd(right_ca23, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Right CA23 Volume",
                      "SD CA23 Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12) 
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex


```{r}
#ANOVA of subfield by repo stage
aov <- aov(right_ca23 ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing CA23 subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(right_ca23 ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing CA23 subfield by sex was not significant.


### Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged CA23 Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged CA23 Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged CA23 Subfield Volume") + facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged CA23 Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA23 Subfield Volume")+
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA23 Subfield Volume")+
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")



#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged CA23 Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```


All correlations were Spearman


#### LEFT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left CA23 Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left CA23 Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left CA23 Subfield Volume") + facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left CA23 Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left CA23 Subfield Volume")+
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left CA23 Subfield Volume")+
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")



#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left CA23 Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```


All correlations were Spearman


#### RIGHT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right CA23 Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right CA23 Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right CA23 Subfield Volume") + facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right CA23 Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right CA23 Subfield Volume")+
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right CA23 Subfield Volume")+
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")



#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right CA23 Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_ca23", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right CA23 Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") + theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```


All correlations were Spearman


### Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_ca23",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged CA23 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_ca23", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged CA23 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_ca23",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged CA23 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

#### LEFT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "left_ca23",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left CA23 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "left_ca23", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left CA23 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "left_ca23",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left CA23 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)


#### RIGHT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "right_ca23",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right CA23 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "right_ca23", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right CA23 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "right_ca23",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right CA23 Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

## {-}


## DG {.tabset}


### Structural Comparison

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_dg,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged DG \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = avg_dg,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged DG \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = avg_dg)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average DG Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_dg = mean(avg_dg, na.rm=TRUE),
            std_dg = sd(avg_dg, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean DG Volume",
                      "SD DG Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_dg = mean(avg_dg, na.rm=TRUE),
            std_dg = sd(avg_dg, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean DG Volume",
                      "SD DG Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(avg_dg ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing DG subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(avg_dg ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing DG subfield by sex was not significant. 

#### LEFT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = left_dg,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Left DG \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = left_dg,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Left DG \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = left_dg)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Left DG Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_dg = mean(left_dg, na.rm=TRUE),
            std_dg = sd(left_dg, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Left DG Volume",
                      "SD DG Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_dg = mean(left_dg, na.rm=TRUE),
            std_dg = sd(left_dg, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Left DG Volume",
                      "SD DG Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(left_dg ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing DG subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(left_dg ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing DG subfield by sex was not significant.

#### RIGHT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = right_dg,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Right DG \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = right_dg,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Right DG \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = right_dg)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Right DG Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_dg = mean(right_dg, na.rm=TRUE),
            std_dg = sd(right_dg, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Right DG Volume",
                      "SD DG Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_dg = mean(right_dg, na.rm=TRUE),
            std_dg = sd(right_dg, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Right DG Volume",
                      "SD DG Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(right_dg ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing DG subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(right_dg ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing DG subfield by sex was not significant.

### Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged DG Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged DG Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged DG Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged DG Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
   theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged DG Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
   theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged DG Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
   theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman

#### LEFT


```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left DG Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left DG Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left DG Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left DG Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
   theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left DG Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
   theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left DG Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
   theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman

#### RIGHT


```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right DG Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right DG Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right DG Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right DG Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
   theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right DG Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
   theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right DG Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_dg", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right DG Subfield Volume") +
     facet_grid(repo_status ~ ., scale = "free") +
   theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman

### Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_dg",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged DG Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_dg",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged DG Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_dg",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged DG Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

#### LEFT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "left_dg",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left DG Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "left_dg",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left DG Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "left_dg",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left DG Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

#### RIGHT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "right_dg",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right DG Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "right_dg",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right DG Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "right_dg",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right DG Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

## {-}


## ERC {.tabset}

### Structural Comparison

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_erc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged ERC \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = avg_erc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged ERC \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = avg_erc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average ERC Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_erc = mean(avg_erc, na.rm=TRUE),
            std_erc = sd(avg_erc, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean ERC Volume",
                      "SD ERC Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_erc = mean(avg_erc, na.rm=TRUE),
            std_erc = sd(avg_erc, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean ERC Volume",
                      "SD ERC Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(avg_erc ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing ERC subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(avg_erc ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing ERC subfield by sex was significant. Women (*M* = `r round(tidy_ttest$estimate1, digits = 3)`) have larger ERC volume than men (*M* = `r round(tidy_ttest$estimate2, digits = 3)`) (*t* = `r round(tidy_ttest$statistic, digits = 3)`, *df* = `r round(tidy_ttest$parameter, digits = 3)`, *p* = `r round(tidy_ttest$p.value, digits = 3)`).


#### LEFT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = left_erc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Left ERC \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = left_erc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Left ERC \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = left_erc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Left ERC Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_erc = mean(left_erc, na.rm=TRUE),
            std_erc = sd(left_erc, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean left ERC Volume",
                      "SD ERC Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_erc = mean(left_erc, na.rm=TRUE),
            std_erc = sd(left_erc, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Left ERC Volume",
                      "SD ERC Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(left_erc ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing ERC subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(left_erc ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing ERC left subfield by sex was marginally significant. Women (*M* = `r round(tidy_ttest$estimate1, digits = 3)`) have marginally larger ERC volume than men (*M* = `r round(tidy_ttest$estimate2, digits = 3)`) (*t* = `r round(tidy_ttest$statistic, digits = 3)`, *df* = `r round(tidy_ttest$parameter, digits = 3)`, *p* = `r round(tidy_ttest$p.value, digits = 3)`).



#### RIGHT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = right_erc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Right ERC \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = right_erc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Right ERC \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = right_erc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Right ERC Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_erc = mean(right_erc, na.rm=TRUE),
            std_erc = sd(right_erc, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Right ERC Volume",
                      "SD ERC Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_erc = mean(right_erc, na.rm=TRUE),
            std_erc = sd(right_erc, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Right ERC Volume",
                      "SD ERC Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(right_erc ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing ERC subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(right_erc ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing ERC right subfield by sex was marginally significant. Women (*M* = `r round(tidy_ttest$estimate1, digits = 3)`) have marginally larger ERC volume than men (*M* = `r round(tidy_ttest$estimate2, digits = 3)`) (*t* = `r round(tidy_ttest$statistic, digits = 3)`, *df* = `r round(tidy_ttest$parameter, digits = 3)`, *p* = `r round(tidy_ttest$p.value, digits = 3)`).



### Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged ERC Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged ERC Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged ERC Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged ERC Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged ERC Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged ERC Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman.

#### LEFT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left ERC Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left ERC Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left ERC Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left ERC Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left ERC Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left ERC Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman.

#### RIGHT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right ERC Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right ERC Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right ERC Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right ERC Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right ERC Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right ERC Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_erc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right ERC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman.

### Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_erc",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged ERC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_erc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged ERC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_erc",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged ERC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```
All correlations are Pearson except SHBG (Spearman)

#### LEFT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "left_erc",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left ERC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "left_erc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left ERC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "left_erc",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left ERC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```
All correlations are Pearson except SHBG (Spearman)

#### RIGHT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "right_erc",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right ERC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "right_erc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right ERC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "right_erc",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right ERC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```
All correlations are Pearson except SHBG (Spearman)

## {-}


## PHC {.tabset}


### Structural Comparison

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_phc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged PHC \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none")

#Sex
p2 <- ggplot(data = data, aes(y = avg_phc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged PHC \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 

#Total
p3 <- ggplot(data = data, aes(x = avg_phc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average PHC Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_phc = mean(avg_phc, na.rm=TRUE),
            std_phc = sd(avg_phc, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean PHC Volume",
                      "SD PHC Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_phc = mean(avg_phc, na.rm=TRUE),
            std_phc = sd(avg_phc, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean PHC Volume",
                      "SD PHC Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(avg_phc ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing PHC subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(avg_phc ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing PHC subfield by sex was not significant.

#### LEFT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = left_phc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Left PHC \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none")

#Sex
p2 <- ggplot(data = data, aes(y = left_phc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Left PHC \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 

#Total
p3 <- ggplot(data = data, aes(x = left_phc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Left PHC Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_phc = mean(left_phc, na.rm=TRUE),
            std_phc = sd(left_phc, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Left PHC Volume",
                      "SD PHC Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_phc = mean(left_phc, na.rm=TRUE),
            std_phc = sd(left_phc, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Left PHC Volume",
                      "SD PHC Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(left_phc ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing PHC subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(left_phc ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing PHC subfield by sex was not significant.

#### RIGHT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = right_phc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Right PHC \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none")

#Sex
p2 <- ggplot(data = data, aes(y = right_phc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Right PHC \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 

#Total
p3 <- ggplot(data = data, aes(x = right_phc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Right PHC Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_phc = mean(right_phc, na.rm=TRUE),
            std_phc = sd(right_phc, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Right PHC Volume",
                      "SD PHC Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_phc = mean(right_phc, na.rm=TRUE),
            std_phc = sd(right_phc, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Right PHC Volume",
                      "SD PHC Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(right_phc ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing PHC subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(right_phc ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing PHC subfield by sex was not significant.

### Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged PHC Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged PHC Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged PHC Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PHC Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PHC Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged PHC Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman

#### LEFT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left PHC Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left PHC Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left PHC Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left PHC Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left PHC Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left PHC Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman

#### RIGHT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right PHC Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right PHC Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right PHC Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right PHC Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right PHC Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right PHC Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_phc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right PHC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman

### Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_phc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PHC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_phc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PHC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_phc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged PHC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

#### LEFT


```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "left_phc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left PHC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "left_phc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left PHC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "left_phc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left PHC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

#### RIGHT


```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "right_phc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right PHC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "right_phc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right PHC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "right_phc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right PHC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)


## {-}

## PRC {.tabset}


### Structural Comparison

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_prc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged PRC Subfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = avg_prc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged PRC Subfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = avg_prc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average PRC Subfield Volume",
       y = "Count",
       title = "Total")


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_prc = mean(avg_prc, na.rm=TRUE),
            std_prc = sd(avg_prc, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean PRC Volume",
                      "SD PRC Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_prc = mean(avg_prc, na.rm = TRUE),
            std_prc = sd(avg_prc, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean PRC Volume",
                      "SD PRC Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex


```{r}
#ANOVA of subfield by repo stage
aov <- aov(avg_prc ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing PRC subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(avg_prc ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing PRC subfield by sex was not significant. 

#### LEFT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = left_prc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Left PRC Subfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = left_prc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Left PRC Subfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = left_prc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Left PRC Subfield Volume",
       y = "Count",
       title = "Total")


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_prc = mean(left_prc, na.rm=TRUE),
            std_prc = sd(left_prc, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Left PRC Volume",
                      "SD PRC Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_prc = mean(left_prc, na.rm = TRUE),
            std_prc = sd(left_prc, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Left PRC Volume",
                      "SD PRC Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex


```{r}
#ANOVA of subfield by repo stage
aov <- aov(left_prc ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing PRC subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(left_prc ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing PRC subfield by sex was not significant. 


#### RIGHT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = right_prc,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Right PRC Subfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = right_prc,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Right PRC Subfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = right_prc)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Right PRC Subfield Volume",
       y = "Count",
       title = "Total")


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_prc = mean(right_prc, na.rm=TRUE),
            std_prc = sd(right_prc, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Right PRC Volume",
                      "SD PRC Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_prc = mean(right_prc, na.rm = TRUE),
            std_prc = sd(right_prc, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Right PRC Volume",
                      "SD PRC Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex


```{r}
#ANOVA of subfield by repo stage
aov <- aov(right_prc ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing PRC subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(right_prc ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing PRC subfield by sex was not significant. 



### Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged PRC Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged PRC Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged PRC Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PRC Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PRC Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged PRC Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman


#### LEFT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left PRC Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left PRC Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left PRC Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left PRC Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left PRC Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left PRC Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman


#### RIGHT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right PRC Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right PRC Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right PRC Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right PRC Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right PRC Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right PRC Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_prc", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right PRC Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman


### Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_prc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged PRC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_prc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged PRC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_prc",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged PRC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

#### LEFT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "left_prc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left PRC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "left_prc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left PRC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "left_prc",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left PRC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

#### RIGHT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "right_prc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right PRC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "right_prc", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right PRC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "right_prc",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right PRC Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

## {-}

## SUB {.tabset}

### Structural Comparison

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_sub,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Averaged SUB \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none")

#Sex
p2 <- ggplot(data = data, aes(y = avg_sub,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Averaged SUB \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = avg_sub)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Average SUB Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_sub = mean(avg_sub, na.rm=TRUE),
            std_sub = sd(avg_sub, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean SUB Volume",
                      "SD SUB Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_sub = mean(avg_sub, na.rm=TRUE),
            std_sub = sd(avg_sub, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean SUB Volume",
                      "SD SUB Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(avg_sub ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing SUB subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(avg_sub ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing SUB subfield by sex was not significant. 


#### LEFT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = left_sub,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Left SUB \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none")

#Sex
p2 <- ggplot(data = data, aes(y = left_sub,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Left SUB \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = left_sub)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Left SUB Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_sub = mean(left_sub, na.rm=TRUE),
            std_sub = sd(left_sub, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Left SUB Volume",
                      "SD SUB Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_sub = mean(left_sub, na.rm=TRUE),
            std_sub = sd(left_sub, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Left SUB Volume",
                      "SD SUB Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(left_sub ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing SUB subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(left_sub ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing SUB subfield by sex was not significant. 


#### RIGHT

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = right_sub,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Right SUB \nSubfield Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none")

#Sex
p2 <- ggplot(data = data, aes(y = right_sub,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Right SUB \nSubfield Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = right_sub)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Right SUB Subfield Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(count = n(),
            mean_sub = mean(right_sub, na.rm=TRUE),
            std_sub = sd(right_sub, na.rm=TRUE)) %>% 
  kable(col.names = c("Reproductive Status", "n", "Mean Right SUB Volume",
                      "SD SUB Volume"),
        caption = "Sample size and means for subjects by reproductive status with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  summarize(count = n(),
            mean_sub = mean(right_sub, na.rm=TRUE),
            std_sub = sd(right_sub, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Right SUB Volume",
                      "SD SUB Volume"),
        caption = "Sample size and means for subjects by sex with T2 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```

Means and standard deviations of the subfield are displayed by reproductive status and by sex

```{r}
#ANOVA of subfield by repo stage
aov <- aov(right_sub ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing SUB subfield by reproductive status was not significant.

```{r}
#T-test of subfield by sex
ttest <- t.test(right_sub ~ sex, data = data)
ttest
tidy_ttest <- tidy(ttest)
```

T-test results comparing SUB subfield by sex was not significant. 



### Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged SUB Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Averaged SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged SUB Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Averaged SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged SUB Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Averaged SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged SUB Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged SUB Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged SUB Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman.

#### LEFT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left SUB Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Left SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left SUB Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Left SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left SUB Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Left SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left SUB Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left SUB Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left SUB Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "left_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman.

#### RIGHT

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right SUB Subfield Volume") +
    theme(legend.position = "none")

#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Right SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right SUB Subfield Volume") +
    theme(legend.position = "none")

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Right SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right SUB Subfield Volume") +
    theme(legend.position = "none")

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Right SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right SUB Subfield Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +theme_bw() +
    theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right SUB Subfield Volume") +
    theme(legend.position = "none")

#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +theme_bw() +
    theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right SUB Subfield Volume") +
    theme(legend.position = "none")

#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "right_sub", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right SUB Subfield Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
    theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman.


### Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_sub",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Averaged SUB Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_sub", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Averaged SUB Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_sub",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Averaged SUB Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)

#### LEFT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "left_sub",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Left SUB Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "left_sub", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Left SUB Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "left_sub",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Left SUB Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)


#### RIGHT

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "right_sub",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Right SUB Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "right_sub", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Right SUB Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "right_sub",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Right SUB Subfield Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except SHBG (Spearman)


## {-}

# {-}

# Summary

Sample included HAS participants who had a T2 hipp scan and completed spatial navigation behavior. 

## Hormones

All hormones were skewed for overall and women groups, so hormone and volume correlations were Spearman rank correlations. All correlations for men were Pearson except for those involving SHBG.

**Total hipp Volume and MTL**

- Total hipp volume and MTL volumes were normally distributed. ANOVA results comparing total hipp volume and MTL by reproductive stage were not significant. T-test results comparing total hipp volume and MTL by sex were also not significant.

- For total hipp volume, higher progesterone concentration was negatively associated with lower total hipp volumes in women (*p* < 0.05, Spearman) and in pres (*p* < 0.001, Spearman). Higher DHEAS was significantly negatively associated with total hipp volume for posts (*p* < 0.05, Spearman). Higher FSH was marginally positively associated with total hipp volume for peris (*p* = 0.069, Spearman).

- For MTL, progesterone was marginally negatively associated with lower MTL volumes in women (*p* = 0.051, Spearman). Higher testosterone was marginally positively associated with MTL volume for pres (*p* = 0.069, Spearman).


**Subfields**

- Subregion volumes for women and men were generally normally distributed, except for CA1 overall and in women, and PHC in women. ANOVA results comparing subfields by reproductive stage were all not significant. T-test results comparing subfields by sex were all not significant except for ERC (*p* < 0.05), with women showing greater ERC subfield volume than men.

- For estradiol, it was significantly negatively correlated with PRC for posts (*p* < 0.05, Spearman). It was also marginally negatively associated with PHC for pres (*p* = 0.062, Spearman).

- For progesterone, it was significantly negatively associated with SUB for pres (*p* < 0.05, Spearman), with PRC for posts (*p* < 0.05, Spearman), DG for women (*p* < 0.01, Spearman) and DG for pres (*p* < 0.01, Spearman), as well as with CA1 for pres (*p* < 0.05, Spearman). Progesterone was only marginally positively associated with CA1 for posts (*p* = 0.052, Spearman). 

- For FSH, it was significantly negatively correlated with CA1 for posts (*p* < 0.05, Spearman). It was significantly positively correlated with ERC for peris (*p* < 0.05, Spearman) and SUB for pres (*p* < 0.05, Spearman). FSH was marginally positively correlated with CA23 for peris (*p* = 0.058, Spearman) and with DG for peris (*p* = 0.069, Spearman) and with DG for peris (*p* = 0.069, Spearman).

- For SHBG, it was significantly negatively correlated with PHC for posts (*p* < 0.05, Spearman), and marginally negatively correlated with SUB for pres (*p* = 0.068, Spearman).

- For DHEAS, it was significantly negatively correlated with CA23 for posts (*p* < 0.01, Spearman) and with DG for posts (*p* < 0.05, Spearman).

- For testosterone, it was significantly positively associated with PHC for peris (*p* < 0.05, Spearman). Testosterone was also marginally negatively correlated with CA1 for men (*p* = 0.066, Pearson).

