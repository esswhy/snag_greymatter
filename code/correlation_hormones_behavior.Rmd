---
title: 'SNAG: Hormones'
author: "Shuying Yu"
date: "4/11/2022"
output: 
  html_document: 
    toc: yes
    toc_float: true
---

```{r setup, include = FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.align = "center")

#Attach libraries
library(tidyverse)
library(here)
library(janitor)
library(ggpubr)
library(patchwork)
library(kableExtra)
library(foreign)
library(RColorBrewer)
library(plotly)
library(readr)
```

# Overview

Data has been cleaned into tidy format prior to analysis.

```{r}
#Read in the data
df <- read_csv(here("data", "HAS_SNAG_mastersheet_tidy.csv")) %>% 
  clean_names()

#Check first 6 lines of data
#head(df)
```

For hormones and behavior correlations, I want to keep participants that have 1) SNAG data *and* 2) hormones data. Men and women will be kept separate for analyses because they were tested for different sex steroid hormones.

Men were tested for SHBG, DHEAS, and testosterone if they had a scan. If they did a follow-up spatial session or had no scan, they were only tested for SHBG and testosterone.

Women were tested for SHBG, DHEAS, testosterone, *and* estradiol, progestoerone, and FSH if they also did scan. If they did a follow-up spatial session, they were only tested for estradiol and testosterone. Only estradiol was tested if they did not do a scan, so some women may not be represented in the correlational data.


```{r}
########## Filter for SNAG, hormones by sex

df_women <- df %>% 
  
  #Filter if did snag, female
  filter(completed_spatial == "Yes",
         sex == "Female") %>% 
  
  #Select specific columns
  #Basic demo, snag, hormones
  dplyr::select(subject_id:repo_status_spatial,
         loop_pe_rad1_m:testosterone_spatial_ng_dl) %>% 
  
  #Reorder repo status
  mutate(repo_status_spatial = fct_relevel(repo_status_spatial, 
                                         c("Pre", "Peri", "Post")))



df_men <- df %>% 
  
  #Filter if did snag, male
  filter(completed_spatial == "Yes",
         sex == "Male") %>% 
  
  #Select specific columns
  #Basic demo, snag, hormones
  dplyr::select(subject_id:repo_status_spatial,
         loop_pe_rad1_m:testosterone_spatial_ng_dl) %>% 
  
  #Remove irrelevant columns
  dplyr::select(-c(age_scan_years, repo_status_scan, repo_status_spatial,
         estradiol_scan_pg_ml:fsh_scan_miu_ml,
         estradiol_spatial_pg_ml:fsh_spatial_miu_ml))
```

# Correlations

Current sample sizes for behavior $\times$ sex hormones (participants with behavior for analysis):


<br> 

```{r snag-table}
df %>% 
  group_by(sex) %>% 
  summarize(loop = sum(loop_useable == "Yes", na.rm=TRUE),
            maze = sum(maze_useable == "Yes", na.rm=TRUE),
            dsp = sum(dsp_useable == "Yes", na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "LOOP", "MAZE", "DSP"),
        align = c("l", rep("c", 3)),
        caption = c("<b> Table 1.</b> Sample sizes for participants who have useable data for LOOP, MAZE, and DP broken down by sex."),
        table.attr = "style='width:80%;'") %>% 
  kable_styling(position = "center")
```


The following figures and Pearson's *r* correlation analyses are preliminary and exploratory. The hormone data were taken from when the SNAG study coincided with the blood draws (i.e., if participants did a follow-up SNAG, hormone data was taken from that time point and not when scan was done). See summary section for future considerations. Thus, sample sizes differ not just by task, but also by sex hormone.

The 95% confidence interval is drawn with the line of best fit. Data points with missing hormone data are not plotted (dropped automatically) so they do not skew the correlation analyses or the line of best fit.

## Male {.tabset}

### LOOP 

**Position Error**

```{r}
#Subset
df_men_loop_pe <- df_men %>% 
  
  #Filter for loop position error
  #Average is of the 3 radii values for variable
  drop_na(loop_pe_avg_m)
```

```{r}
#Scatterplot
pe1 <- ggscatter(df_men_loop_pe, x = "shbg_spatial_nmol_l", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Average Position Error (m)")


#Scatterplot
pe2 <- ggscatter(df_men_loop_pe, x = "testosterone_spatial_ng_dl", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Average Position Error (m)")


#Scatterplot
pe3 <- ggscatter(df_men_loop_pe, x = "dheas_spatial_ug_dl", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Average Position Error (m)")

#Present as patchwork
pe1 + pe2 + pe3
```


For LOOP position error, DHEAS seems to be positively associated with behavior for men.

**Degrees Traveled**

```{r}
#Subset
df_men_loop_de <- df_men %>% 
  
  #Filter for loop degrees averaged
  #Average is of the 3 radii values for variable
  drop_na(loop_de_avg_degree)
```

```{r}
#Scatterplot
de1 <- ggscatter(df_men_loop_de, x = "shbg_spatial_nmol_l", y = "loop_de_avg_degree", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Average Degrees Traveled (degree)")


#Scatterplot
de2 <- ggscatter(df_men_loop_de, x = "testosterone_spatial_ng_dl", y = "loop_de_avg_degree", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Average Degrees Traveled (degree)")


#Scatterplot
de3 <- ggscatter(df_men_loop_de, x = "dheas_spatial_ug_dl", y = "loop_de_avg_degree", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Average Degrees Traveled (degree)")

#Present as patchwork
de1 + de2 + de3
```



For LOOP degrees traveled, it seems to have a negative trend with hormones overall in men. SHBG seems to be marginally and negatively correlated with degrees traveled.

### MAZE

**Accuracy**

```{r}
#Subset
df_men_maze_accuracy <- df_men %>% 
  
  #Filter for loop degrees averaged
  #Average is of the 3 radii values for variable
  drop_na(maze_accuracy_pct)
```

```{r}
#Scatterplot
acc1 <- ggscatter(df_men_maze_accuracy, x = "shbg_spatial_nmol_l", y = "maze_accuracy_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Accuracy (%)")


#Scatterplot
acc2 <- ggscatter(df_men_maze_accuracy, x = "testosterone_spatial_ng_dl", y = "maze_accuracy_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Accuracy (%)")


#Scatterplot
acc3 <- ggscatter(df_men_maze_accuracy, x = "dheas_spatial_ug_dl", y = "maze_accuracy_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Accuracy (%)")

#Present as patchwork
acc1 + acc2 + acc3
```


No associations between MAZE accuracy and hormones for men.

**Moves**

```{r}
#Subset
df_men_maze_moves <- df_men %>% 
  
  #Filter for loop degrees averaged
  #Average is of the 3 radii values for variable
  drop_na(maze_moves)
```

```{r}
#Scatterplot
moves1 <- ggscatter(df_men_maze_moves, x = "shbg_spatial_nmol_l", y = "maze_moves", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Number of Moves")


#Scatterplot
moves2 <- ggscatter(df_men_maze_moves, x = "testosterone_spatial_ng_dl", y = "maze_moves", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Number of Moves")


#Scatterplot
moves3 <- ggscatter(df_men_maze_moves, x = "dheas_spatial_ug_dl", y = "maze_moves", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Number of Moves")


#Present as patchwork
moves1 + moves2 + moves3
```


Also no association between MAZE number of moves and hormones for men.

### DSP

**Wayfinding Success**

```{r}
#Subset
df_men_dsp_succ <- df_men %>% 
  
  #Filter for loop degrees averaged
  #Average is of the 3 radii values for variable
  drop_na(dsp_success_pct)
```

```{r}
#Scatterplot
succ1 <- ggscatter(df_men_dsp_succ, x = "shbg_spatial_nmol_l", y = "dsp_success_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Wayfinding Success(%)")


#Scatterplot
succ2 <- ggscatter(df_men_dsp_succ, x = "testosterone_spatial_ng_dl", y = "dsp_success_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Wayfinding Success(%)")


#Scatterplot
succ3 <- ggscatter(df_men_dsp_succ, x = "dheas_spatial_ug_dl", y = "dsp_success_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Wayfinding Success(%)")

#Present as patchwork
succ1 + succ2 + succ3
```


Overall no associations between DSP wayfinding success and hormones for men.

**Solution Index**

```{r}
#Subset
df_men_dsp_si <- df_men %>% 
  
  drop_na(dsp_si_true_pct)
```

```{r}
#Scatterplot
si1 <- ggscatter(df_men_dsp_si, x = "shbg_spatial_nmol_l", y = "dsp_si_true_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Solution Index (%)")


#Scatterplot
si2 <- ggscatter(df_men_dsp_si, x = "testosterone_spatial_ng_dl", y = "dsp_si_true_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Solution Index (%)")


#Scatterplot
si3 <- ggscatter(df_men_dsp_si, x = "dheas_spatial_ug_dl", y = "dsp_si_true_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Solution Index (%)")

#Present as patchwork
si1 + si2 + si3
```


No association between DSP solution index and hormones for men.


## {-}

<br>

## Female {.tabset}

### LOOP 

**Position Error**

```{r}
#Subset
df_women_loop_pe <- df_women %>% 
  
  drop_na(loop_pe_avg_m)
```

```{r}
#Test to see if fig and values same if not dropping hormones with NA values
test <- df_women %>% 
  
  drop_na(loop_pe_avg_m, estradiol_spatial_pg_ml)


#Same correlation and p-values compared to not dropping
#The points gathered near 0 for estradiol is just very low estradiol
test_fig <- ggscatter(test, x = "estradiol_spatial_pg_ml", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          xlab = "Estradiol (pg/mL)", ylab = "Average Position Error (m)")
#test_fig

#Same with ggplot scatterplot (limits of x-axis makes it seen like it is close to 0)
# ggplot(data = test, aes(x = estradiol_spatial_pg_ml,
#                         y = loop_pe_avg_m)) +
#   geom_point(size = 2, color = "darkgreen")
```

```{r}
#Scatterplot
pe1 <- ggscatter(df_women_loop_pe, x = "estradiol_spatial_pg_ml", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          xlab = "Estradiol (pg/mL)", ylab = "Average Position Error (m)")


#Scatterplot
pe2 <- ggscatter(df_women_loop_pe, x = "progesterone_spatial_ng_ml", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Progesterone (ng/mL)", ylab = "Average Position Error (m)")


#Scatterplot
pe3 <- ggscatter(df_women_loop_pe, x = "fsh_spatial_miu_ml", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "FSH (mIU/mL)", ylab = "Average Position Error (m)")


#Scatterplot
pe4 <- ggscatter(df_women_loop_pe, x = "shbg_spatial_nmol_l", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Average Position Error (m)")


#Scatterplot
pe5 <- ggscatter(df_women_loop_pe, x = "testosterone_spatial_ng_dl", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Average Position Error (m)")


#Scatterplot
pe6 <- ggscatter(df_women_loop_pe, x = "dheas_spatial_ug_dl", y = "loop_pe_avg_m", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Average Position Error (m)")


#Present as patchwork
(pe1 + pe2 + pe3)/(pe4 + pe5 + pe6)
```


For LOOP position error, there is a positive marginal trend with DHEAS for women.

**Degrees Traveled**

```{r}
#Subset
df_women_loop_de <- df_women %>% 
  
  drop_na(loop_de_avg_degree)
```

```{r}
#Scatterplot
de1 <- ggscatter(df_women_loop_de, x = "estradiol_spatial_pg_ml", y = "loop_de_avg_degree", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Estradiol (pg/mL)", ylab = "Average Degrees Traveled")


#Scatterplot
de2 <- ggscatter(df_women_loop_de, x = "progesterone_spatial_ng_ml", y = "loop_de_avg_degree", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Progesterone (ng/mL)", ylab = "Average Degrees Traveled")


#Scatterplot
de3 <- ggscatter(df_women_loop_de, x = "fsh_spatial_miu_ml", y = "loop_de_avg_degree", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "FSH (mIU/mL)", ylab = "Average Degrees Traveled")


#Scatterplot
de4 <- ggscatter(df_women_loop_de, x = "shbg_spatial_nmol_l", y = "loop_de_avg_degree", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Average Degrees Traveled")


#Scatterplot
de5 <- ggscatter(df_women_loop_de, x = "testosterone_spatial_ng_dl", y = "loop_de_avg_degree", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Average Degrees Traveled")


#Scatterplot
de6 <- ggscatter(df_women_loop_de, x = "dheas_spatial_ug_dl", y = "loop_de_avg_degree", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Average Degrees Traveled")


#Present as patchwork
(de1 + de2 + de3)/(de4 + de5 + de6)
```


No associations between LOOP degrees traveled and hormones for women.

### MAZE

**Accuracy**

```{r}
#Subset
df_women_maze_accuracy <- df_women %>% 
  
  drop_na(maze_accuracy_pct)
```

```{r}
#Scatterplot
acc1 <- ggscatter(df_women_maze_accuracy, x = "estradiol_spatial_pg_ml", y = "maze_accuracy_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Estradiol (pg/mL)", ylab = "Accuracy (%)")


#Scatterplot
acc2 <- ggscatter(df_women_maze_accuracy, x = "progesterone_spatial_ng_ml", y = "maze_accuracy_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Progesterone (ng/mL)", ylab = "Accuracy (%)")


#Scatterplot
acc3 <- ggscatter(df_women_maze_accuracy, x = "fsh_spatial_miu_ml", y = "maze_accuracy_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "FSH (mIU/mL)", ylab = "Accuracy (%)")


#Scatterplot
acc4 <- ggscatter(df_women_maze_accuracy, x = "shbg_spatial_nmol_l", y = "maze_accuracy_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Accuracy (%)")


#Scatterplot
acc5 <- ggscatter(df_women_maze_accuracy, x = "testosterone_spatial_ng_dl", y = "maze_accuracy_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Accuracy (%)")


#Scatterplot
acc6 <- ggscatter(df_women_maze_accuracy, x = "dheas_spatial_ug_dl", y = "maze_accuracy_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Accuracy (%)")

#Present as patchwork
(acc1 + acc2 + acc3)/(acc4 + acc5 + acc6)
```


No association between MAZE accuracy and hormones for women, except negatively and marginally correlated with testosterone.

**Moves**

```{r}
#Subset
df_women_maze_moves <- df_women %>% 
  
  drop_na(maze_moves)
```

```{r}
#Scatterplot
moves1 <- ggscatter(df_women_maze_moves, x = "estradiol_spatial_pg_ml", y = "maze_moves", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Estradiol (pg/mL)", ylab = "Number of Moves")


#Scatterplot
moves2 <- ggscatter(df_women_maze_moves, x = "progesterone_spatial_ng_ml", y = "maze_moves", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Progesterone (ng/mL)", ylab = "Number of Moves")


#Scatterplot
moves3 <- ggscatter(df_women_maze_moves, x = "fsh_spatial_miu_ml", y = "maze_moves", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "FSH (mIU/mL)", ylab = "Number of Moves")


#Scatterplot
moves4 <- ggscatter(df_women_maze_moves, x = "shbg_spatial_nmol_l", y = "maze_moves", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Number of Moves")


#Scatterplot
moves5 <- ggscatter(df_women_maze_moves, x = "testosterone_spatial_ng_dl", y = "maze_moves", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Number of Moves")


#Scatterplot
moves6 <- ggscatter(df_women_maze_moves, x = "dheas_spatial_ug_dl", y = "maze_moves", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Number of Moves")

#Present as patchwork
(moves1 + moves2 + moves3)/(moves4 + moves5 + moves6) 
```


For MAZE moves, it seems to be positively, marginally associated with DHEAS and negatively associated with testosterone for women.

### DSP

**Wayfinding Success**

```{r}
#Subset
df_women_dsp_succ <- df_women %>% 
  
  drop_na(dsp_success_pct)
```

```{r}
#Scatterplot
succ1 <- ggscatter(df_women_dsp_succ, x = "estradiol_spatial_pg_ml", y = "dsp_success_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Estradiol (pg/mL)", ylab = "Wayfinding Success (%)")


#Scatterplot
succ2 <- ggscatter(df_women_dsp_succ, x = "progesterone_spatial_ng_ml", y = "dsp_success_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Progesterone (ng/mL)", ylab = "Wayfinding Success (%)")


#Scatterplot
succ3 <- ggscatter(df_women_dsp_succ, x = "fsh_spatial_miu_ml", y = "dsp_success_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "FSH (mIU/mL)", ylab = "Wayfinding Success (%)")


#Scatterplot
succ4 <- ggscatter(df_women_dsp_succ, x = "shbg_spatial_nmol_l", y = "dsp_success_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Wayfinding Success (%)")


#Scatterplot
succ5 <- ggscatter(df_women_dsp_succ, x = "testosterone_spatial_ng_dl", y = "dsp_success_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Wayfinding Success (%)")


#Scatterplot
succ6 <- ggscatter(df_women_dsp_succ, x = "dheas_spatial_ug_dl", y = "dsp_success_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Wayfinding Success (%)")


#Present as patchwork
(succ1 + succ2 + succ3)/(succ4 + succ5 + succ6)
```


No associations between DSP wayfinding success and hormones for women.

**Solution Index**

```{r}
#Subset
df_women_dsp_si <- df_women %>% 
  
  drop_na(dsp_si_true_pct)
```

```{r}
#Scatterplot
si1 <- ggscatter(df_women_dsp_si, x = "estradiol_spatial_pg_ml", y = "dsp_si_true_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Estradiol (pg/mL)", ylab = "Solution Index (%)")


#Scatterplot
si2 <- ggscatter(df_women_dsp_si, x = "progesterone_spatial_ng_ml", y = "dsp_si_true_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Progesterone (ng/mL)", ylab = "Solution Index (%)")


#Scatterplot
si3 <- ggscatter(df_women_dsp_si, x = "fsh_spatial_miu_ml", y = "dsp_si_true_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "FSH (mIU/mL)", ylab = "Solution Index (%)")


#Scatterplot
si4 <- ggscatter(df_women_dsp_si, x = "shbg_spatial_nmol_l", y = "dsp_si_true_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "SHBG (nmol/L)", ylab = "Solution Index (%)")


#Scatterplot
si5 <- ggscatter(df_women_dsp_si, x = "testosterone_spatial_ng_dl", y = "dsp_si_true_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "Testosterone (ng/dL)", ylab = "Solution Index (%)")


#Scatterplot
si6 <- ggscatter(df_women_dsp_si, x = "dheas_spatial_ug_dl", y = "dsp_si_true_pct", 
          add = "reg.line",
          add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE,
          cor.method = "pearson",
          xlab = "DHEAS (ug/dL)", ylab = "Solution Index (%)")

#Present as patchwork
(si1 + si2 + si3)/(si4 + si5 + si6)
```


For DSP solution index, estradiol is marginally positively associated and FSH is negatively associated in women.


## {-}

<br>


# OSSD Figures


## Hormones Bar Graph for Women

```{r}
#Summary of hormones
ehormones_fig <- df_women %>% 
  group_by(repo_status_spatial) %>% 
  summarize(mean_estradiol = mean(estradiol_spatial_pg_ml),
            sd_estradiol = sd(estradiol_spatial_pg_ml),
            n_estradiol = n(),
            se_estradiol = sd(estradiol_spatial_pg_ml)/sqrt(n()), 
            .groups = "keep")

fhormones_fig <- df_women %>% 
  group_by(repo_status_spatial) %>% 
  summarize(mean_estradiol = mean(fsh_spatial_miu_ml),
            sd_estradiol = sd(fsh_spatial_miu_ml),
            n_estradiol = n(),
            se_estradiol = sd(fsh_spatial_miu_ml)/sqrt(n()), 
            .groups = "keep")
```


```{r hormone-plot}
#Estradiol plot
ggplot(data = df_women, aes(x = repo_status_spatial, 
                            y = estradiol_spatial_pg_ml, 
                            fill = repo_status_spatial))+
  
  #Define bar plot by mean
  geom_bar(stat="summary", fun= "mean",
           show.legend = FALSE)+ 
  
  #Add SEM errorbar
  stat_summary(geom = "errorbar", 
               fun.data = mean_se,
               width = 0.15, size = 0.7)+
  
  #Change labels
  labs(x = "Reproductive Status",
       y = expression(atop(paste(bold("17"),
                                 bold(beta),
                                 bold("-Estradiol (pg/mL)")),
                           )),
       tag = "A") +
  
  #Change colors of bars
  #Reverse color scale
  scale_fill_brewer(palette = "RdPu",
                    direction = -1)+
  
  #Change theme
  theme_classic() +
  
  #Customize theme
  theme(axis.title = element_text(size = 11, face = "bold"), 
        axis.text = element_text(size= 10))

#ggsave("estradiol_bar.png")


#FSH plot
ggplot(data = df_women, aes(x = repo_status_spatial, 
                            y = fsh_spatial_miu_ml, 
                            fill = repo_status_spatial))+
  
  #Define bar plot by mean
  geom_bar(stat="summary", fun= "mean",
           show.legend = FALSE)+ 
  
  #Add SEM errorbar
  stat_summary(geom = "errorbar", 
               fun.data = mean_se,
               width = 0.15, size = 0.7)+
  
  #Change labels
  labs(x = "Reproductive Status",
       y = "FSH (mIU/mL)\n",
       tag = "B") +
  
  #Change colors of bars
  #Reverse color scale
  scale_fill_brewer(palette = "RdPu",
                    direction = -1)+
  
  #Change theme
  theme_classic() +
  
  #Customize theme
  theme(axis.title = element_text(size = 11, face = "bold"), 
        axis.text = element_text(size= 10))

#ggsave("fsh_bar.png")
```



```{r}
#ANOVA of hormones
hormone_mod <- aov(estradiol_spatial_pg_ml ~ repo_status_spatial,
      data = df_women)
TukeyHSD(hormone_mod)

hormone_mod2 <- aov(fsh_spatial_miu_ml ~ repo_status_spatial,
      data = df_women)
TukeyHSD(hormone_mod2)
```


## Scatterplot of Solution Index and E/FSH

```{r}
#Create subset and columns for low, mid, high E/FSH
df_women_dsp <- df_women %>% 
  #Reorder repo status
  mutate(repo_status_spatial = fct_relevel(repo_status_spatial, 
                                         c("Pre", "Peri", "Post"))) %>% 
  
  filter(dsp_useable == "Yes") %>% 
  
  #High vs low E
  mutate(e_group = case_when(estradiol_spatial_pg_ml < quantile(estradiol_spatial_pg_ml,0.5) ~ "low",
                             between(estradiol_spatial_pg_ml, 
                                     quantile(estradiol_spatial_pg_ml, 0.5),
                                     quantile(estradiol_spatial_pg_ml, 0.75))~"medium", 
                      TRUE ~ 'high'),
         
         #FSH
         fsh_group = case_when(fsh_spatial_miu_ml < quantile(fsh_spatial_miu_ml,0.5, na.rm=TRUE) ~ "low",
                             between(fsh_spatial_miu_ml, 
                                     quantile(fsh_spatial_miu_ml, 0.5, na.rm=TRUE),
                                     quantile(fsh_spatial_miu_ml, 0.75, na.rm=TRUE))~"medium", 
                      TRUE ~ 'high'),
         
         
         #E half and half
         e50_group = case_when(estradiol_spatial_pg_ml < quantile(estradiol_spatial_pg_ml,0.5) ~ "low",
                      TRUE ~ 'high'),
         
         
         
         #FSH half and half)
        fsh50_group = case_when(fsh_spatial_miu_ml < quantile(fsh_spatial_miu_ml,0.5, na.rm=TRUE) ~ "low",
                      TRUE ~ 'high'),
        
        #E 33/33/33
        e33_group = case_when(estradiol_spatial_pg_ml < quantile(estradiol_spatial_pg_ml,0.5) ~ "low",
                      TRUE ~ 'high'))
         

#Save the new columns and export
#write_csv(df_women_dsp, here("data", "hormone_quantile_groups.csv"))



#Get mean and SD of age for this group
df_women_dsp %>% 
  summarize(mean_age = mean(age_spatial_years),
            sd_age = sd(age_spatial_years))
```

```{r}
#Scatter of estradiol and SI
a <- ggplot(data = df_women_dsp, aes(x = estradiol_spatial_pg_ml,
                            y = dsp_si_true_pct,
                            text = subject_id)) +
  
  #Define scatter, change size and alpha
  geom_point(aes(color = repo_status_spatial),
             size = 3, alpha = 0.6, show.legend = FALSE) +
  
  #Add LM line
  geom_smooth(method = "lm", se = FALSE,
              color = "grey50") +
  
  #Change labels
  labs(x = expression(paste(bold("17"),
                                 bold(beta),
                                 bold("-Estradiol (pg/mL)")),
                           ),
       y = "Solution Index (%)\n",
       color = "Reproductive Status") +
  
  #Change color of points
  scale_color_manual(values = c("cadetblue4", "mediumvioletred", "darkorange")) +
  
  theme_minimal() +
  
  #Customize theme
  theme(axis.title = element_text(size = 11, face = "bold"), 
        axis.title.x = element_text(vjust = -0.5),
        axis.text = element_text(size= 10))

a

#Plotly
#ggplotly(a)
```

```{r}
#FSH plot
b <- ggplot(data = df_women_dsp, aes(x = fsh_spatial_miu_ml,
                            y = dsp_si_true_pct,
                            text = subject_id)) +
  
  #Define scatter, change size and alpha
  geom_point(aes(color = repo_status_spatial),
             size = 3, alpha = 0.6) +
  
  #Add LM line
  geom_smooth(method = "lm", se = FALSE,
              color = "grey50") +
  
  #Change labels
  labs(x = "\nFSH (mIU/mL)",
       y = " ",
       color = "Reproductive Status") +
  
  #Change color of points
  scale_color_manual(values = c("cadetblue4", "mediumvioletred", "darkorange")) +
  
  theme_minimal() +
  
  #Customize theme
  theme(axis.title = element_text(size = 11, face = "bold"),
        axis.title.x = element_text(vjust = 2),
        axis.text = element_text(size= 10),
        
        #Legend
        #legend.title = element_text(face = "bold"),
        legend.position = "right"
        
        )

b

#Plotly
#ggplotly(b)
```


```{r}
#Combine
combined <- a + b & theme(legend.position = "bottom")
combined + plot_layout(guides = "collect")
#ggsave("hormone_correlations_legendbottom.png")
```


## Correlation Values

```{r}
########## Pearson
cor.test(df_women_dsp$estradiol_spatial_pg_ml,
         df_women_dsp$dsp_si_true_pct,
         conf.level = 0.95,
         method = "pearson")

#FSH
cor.test(df_women_dsp$fsh_spatial_miu_ml,
         df_women_dsp$dsp_si_true_pct,
         conf.level = 0.95,
         method = "pearson")



########## Spearman

#Estradiol
cor.test(df_women_dsp$estradiol_spatial_pg_ml,
         df_women_dsp$dsp_si_true_pct,
         conf.level = 0.95,
         method = "spearman")

#FSH
cor.test(df_women_dsp$fsh_spatial_miu_ml,
         df_women_dsp$dsp_si_true_pct,
         conf.level = 0.95,
         method = "spearman")
```
### Outlier Check

```{r}
outlier <- ggplot(data = df_women_dsp, aes(x = repo_status_spatial,
                            y = dsp_si_true_pct,
                            text = subject_id)) +
  
  #Define scatter, change size and alpha
  geom_boxplot() 


#Plotly
ggplotly(outlier)
```


### Normality check

```{r}
shapiro.test(df_women_dsp$dsp_si_true_pct)
shapiro.test(df_women_dsp$estradiol_spatial_pg_ml)
shapiro.test(df_women_dsp$fsh_spatial_miu_ml)
```

```{r}
#Simple transformation with sqrt or log
hist(sqrt(df_women_dsp$dsp_si_true_pct)) #right skewed
hist(log(df_women_dsp$estradiol_spatial_pg_ml)) #right skewed
hist(sqrt(df_women_dsp$fsh_spatial_miu_ml)) #right skewed
```


### Retest

Cannot transform to normal without letting it be too complicated.

```{r}
#Add transformation
df_dsp_norm <- df_women_dsp %>% 
  mutate_at(scale, .vars = vars(estradiol_spatial_pg_ml,
                                fsh_spatial_miu_ml,
                                dsp_si_true_pct))



#Retest normality
hist(df_dsp_norm$dsp_si_true_pct)
shapiro.test(df_dsp_norm$estradiol_spatial_pg_ml)
shapiro.test(df_dsp_norm$fsh_spatial_miu_ml)
```

## Heatmaps

### Original Repo

```{r}
#Read in data
hm_pre <- read_csv(here("data", "heatmaps", "PointingDSP_Pre.csv"))
hm_peri <- read_csv(here("data", "heatmaps", "PointingDSP_Peri.csv"))
hm_post <- read_csv(here("data", "heatmaps", "PointingDSP_Post.csv"))


#Pre heatmap
a <- ggplot(hm_pre, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 


b <- ggplot(hm_peri, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#Post
c <- ggplot(hm_post, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#Combined
a+b+c

#Save
#ggsave("heatmap_repo.png")
```


### Estradiol: low, med, high

```{r}
#Read in data
hm_elow <- read_csv(here("data", "heatmaps", "PointingDSP_ELow.csv"))
hm_emed <- read_csv(here("data", "heatmaps", "PointingDSP_EMed.csv"))
hm_ehigh <- read_csv(here("data", "heatmaps", "PointingDSP_EHigh.csv"))


#ELow heatmap
a <- ggplot(hm_elow, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#Emed
b <- ggplot(hm_emed, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#Ehigh
c <- ggplot(hm_ehigh, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#Combined
a+b+c

#Save
#ggsave("heatmap_egroup.png")
```


### Estradiol: low and high

```{r}
#Read in data
hm_e50low <- read_csv(here("data", "heatmaps", "PointingDSP_E50Low.csv"))
hm_e50high <- read_csv(here("data", "heatmaps", "PointingDSP_E50High.csv"))


#ELow heatmap
a <- ggplot(hm_e50low, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#Ehigh heatmap
b <- ggplot(hm_e50high, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#Combined
a+b

#Save
#ggsave("heatmap_egroup.png")
```


### FSH: low, med, high

```{r}
#Read in data
hm_fshlow <- read_csv(here("data", "heatmaps", "PointingDSP_FSHLow.csv"))
hm_fshmed <- read_csv(here("data", "heatmaps", "PointingDSP_FSHMed.csv"))
hm_fshhigh <- read_csv(here("data", "heatmaps", "PointingDSP_FSHHigh.csv"))


#FSHLow heatmap
a <- ggplot(hm_fshlow, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#FSHmed
b <- ggplot(hm_fshmed, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#FSHhigh
c <- ggplot(hm_fshhigh, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#Combined
a+b+c

#Save
#ggsave("heatmap_egroup.png")
```


### FSH: low and high

```{r}
#Read in data
hm_fsh50low <- read_csv(here("data", "heatmaps", "PointingDSP_FSH50Low.csv"))
hm_fsh50high <- read_csv(here("data", "heatmaps", "PointingDSP_FSH50High.csv"))


#FSHLow heatmap
a <- ggplot(hm_fsh50low, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#FSHhigh heatmap
b <- ggplot(hm_fsh50high, aes(x=x, y=z) ) +
  stat_density_2d(aes(fill = ..density..), geom = "raster", contour = FALSE) +
  #scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_fill_distiller(palette= "RdYlGn", direction=-1) +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  theme_void()+
  theme(legend.position='none') 

#Combined
a+b

#Save
#ggsave("heatmap_egroup.png")
```


# Summary


Still waiting on analysis for remainder of FSH, SHBG, and DHEAS. But rerunning correlations with updated hormone data so far show:

- For LOOP position error and DHEAS, there is a positive association for men and positive marginal association for women. For degrees traveled, there is a negative marginal association between SHBG and degrees traveled for men .

- For MAZE, there are no associations for men. For women, there is a negative marginal correlation with accuracy and testosterone, and a negative correlation for moves made with testosterone.

- For DSP, there are no associations for men. For women, there is a positive marginal correlation with solution index and estradiol, and a negative correlation between solution index and FSH.


Future directions: 

- Wait for the remainder of the hormones and re-evaluate with spatial navigation behaviors for men and women

- Consider other covariates like spatial navigation batteries (e.g., SBSOD) for multiple regression model.



