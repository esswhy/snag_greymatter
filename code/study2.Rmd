---
title: 'Study 2: T2 Subfield, Spatial Behavior, Sex Hormones'
author: "Shuying Yu"
date: "8/5/2022"
output: html_document
---

```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,
                      include = FALSE)

#Attach libraries
library(tidyverse)
library(here)
library(janitor)
library(ggpubr)
library(patchwork)
library(kableExtra)
library(foreign)
library(RColorBrewer)
library(plotly)
library(readr)
```


# Introduction

Study 1 has shown that there is a correlation between sex hormones and spatial navigation strategy, such that higher estradiol is positively associated with higher use of shortcuts in the DSP task (higher solution index). Higher FSH, on the other hand, was marginally negatively associated with shortcut use (lower solution index) using Spearman rank correlations.

Here, I determine whether there are associations between T2 high-resolution hippocampal subfield volume and spatial navigation behaviors, and sex hormones and subfield volume. Later, I determine how subfield volume mediates the relationship between sex hormones and behavior for navigation strategy.

Prior exploratory analysis for relationships between sex hormones and subfield volume reveal certain significant relationships (`correlation_greymatter_hormones_corrected.Rmd`).

Here, I will explore whether there are any relationships between spatial navigation behaviors and T2 subfield volumes. Next, I plan to apply causal mediation analysis to investigate whether the effect of sex hormones (IV) on spatial behavior (DV) is mediated by participants' subfield volume (mediator, T2 subfield).


# Data Analysis

I cleaned some of the data prior to analyses. I had to:

1) Filter for midlife participants that have T2 subfield data (subject 333 and over)
2) Select sex hormone measures from when scan was conducted
3) Correct for subfield volumes using TIV, which is a combination of GMV, WMV, CSF. Divide the volumes by TIV variable (`t2hipp_vol_tiv`)
4) Average left and right volumes to get an average measure for each subfield and brain region



```{r}
#Read in the data
data <- read_csv(here("data", "HAS_SNAG_mastersheet_tidy.csv"))

#Filter for midlife, has snag data, has t2hipp data
data <- data %>% 
  filter(age_group == "Midlife", 
         completed_spatial == "Yes",
         t2hipp_status == "Yes") %>% 
  select(subject_id, sex, age_scan_years:testosterone_spatial_ng_dl,
         t2hipp_vol_left_ca1:t2hipp_vol_csf) %>% 
  mutate(repo_status_spatial = fct_relevel(repo_status_spatial, 
                                    c("Pre", "Peri", "Post")))

#Create function for apply to variables
dividebyTIV <- function(x, na.rm = FALSE) (x/data$t2hipp_vol_tiv)

#Correct left and right volumes with TIV
data <- data %>% 
  mutate_at(vars(t2hipp_vol_left_ca1:t2hipp_vol_right_sub),
            dividebyTIV)

#Average left and right volumes
data <- data %>% 
  mutate(t2hipp_vol_ca1_cor = (t2hipp_vol_left_ca1+t2hipp_vol_right_ca1) / 2,
         t2hipp_vol_ca23_cor = (t2hipp_vol_left_ca23+t2hipp_vol_right_ca23) / 2,
         t2hipp_vol_dg_cor = (t2hipp_vol_left_dg+t2hipp_vol_right_dg) / 2,
         t2hipp_vol_erc_cor = (t2hipp_vol_left_erc+t2hipp_vol_right_erc) / 2,
         t2hipp_vol_phc_cor = (t2hipp_vol_left_phc+t2hipp_vol_right_phc) / 2,
         t2hipp_vol_prc_cor = (t2hipp_vol_left_prc+t2hipp_vol_right_prc) / 2,
         t2hipp_vol_sub_cor = (t2hipp_vol_left_sub+t2hipp_vol_right_sub) / 2
         # t2hipp_vol_totalhipp_cor = t2hipp_vol_totalhipp / 2,
         # t2hipp_vol_phg_cor = t2hipp_vol_phg / 2,
         # t2hipp_vol_mtl_cor = t2hipp_vol_mtl / 2
         )

#Separate for SNAG
data_loop <- data %>% 
  filter(loop_useable == "Yes")
data_maze <- data %>% 
  filter(maze_useable == "Yes")
data_dsp <- data %>% 
  filter(dsp_useable == "Yes")

#Separate for women and men
data_women <- data %>% 
  filter(sex == "Female", dsp_useable == "Yes") 
data_men <- data %>% 
  filter(sex == "Male", dsp_useable == "Yes")
```


## Correlations for Behavior and T2 Subfields {.tabset}

### Behavioral Distributions

From prior analyses, we know that the subfield volumes are generally normally distributed. We can check the distribution of the SNAG dependent variables


```{r distributions-qqplots}
#LOOP: normally distributed, no need to transform
h1 <- ggplot(data = data_loop, aes(x = loop_pe_avg_m)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Position Error (m)",
       y = "Count",
       title = "LOOP: Histogram \nPosition Error")
h2 <- ggplot(data = data_loop, aes(x = loop_de_avg_degree)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Degrees Traveled",
       y = "Count",
       title = "LOOP: Histogram \nDegrees Traveled")
h1q <- ggqqplot(data = data_loop$loop_pe_avg_m) +
  labs(title = "LOOP: QQ-plot \nPosition Error")
h2q <- ggqqplot(data = data_loop$loop_de_avg_degree) +
  labs(title = "LOOP: QQ-plot \nDegrees Traveled")


#MAZE:right and left skewed, log transform
h3 <- ggplot(data = data_maze, aes(x = maze_accuracy_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nAccuracy")
h3a <- ggplot(data = data_maze, aes(x = log(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nLog Accuracy")
h3b <- ggplot(data = data_maze, aes(x = sqrt(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Accuracy")
h3q <- ggqqplot(data = data_maze$maze_accuracy_pct) +
  labs(title = "MAZE: QQ-plot \nAccuracy")
h3aq <- ggqqplot(data = log(data_maze$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nLog Accuracy")
h3bq <- ggqqplot(data = sqrt(data_maze$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nSqrt Accuracy")

h4 <- ggplot(data = data_maze, aes(x = maze_moves)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nMoves")
h4a <- ggplot(data = data_maze, aes(x = log(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nLog Moves")
h4b <- ggplot(data = data_maze, aes(x = sqrt(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Moves")
h4q <- ggqqplot(data = data_maze$maze_moves) +
  labs(title = "MAZE: QQ-plot \nMoves")
h4aq <- ggqqplot(data = log(data_maze$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nLog Moves")
h4bq <- ggqqplot(data = sqrt(data_maze$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nSqrt Moves")



#DSP: slight left and right skew so apply transformation
h5 <- ggplot(data = data_dsp, aes(x = dsp_success_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSuccess")
h5a <- ggplot(data = data_dsp, aes(x = log(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Success")
h5b <- ggplot(data = data_dsp, aes(x = sqrt(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Success")
h5q <- ggqqplot(data = data_dsp$dsp_success_pct) +
  labs(title = "DSP: QQ-plot \nSuccess")
h5aq <- ggqqplot(data = log(data_dsp$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nLog Success")
h5bq <- ggqqplot(data = sqrt(data_dsp$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Success")


h6 <- ggplot(data = data_dsp, aes(x = dsp_si_true_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSolution Index")
h6a <- ggplot(data = data_dsp, aes(x = log(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Solution Index")
h6b <- ggplot(data = data_dsp, aes(x = sqrt(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Solution Index")
h6q <- ggqqplot(data = data_dsp$dsp_si_true_pct) +
  labs(title = "DSP: QQ-plot \nSolution Index")
h6aq <- ggqqplot(data = log(data_dsp$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nLog Solution Index")
h6bq <- ggqqplot(data = sqrt(data_dsp$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Solution Index")

#Present

#LOOP
(h1+h2)/(h1a+h2a)
#MAZE
(h3+h3a+h3b)/(h3q+h3aq+h3bq)
(h4+h4a+h4b)/(h4q+h4aq+h4bq)
#DSP
(h5+h5a+h5b)/(h5q+h5aq+h5bq)
(h6+h6a+h6b)/(h6q+h6aq+h6bq)
```

LOOP dependent variables are normally distributed, but MAZE and DSP variables have slight skews. I applied log and square root transformations to these variables in MAZE and DSP to allow for exploratory Pearson correlations.

Transformations for MAZE appear to not do much, and DSP wayfinding success. The square root transformation for DSP solution index makes it look more normal.

We can also look at the QQ plots

We can check Shapiro-Wilk's to see if normality is still violated.

```{r shapiro-check}
## is the DV significantly diffrent than normal?

#LOOP
shapiro.test(data_loop$loop_pe_avg_m) #no
shapiro.test(data_loop$loop_de_avg_degree) #no

#MAZE
shapiro.test(data_maze$maze_accuracy_pct) #yes
shapiro.test(data_maze$maze_moves) #yes

shapiro.test(log(data_maze$maze_accuracy_pct)) #yes
shapiro.test(log(data_maze$maze_moves)) #yes

shapiro.test(sqrt(data_maze$maze_accuracy_pct)) #yes
shapiro.test(sqrt(data_maze$maze_moves)) #yes


#DSP
shapiro.test(data_dsp$dsp_success_pct) #yes
shapiro.test(data_dsp$dsp_si_true_pct) #yes

shapiro.test(log(data_dsp$dsp_success_pct)) #yes
shapiro.test(log(data_dsp$dsp_si_true_pct)) #yes

shapiro.test(sqrt(data_dsp$dsp_success_pct)) #yes
shapiro.test(sqrt(data_dsp$dsp_si_true_pct)) #yes
```




```{r log-transformation}
data_maze_log <- data_maze %>% 
  mutate_at(vars(maze_accuracy_pct,maze_moves), log)

data_dsp_log <- data_dsp %>% 
  mutate_at(vars(dsp_success_pct, dsp_si_true_pct), log)
```


### LOOP {.tabset}

Pearson correlations

#### Position Error

```{r}
#CA1
c1 <- ggscatter(data_loop, x = "t2hipp_vol_ca1_cor", y = "loop_pe_avg_m", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nPosition Error (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c1a <- ggscatter(data_loop, x = "t2hipp_vol_ca1_cor", y = "loop_pe_avg_m", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#CA23
c2 <- ggscatter(data_loop, x = "t2hipp_vol_ca23_cor", y = "loop_pe_avg_m", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nPosition Error (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c2a <- ggscatter(data_loop, x = "t2hipp_vol_ca23_cor", y = "loop_pe_avg_m", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#DG
c3 <- ggscatter(data_loop, x = "t2hipp_vol_dg_cor", y = "loop_pe_avg_m", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nPosition Error (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c3a <- ggscatter(data_loop, x = "t2hipp_vol_dg_cor", y = "loop_pe_avg_m", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#ERC
c4 <- ggscatter(data_loop, x = "t2hipp_vol_erc_cor", y = "loop_pe_avg_m", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nPosition Error (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c4a <- ggscatter(data_loop, x = "t2hipp_vol_erc_cor", y = "loop_pe_avg_m", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PHC
c5 <- ggscatter(data_loop, x = "t2hipp_vol_phc_cor", y = "loop_pe_avg_m", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nPosition Error (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c5a <- ggscatter(data_loop, x = "t2hipp_vol_phc_cor", y = "loop_pe_avg_m", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PRC
c6 <- ggscatter(data_loop, x = "t2hipp_vol_prc_cor", y = "loop_pe_avg_m", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nPosition Error (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c6a <- ggscatter(data_loop, x = "t2hipp_vol_prc_cor", y = "loop_pe_avg_m", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#SUB
c7 <- ggscatter(data_loop, x = "t2hipp_vol_sub_cor", y = "loop_pe_avg_m", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nPosition Error (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c7a <- ggscatter(data_loop, x = "t2hipp_vol_sub_cor", y = "loop_pe_avg_m", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nPosition Error (m)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")


#Patchwork
c1+c1a
c2+c2a
c3+c3a
c4+c4a
c5+c5a
c6+c6a
c7+c7a
```


#### Degrees Traveled

```{r}
#CA1
c1 <- ggscatter(data_loop, x = "t2hipp_vol_ca1_cor", y = "loop_de_avg_degree", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c1a <- ggscatter(data_loop, x = "t2hipp_vol_ca1_cor", y = "loop_de_avg_degree", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#CA23
c2 <- ggscatter(data_loop, x = "t2hipp_vol_ca23_cor", y = "loop_de_avg_degree", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c2a <- ggscatter(data_loop, x = "t2hipp_vol_ca23_cor", y = "loop_de_avg_degree", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#DG
c3 <- ggscatter(data_loop, x = "t2hipp_vol_dg_cor", y = "loop_de_avg_degree", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c3a <- ggscatter(data_loop, x = "t2hipp_vol_dg_cor", y = "loop_de_avg_degree", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#ERC
c4 <- ggscatter(data_loop, x = "t2hipp_vol_erc_cor", y = "loop_de_avg_degree", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c4a <- ggscatter(data_loop, x = "t2hipp_vol_erc_cor", y = "loop_de_avg_degree", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PHC
c5 <- ggscatter(data_loop, x = "t2hipp_vol_phc_cor", y = "loop_de_avg_degree", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c5a <- ggscatter(data_loop, x = "t2hipp_vol_phc_cor", y = "loop_de_avg_degree", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PRC
c6 <- ggscatter(data_loop, x = "t2hipp_vol_prc_cor", y = "loop_de_avg_degree", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c6a <- ggscatter(data_loop, x = "t2hipp_vol_prc_cor", y = "loop_de_avg_degree", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#SUB
c7 <- ggscatter(data_loop, x = "t2hipp_vol_sub_cor", y = "loop_de_avg_degree", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c7a <- ggscatter(data_loop, x = "t2hipp_vol_sub_cor", y = "loop_de_avg_degree", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")


#Patchwork
c1+c1a
c2+c2a
c3+c3a
c4+c4a
c5+c5a
c6+c6a
c7+c7a
```


### {-}

### MAZE {.tabset}

Spearman rank correlations


#### Wayfinding Success

```{r}
#CA1
c1 <- ggscatter(data_maze, x = "t2hipp_vol_ca1_cor", y = "maze_accuracy_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

c1a <- ggscatter(data_maze, x = "t2hipp_vol_ca1_cor", y = "maze_accuracy_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#CA23
c2 <- ggscatter(data_maze, x = "t2hipp_vol_ca23_cor", y = "maze_accuracy_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c2a <- ggscatter(data_maze, x = "t2hipp_vol_ca23_cor", y = "maze_accuracy_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#DG
c3 <- ggscatter(data_maze, x = "t2hipp_vol_dg_cor", y = "maze_accuracy_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c3a <- ggscatter(data_maze, x = "t2hipp_vol_dg_cor", y = "maze_accuracy_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#ERC
c4 <- ggscatter(data_maze, x = "t2hipp_vol_erc_cor", y = "maze_accuracy_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c4a <- ggscatter(data_maze, x = "t2hipp_vol_erc_cor", y = "maze_accuracy_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PHC
c5 <- ggscatter(data_maze, x = "t2hipp_vol_phc_cor", y = "maze_accuracy_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c5a <- ggscatter(data_maze, x = "t2hipp_vol_phc_cor", y = "maze_accuracy_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PRC
c6 <- ggscatter(data_maze, x = "t2hipp_vol_prc_cor", y = "maze_accuracy_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c6a <- ggscatter(data_maze, x = "t2hipp_vol_prc_cor", y = "maze_accuracy_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#SUB
c7 <- ggscatter(data_maze, x = "t2hipp_vol_sub_cor", y = "maze_accuracy_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c7a <- ggscatter(data_maze, x = "t2hipp_vol_sub_cor", y = "maze_accuracy_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")


#Patchwork
c1+c1a
c2+c2a
c3+c3a
c4+c4a
c5+c5a
c6+c6a
c7+c7a
```


```{r}
#CA1
c1 <- ggscatter(data_maze, x = "t2hipp_vol_ca1_cor", y = "maze_moves", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nNumber of Moves") +
    theme(legend.position = "top", legend.title=element_blank()) 

c1a <- ggscatter(data_maze, x = "t2hipp_vol_ca1_cor", y = "maze_moves", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#CA23
c2 <- ggscatter(data_maze, x = "t2hipp_vol_ca23_cor", y = "maze_moves", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nNumber of Moves", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c2a <- ggscatter(data_maze, x = "t2hipp_vol_ca23_cor", y = "maze_moves", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#DG
c3 <- ggscatter(data_maze, x = "t2hipp_vol_dg_cor", y = "maze_moves", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nNumber of Moves", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c3a <- ggscatter(data_maze, x = "t2hipp_vol_dg_cor", y = "maze_moves", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#ERC
c4 <- ggscatter(data_maze, x = "t2hipp_vol_erc_cor", y = "maze_moves", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nNumber of Moves", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c4a <- ggscatter(data_maze, x = "t2hipp_vol_erc_cor", y = "maze_moves", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PHC
c5 <- ggscatter(data_maze, x = "t2hipp_vol_phc_cor", y = "maze_moves", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nNumber of Moves", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c5a <- ggscatter(data_maze, x = "t2hipp_vol_phc_cor", y = "maze_moves", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PRC
c6 <- ggscatter(data_maze, x = "t2hipp_vol_prc_cor", y = "maze_moves", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nNumber of Moves", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c6a <- ggscatter(data_maze, x = "t2hipp_vol_prc_cor", y = "maze_moves", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#SUB
c7 <- ggscatter(data_maze, x = "t2hipp_vol_sub_cor", y = "maze_moves", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nNumber of Moves", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c7a <- ggscatter(data_maze, x = "t2hipp_vol_sub_cor", y = "maze_moves", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")


#Patchwork
c1+c1a
c2+c2a
c3+c3a
c4+c4a
c5+c5a
c6+c6a
c7+c7a
```


### {-}


### DSP {.tabset}

Spearman rank correlations

#### Wayfinding Success

```{r}
#CA1
c1 <- ggscatter(data_dsp, x = "t2hipp_vol_ca1_cor", y = "dsp_success_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

c1a <- ggscatter(data_dsp, x = "t2hipp_vol_ca1_cor", y = "dsp_success_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#CA23
c2 <- ggscatter(data_dsp, x = "t2hipp_vol_ca23_cor", y = "dsp_success_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c2a <- ggscatter(data_dsp, x = "t2hipp_vol_ca23_cor", y = "dsp_success_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#DG
c3 <- ggscatter(data_dsp, x = "t2hipp_vol_dg_cor", y = "dsp_success_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c3a <- ggscatter(data_dsp, x = "t2hipp_vol_dg_cor", y = "dsp_success_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#ERC
c4 <- ggscatter(data_dsp, x = "t2hipp_vol_erc_cor", y = "dsp_success_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c4a <- ggscatter(data_dsp, x = "t2hipp_vol_erc_cor", y = "dsp_success_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PHC
c5 <- ggscatter(data_dsp, x = "t2hipp_vol_phc_cor", y = "dsp_success_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c5a <- ggscatter(data_dsp, x = "t2hipp_vol_phc_cor", y = "dsp_success_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PRC
c6 <- ggscatter(data_dsp, x = "t2hipp_vol_prc_cor", y = "dsp_success_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c6a <- ggscatter(data_dsp, x = "t2hipp_vol_prc_cor", y = "dsp_success_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#SUB
c7 <- ggscatter(data_dsp, x = "t2hipp_vol_sub_cor", y = "dsp_success_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nWayfinding Success (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c7a <- ggscatter(data_dsp, x = "t2hipp_vol_sub_cor", y = "dsp_success_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")


#Patchwork
c1+c1a
c2+c2a
c3+c3a
c4+c4a
c5+c5a
c6+c6a
c7+c7a
```

#### Solution Index

```{r}
#CA1
c1 <- ggscatter(data_dsp, x = "t2hipp_vol_ca1_cor", y = "dsp_si_true_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nSolution Index (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

c1a <- ggscatter(data_dsp, x = "t2hipp_vol_ca1_cor", y = "dsp_si_true_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA1 Subfield Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#CA23
c2 <- ggscatter(data_dsp, x = "t2hipp_vol_ca23_cor", y = "dsp_si_true_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nSolution Index (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c2a <- ggscatter(data_dsp, x = "t2hipp_vol_ca23_cor", y = "dsp_si_true_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged CA23 Subfield Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#DG
c3 <- ggscatter(data_dsp, x = "t2hipp_vol_dg_cor", y = "dsp_si_true_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nSolution Index (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c3a <- ggscatter(data_dsp, x = "t2hipp_vol_dg_cor", y = "dsp_si_true_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged DG Subfield Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#ERC
c4 <- ggscatter(data_dsp, x = "t2hipp_vol_erc_cor", y = "dsp_si_true_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nSolution Index (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c4a <- ggscatter(data_dsp, x = "t2hipp_vol_erc_cor", y = "dsp_si_true_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged ERC Subfield Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PHC
c5 <- ggscatter(data_dsp, x = "t2hipp_vol_phc_cor", y = "dsp_si_true_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nSolution Index (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c5a <- ggscatter(data_dsp, x = "t2hipp_vol_phc_cor", y = "dsp_si_true_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PHC Subfield Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#PRC
c6 <- ggscatter(data_dsp, x = "t2hipp_vol_prc_cor", y = "dsp_si_true_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nSolution Index (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c6a <- ggscatter(data_dsp, x = "t2hipp_vol_prc_cor", y = "dsp_si_true_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged PRC Subfield Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

#SUB
c7 <- ggscatter(data_dsp, x = "t2hipp_vol_sub_cor", y = "dsp_si_true_pct", color = "repo_status_spatial",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nSolution Index (%)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

c7a <- ggscatter(data_dsp, x = "t2hipp_vol_sub_cor", y = "dsp_si_true_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged SUB Subfield Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")


#Patchwork
c1+c1a
c2+c2a
c3+c3a
c4+c4a
c5+c5a
c6+c6a
c7+c7a
```


### {-}



## {-}

# Summary

- For LOOP, 




## Total Effect (Hormones -> Behavior)


```{r}
#Estradiol

#wayfinding success
fit.totaleffect <- lm(dsp_success_pct ~ estradiol_spatial_pg_ml,
                     data = data_women)
summary(fit.totaleffect)

#solution index
fit.totaleffect <- lm(dsp_si_true_pct ~ estradiol_spatial_pg_ml,
                     data = data_women)
summary(fit.totaleffect)
```

There doesnt necessarily have to be a significant relationship between the iv and the dv. Just as correlation doesnt prove causation, no correlation does not disprove causation 

## IV on Mediator

```{r}

```








## Subregion Volume and Spatial Behavior


Assessing any relationships between subregion volume and SNAG behavior, specifically with DSP. First, check normality of the volume data

```{r}
#Subregions
par(mfrow=c(2,2))
hist(data_women$t2hipp_vol_ca1_cor)
hist(data_women$t2hipp_vol_ca23_cor)
hist(data_women$t2hipp_vol_mtl_cor)
hist(data_women$t2hipp_vol_totalhipp_cor)


#DSP 
par(mfrow=c(1,2))
hist(data_women$dsp_success_pct)
hist(data_women$dsp_si_true_pct)
```
Subregion volumes appear to be normally distributed. There is an outlier wirh the MTL corrected subregion volume (max 20997.82 compared to mean of 7986.304).

For DSP, wayfinding success if left skewed and solution index is right skewed. I try to see if I can take the log of these dependent variables to normalize them for Pearson correlation

```{r}
#log transform
par(mfrow=c(1,2))
hist(log(data_women$dsp_success_pct))
hist(log(data_women$dsp_si_true_pct))

#inverse
par(mfrow=c(1,2))
hist((data_women$dsp_success_pct)^-1)
hist((data_women$dsp_si_true_pct)^-1)

#square root
par(mfrow=c(1,2))
hist(sqrt(data_women$dsp_success_pct))
hist(sqrt(data_women$dsp_si_true_pct))
```

Log transformation and square root makes the DSP dependent variable more normally distributed, moreso for solution index than for wayfinding success. Use spearman rank correlation instead.


```{r}
#Correlations: wayfinding success and CA1, CS23, MTL, totalhipp

########## Spearman for wayfinding success

#CA1
cor.test(data_women$t2hipp_vol_ca1_cor,
         data_women$dsp_success_pct,
         conf.level = 0.95,
         method = "spearman")

#CA23
cor.test(data_women$t2hipp_vol_ca23_cor,
         data_women$dsp_success_pct,
         conf.level = 0.95,
         method = "spearman")

#MTL
cor.test(data_women$t2hipp_vol_mtl_cor,
         data_women$dsp_success_pct,
         conf.level = 0.95,
         method = "spearman")

#Total hipp
cor.test(data_women$t2hipp_vol_totalhipp_cor,
         data_women$dsp_success_pct,
         conf.level = 0.95,
         method = "spearman")
```


```{r}
#Correlations: solution index and CA1, CS23, MTL, totalhipp

########## Spearman for solution index

#CA1
cor.test(data_women$t2hipp_vol_ca1_cor,
         data_women$dsp_si_true_pct,
         conf.level = 0.95,
         method = "spearman")

#CA23
cor.test(data_women$t2hipp_vol_ca23_cor,
         data_women$dsp_si_true_pct,
         conf.level = 0.95,
         method = "spearman")

#MTL
cor.test(data_women$t2hipp_vol_mtl_cor,
         data_women$dsp_si_true_pct,
         conf.level = 0.95,
         method = "spearman")

#Total hipp
cor.test(data_women$t2hipp_vol_totalhipp_cor,
         data_women$dsp_si_true_pct,
         conf.level = 0.95,
         method = "spearman")
```






























