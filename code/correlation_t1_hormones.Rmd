---
title: 'Study 2: T1 and correlations for hormones and SNAG'
author: "Shuying Yu"
date: "11/26/2022"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 4
    theme: flatly
---

```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, 
                      include = FALSE, fig.align = "center")

#Add libraries
library(tidyverse)
library(here)
library(janitor)
library(ggpubr)
library(patchwork)
library(kableExtra)
library(readxl)
library(knitr)
library(broom)
library(purrr)
```


*Modified on:* Februaray 28th, 2023


# Overview


This report provides exploratory and preliminary correlation analyses between sex hormones and T1 hippocampal ROI data extracted from AAL for the Healthy Aging Study sample that have completed spatial navigation behavior. Mask was selected for left and right hippocampus, using 2D dilation 1 on registered (not smoothed) segmented grey matter using Wake Forest University PickAtlas and MarsBaR toolboxes in SPM12.

**Cleaning data steps included (T1 hipp):**

1) Filter participants that have T1 data from scan and have completed spatial

2) Select sex hormone measures from when spatial was conducted

3) Average left and right volumes to get a single measure

4) Correct averaged volume with TIV


```{r data_wrangling}
#Read in the data
data <- read_csv(here("data", "HAS_SNAG_mastersheet_tidy.csv"))

#Select and filter variables
data <- data %>%
  filter(age_group == "Midlife",
         t1_status == "Yes",
         completed_spatial == "Yes") %>% 
  dplyr::select(subject_id, sex, age_spatial_years, repo_status,
         loop_useable:testosterone_spatial_ng_dl,
         t1_vbm_tiv:t1_vol_right_hipp_aal_3d_d1_s) %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post", "Men"))) %>% 

  #Further exclude this subject:
  filter(!subject_id %in% c(
    #"309", #bad participant
    #"316", #vertigo/took Wellbutrin for mood and Lipitor for cholesterol 7 days/week of scan
     "329", #on prednisone 7 days/week of scan
    #"352", #current MDD/depression
     "372" #past neuroschistosomiasis at 24 years old
  ))


#Correct with TIV and average
#Create function for apply to variables
dividebyTIV <- function(x, na.rm = FALSE) (x/data$t1_vbm_tiv)

#Apply function to variables
data <- data %>% 
  
  #Rename left and right regions
  rename(left_t1_hipp = t1_vol_left_hipp_aal_2d_d1_r,
         right_t1_hipp = t1_vol_right_hipp_aal_2d_d1_r) %>% 
  
  #Average left and right regions
  #No need to multiply since values are the same proportion
  mutate(avg_t1_hipp = (left_t1_hipp + right_t1_hipp)/2) %>% 
  
  #Correct using TIV from SPM VBM
  mutate_at(vars(avg_t1_hipp, left_t1_hipp, right_t1_hipp),
            dividebyTIV) %>% 

  #Multiply to get proportions
  mutate(avg_t1_hipp = avg_t1_hipp*1000,
         left_t1_hipp = left_t1_hipp*1000,
         right_t1_hipp = right_t1_hipp*1000)


#Create subsets
#Subset for women by repo status
data_repo <- data %>% 
  filter(sex == "Female") %>% 
  mutate(repo_status = fct_relevel(repo_status, 
                                    c("Pre", "Peri", "Post")))
#Subset for men
data_men <- data %>% 
  filter(sex == "Male")
```


```{r demo-table, include=TRUE, echo=FALSE}
#Table overall
tab_overall <- data %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years))

#Table LOOP
tab_loop <- data %>% 
  filter(loop_useable == "Yes") %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years))

#Table MAZE
tab_maze <- data %>% 
  filter(maze_useable == "Yes") %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years))


#Table DSP
tab_dsp <- data %>% 
  filter(dsp_useable == "Yes") %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years))


#Join df based on sex
tab1 <- merge(tab_overall, tab_loop, by = "sex")

#Rename columns
tab1 <- tab1 %>% 
  rename(n_subject_overall = n_subject.x,
         age_mean_overall = age_mean.x,
         age_sd_overall = age_Sd.x,
         n_subject_loop = n_subject.y,
         age_mean_loop = age_mean.y,
         age_sd_loop = age_Sd.y)

#Rest of the merge
tab2 <- merge(tab1, tab_maze, by = "sex")
tab_final <- merge(tab2, tab_dsp, by = "sex")


#Rename columns
tab_final <- tab_final %>% 
  rename(n_subject_maze = n_subject.x,
         age_mean_maze = age_mean.x,
         age_sd_maze = age_Sd.x,
         n_subject_dsp = n_subject.y,
         age_mean_dsp = age_mean.y,
         age_sd_dsp = age_Sd.y)

#Kable presentation (ideal if we had all hormones)
tab_final %>% 
  kable(col.names = c("Sex", "n","Mean Age","SD Age",
                      "n","Mean Age","SD Age",
                      "n","Mean Age","SD Age",
                      "n","Mean Age","SD Age"),
        caption = "Sample size and age for women and men grouped by overall completion of spatial navigation behavior with T1 scan.",
        digits = 2,
        align = c("l", rep("c", times = 11))) %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12) %>%
  add_header_above(c(" " = 1, "Overall" = 3, 
                     "LOOP" = 3, "MAZE" = 3, "DSP" = 3))
```
Above table shows the table of sample size and mean and standard deviation of age by sex for overall group who have completed spatial behavior and have a T1 scan.

All sample size for T1 x hormone correlations for women are listed in the table above. For men, because some participants did not have all hormones evaluated (e.g, only testosterone available), the sample size for the correlations for that hormone and with T1 hipp volume will be different.

For men, the accurate sample sizes would be:

- LOOP: *n* = 16 DHEAS, *n* = 18 for SHBG and T

- MAZE: *n* = 21 DHEAS, *n* = 22 for SHBG and T

- DSP: *n* = 25 DHEAS, *n* = 26 for SHBG and T

```{r}
##### WOMEN
#LOOP
test <- data_repo %>% 
  filter(loop_useable == "Yes") %>% 
  select(subject_id,
         estradiol_spatial_pg_ml,
         progesterone_spatial_ng_ml,
         fsh_spatial_miu_ml,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #all n=26

#MAZE
test <- data_repo %>% 
  filter(maze_useable == "Yes") %>% 
  select(subject_id,
         estradiol_spatial_pg_ml,
         progesterone_spatial_ng_ml,
         fsh_spatial_miu_ml,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #all n=61

#DSP
test <- data_repo %>% 
  filter(dsp_useable == "Yes") %>% 
  select(subject_id,
         estradiol_spatial_pg_ml,
         progesterone_spatial_ng_ml,
         fsh_spatial_miu_ml,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #all n=46


#####MEN
#LOOP
test <- data_men %>% 
  filter(loop_useable == "Yes") %>% 
  select(fsh_spatial_miu_ml,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #DHEAS n = 16, SHBG & T n = 18

#MAZE
test <- data_men %>% 
  filter(maze_useable == "Yes") %>% 
  select(subject_id,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #DHEAS n = 21, SHBG & T n = 22

#DSP
test <- data_men %>% 
  filter(dsp_useable == "Yes") %>% 
  select(subject_id,
         shbg_spatial_nmol_l,
         dheas_spatial_ug_dl,
         testosterone_spatial_ng_dl)
#Sum of rows = sample size for each hormone x T1 correlation
colSums(!is.na(test)) #DHEAS n = 25, SHBG & T n = 26
```



# Structural Distributions


```{r shapiro-tests, echo=FALSE, results='hide'}
#is DV significantly difference from normal?

shapiro.test(data$avg_t1_hipp) #no
shapiro.test(data_repo$avg_t1_hipp) #no
shapiro.test(data_men$avg_t1_hipp) #no
```

Shapiro-Wilks test reveals that the average T1 hipp volume for all groups (overall, women, men) were normally distributed.

```{r include=TRUE, echo=FALSE}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_t1_hipp,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Grey Matter Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = avg_t1_hipp,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Grey Matter Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = avg_t1_hipp)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Grey Matter Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```
 Box plot shows the women appear to have greater T1 hippocampal GMV than men.


```{r include=TRUE, echo=FALSE}
data_repo %>% 
  group_by(repo_status) %>% 
  dplyr::summarize(count = n(),
            mean_total_hipp = mean(avg_t1_hipp, na.rm=TRUE),
            std_total_hipp = sd(avg_t1_hipp, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Total Hipp Volume",
                      "SD Total Hipp Volume"),
        caption = "Sample size and means for subjects by sex with T1 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3)),
        table.attr = "style='width:70%;'") %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)

data %>% 
  group_by(sex) %>% 
  dplyr::summarize(count = n(),
            mean_total_hipp = mean(avg_t1_hipp, na.rm=TRUE),
            std_total_hipp = sd(avg_t1_hipp, na.rm=TRUE)) %>% 
  kable(col.names = c("Sex", "n", "Mean Total Hipp Volume",
                      "SD Total Hipp Volume"),
        caption = "Sample size and means for subjects by sex with T1 hipp volume and completed spatial navigation behavior",
        digits = 2,
        align = c("l", rep("c", times = 3)),
        table.attr = "style='width:70%;'") %>% 
  kable_styling("striped", full_width = FALSE,
                position = "center", 
                font_size = 12)
```


```{r}
#ANOVA of GMV by repo stage
aov <- aov(avg_t1_hipp ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing T1 hipp GMV by reproductive status was not significant.

```{r}
#T-test of GMV by sex
ttest <- t.test(avg_t1_hipp ~ sex, data = data)
ttest
```


T-test results comparing GMV by sex was significant. Women (*M* = `r round(tidy_ttest$estimate1, digits = 3)`) have larger T1 hippocampal volume than men (*M* = `r round(tidy_ttest$estimate2, digits = 3)`) (*t* = `r round(tidy_ttest$statistic, digits = 3)`, *df* = `r round(tidy_ttest$parameter, digits = 3)`, *p* = `r round(tidy_ttest$p.value, digits = 3)`).


# T1 and Hormone {.tabset}


```{r echo=FALSE, results = 'hide'}
#Estradiol
shapiro.test(data_repo$estradiol_spatial_pg_ml) #yes
#Progesterone
shapiro.test(data_repo$progesterone_spatial_ng_ml) #yes
#FSH
shapiro.test(data_repo$fsh_spatial_miu_ml) #yes
#DHEAS
shapiro.test(data_repo$dheas_spatial_ug_dl) #yes
#SHBG
shapiro.test(data_repo$shbg_spatial_nmol_l) #yes
#Testosterone
shapiro.test(data_repo$testosterone_spatial_ng_dl) #yes

#Testosterone
shapiro.test(data_men$dheas_spatial_ug_dl) #no
shapiro.test(data_men$shbg_spatial_nmol_l) #yes
shapiro.test(data_men$testosterone_spatial_ng_dl) #no
```

We know that estradiol, progesterone, and FSH distributions are skewed, so we can either apply log transformations or move forward with Spearman rank correlations. Despite log transformations, hormones were still significant (different than normal), so correlations will be Spearman rank correlations with raw hormone values for women.

For men, DHEAS was not normal so Spearman rank correlation will be applied for these associations with T1 hipp GMV.

```{r}
#Convert to log for data_repo
# data_repo <- data_repo %>% 
#   mutate_at(vars(estradiol_spatial_pg_ml:testosterone_spatial_ng_dl), log)
```


## Hormone Correlation by Reproductive Status

```{r include=TRUE, echo=FALSE}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_spatial_pg_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_spatial_ng_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_spatial_miu_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_spatial_nmol_l", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_spatial_ug_dl", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_spatial_ng_dl", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```

All correlations are Spearman rank. DHEAS was negatively correlated with T1 hippocampal GMV for posts (*p* < 0.01).

## Hormone Correlation by Men

```{r include=TRUE, echo=FALSE}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_spatial_nmol_l", y = "avg_t1_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Grey Matter Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_spatial_ug_dl", y = "avg_t1_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Grey Matter Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_spatial_ng_dl", y = "avg_t1_hipp", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Grey Matter Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson except for SHBG (Spearman).

# {-}

# T1 and Behavior {.tabset}

```{r generate-subsets}
#Check to see if T1 GMV has any relationship with SNAG data

#Further filter for SNAG
#Separate for SNAG
data_loop <- data %>%
  filter(loop_useable == "Yes")
data_maze <- data %>%
  filter(maze_useable == "Yes")
data_dsp <- data %>%
  filter(dsp_useable == "Yes")


#Separate for women and men
data_loop_women <- data_repo %>% 
  filter(loop_useable == "Yes") 
data_maze_women <- data_repo %>% 
  filter(maze_useable == "Yes") 
data_dsp_women <- data_repo %>% 
  filter(dsp_useable == "Yes") 

data_loop_men <- data_men %>% 
  filter(loop_useable == "Yes")
data_maze_men <- data_men %>% 
  filter(maze_useable == "Yes")
data_dsp_men <- data_men %>% 
  filter(dsp_useable == "Yes")
```


```{r overall-distributions-qqplots}
## Overall

#LOOP: normally distributed, no need to transform
h1 <- ggplot(data = data_loop, aes(x = loop_pe_avg_m)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Position Error (m)",
       y = "Count",
       title = "LOOP: Histogram \nPosition Error")
h2 <- ggplot(data = data_loop, aes(x = loop_de_avg_degree)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Degrees Traveled",
       y = "Count",
       title = "LOOP: Histogram \nDegrees Traveled")
h1a <- ggqqplot(data = data_loop$loop_pe_avg_m) +
  labs(title = "LOOP: QQ-plot \nPosition Error")
h2a <- ggqqplot(data = data_loop$loop_de_avg_degree) +
  labs(title = "LOOP: QQ-plot \nDegrees Traveled")


#MAZE:right and left skewed, log transform
h3 <- ggplot(data = data_maze, aes(x = maze_accuracy_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nAccuracy")
h3a <- ggplot(data = data_maze, aes(x = log(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nLog Accuracy")
h3b <- ggplot(data = data_maze, aes(x = sqrt(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Accuracy")
h3q <- ggqqplot(data = data_maze$maze_accuracy_pct) +
  labs(title = "MAZE: QQ-plot \nAccuracy")
h3aq <- ggqqplot(data = log(data_maze$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nLog Accuracy")
h3bq <- ggqqplot(data = sqrt(data_maze$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nSqrt Accuracy")

h4 <- ggplot(data = data_maze, aes(x = maze_moves)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nMoves")
h4a <- ggplot(data = data_maze, aes(x = log(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nLog Moves")
h4b <- ggplot(data = data_maze, aes(x = sqrt(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Moves")
h4q <- ggqqplot(data = data_maze$maze_moves) +
  labs(title = "MAZE: QQ-plot \nMoves")
h4aq <- ggqqplot(data = log(data_maze$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nLog Moves")
h4bq <- ggqqplot(data = sqrt(data_maze$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nSqrt Moves")



#DSP: slight left and right skew so apply transformation
h5 <- ggplot(data = data_dsp, aes(x = dsp_success_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSuccess")
h5a <- ggplot(data = data_dsp, aes(x = log(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Success")
h5b <- ggplot(data = data_dsp, aes(x = sqrt(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Success")
h5q <- ggqqplot(data = data_dsp$dsp_success_pct) +
  labs(title = "DSP: QQ-plot \nSuccess")
h5aq <- ggqqplot(data = log(data_dsp$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nLog Success")
h5bq <- ggqqplot(data = sqrt(data_dsp$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Success")


h6 <- ggplot(data = data_dsp, aes(x = dsp_si_true_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSolution Index")
h6a <- ggplot(data = data_dsp, aes(x = log(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Solution Index")
h6b <- ggplot(data = data_dsp, aes(x = sqrt(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Solution Index")
h6q <- ggqqplot(data = data_dsp$dsp_si_true_pct) +
  labs(title = "DSP: QQ-plot \nSolution Index")
h6aq <- ggqqplot(data = log(data_dsp$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nLog Solution Index")
h6bq <- ggqqplot(data = sqrt(data_dsp$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Solution Index")

#Present

#LOOP
(h1+h2)/(h1a+h2a)
#MAZE
(h3+h3a+h3b)/(h3q+h3aq+h3bq)
(h4+h4a+h4b)/(h4q+h4aq+h4bq)
#DSP
(h5+h5a+h5b)/(h5q+h5aq+h5bq)
(h6+h6a+h6b)/(h6q+h6aq+h6bq)

# LOOP dependent variables appear normally distributed, but MAZE and DSP variables have slight skews. I applied log and square root transformations to these variables in MAZE and DSP to see whether the observed distribution looks normal.
# 
# We can check Shapiro-Wilk's to see if normality is violated for raw values and after transformation using log and square root.
```


```{r shapiro-check, results='hide'}
## is the DV significantly different than normal?

#LOOP
shapiro.test(data_loop$loop_pe_rad3_m) #no
shapiro.test(data_loop$loop_de_rad3_degree) #yes
shapiro.test(data_loop$loop_de_avg_degree) #no
shapiro.test(data_loop$loop_ae_rad3_degree) #no
shapiro.test(data_loop$loop_ae_avg_degree) #yes


#MAZE
shapiro.test(data_maze$maze_accuracy_pct) #yes
shapiro.test(data_maze$maze_moves) #yes
shapiro.test(data_maze$maze_path_efficiency) #yes

#DSP
shapiro.test(data_dsp$dsp_success_pct) #no
shapiro.test(data_dsp$dsp_si_true_pct) #yes
shapiro.test(data_dsp$dsp_path_efficiency_grid_weighted) #no

```

**Overall:**

Shapiro-Wilk's test reveal that LOOP position error at 3.0m, degrees traveled averaged, angular error at 3.0m; and DSP wayfinding success are normally distributed, but MAZE dependent variables and DSP solution index and DSP path efficiency are not. Thus, all correlations with GMV for these DV will be spearman rank correlations.


```{r log-transformation}
# data_maze_log <- data_maze %>% 
#   mutate_at(vars(maze_accuracy_pct,maze_moves), log)
# 
# data_dsp_log <- data_dsp %>% 
#   mutate_at(vars(dsp_si_true_pct), log)
```




```{r women-distributions-qqplots}
#LOOP: normally distributed, no need to transform
h1 <- ggplot(data = data_loop_women, aes(x = loop_pe_avg_m)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Position Error (m)",
       y = "Count",
       title = "LOOP: Histogram \nPosition Error")
h2 <- ggplot(data = data_loop_women, aes(x = loop_de_avg_degree)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Degrees Traveled",
       y = "Count",
       title = "LOOP: Histogram \nDegrees Traveled")
h1a <- ggqqplot(data = data_loop_women$loop_pe_avg_m) +
  labs(title = "LOOP: QQ-plot \nPosition Error")
h2a <- ggqqplot(data = data_loop_women$loop_de_avg_degree) +
  labs(title = "LOOP: QQ-plot \nDegrees Traveled")


#MAZE:right and left skewed, log transform
h3 <- ggplot(data = data_maze_women, aes(x = maze_accuracy_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nAccuracy")
h3a <- ggplot(data = data_maze_women, aes(x = log(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nLog Accuracy")
h3b <- ggplot(data = data_maze_women, aes(x = sqrt(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Accuracy")
h3q <- ggqqplot(data = data_maze_women$maze_accuracy_pct) +
  labs(title = "MAZE: QQ-plot \nAccuracy")
h3aq <- ggqqplot(data = log(data_maze_women$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nLog Accuracy")
h3bq <- ggqqplot(data = sqrt(data_maze_women$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nSqrt Accuracy")

h4 <- ggplot(data = data_maze_women, aes(x = maze_moves)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nMoves")
h4a <- ggplot(data = data_maze_women, aes(x = log(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nLog Moves")
h4b <- ggplot(data = data_maze_women, aes(x = sqrt(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Moves")
h4q <- ggqqplot(data = data_maze_women$maze_moves) +
  labs(title = "MAZE: QQ-plot \nMoves")
h4aq <- ggqqplot(data = log(data_maze_women$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nLog Moves")
h4bq <- ggqqplot(data = sqrt(data_maze_women$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nSqrt Moves")



#DSP: slight left and right skew so apply transformation
h5 <- ggplot(data = data_dsp_women, aes(x = dsp_success_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSuccess")
h5a <- ggplot(data = data_dsp_women, aes(x = log(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Success")
h5b <- ggplot(data = data_dsp_women, aes(x = sqrt(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Success")
h5q <- ggqqplot(data = data_dsp_women$dsp_success_pct) +
  labs(title = "DSP: QQ-plot \nSuccess")
h5aq <- ggqqplot(data = log(data_dsp_women$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nLog Success")
h5bq <- ggqqplot(data = sqrt(data_dsp_women$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Success")


h6 <- ggplot(data = data_dsp_women, aes(x = dsp_si_true_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSolution Index")
h6a <- ggplot(data = data_dsp_women, aes(x = log(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Solution Index")
h6b <- ggplot(data = data_dsp_women, aes(x = sqrt(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Solution Index")
h6q <- ggqqplot(data = data_dsp_women$dsp_si_true_pct) +
  labs(title = "DSP: QQ-plot \nSolution Index")
h6aq <- ggqqplot(data = log(data_dsp_women$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nLog Solution Index")
h6bq <- ggqqplot(data = sqrt(data_dsp_women$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Solution Index")

#Present

#LOOP
(h1+h2)/(h1a+h2a)
#MAZE
(h3+h3a+h3b)/(h3q+h3aq+h3bq)
(h4+h4a+h4b)/(h4q+h4aq+h4bq)
#DSP
(h5+h5a+h5b)/(h5q+h5aq+h5bq)
(h6+h6a+h6b)/(h6q+h6aq+h6bq)


# Like the overall distributions, LOOP DVs look normal but MAZE and DSP variables appear skewed.
# 
# We can check Shapiro-Wilk's to see if normality is violated for raw values and after transformation using log and square root.
```




```{r women-shapiro-check, results='hide'}
## is the DV significantly diffrent than normal?

#LOOP
shapiro.test(data_loop_women$loop_pe_rad3_m) #no
shapiro.test(data_loop_women$loop_de_rad3_degree) #no
shapiro.test(data_loop_women$loop_de_avg_degree) #no
shapiro.test(data_loop_women$loop_ae_rad3_degree) #no
shapiro.test(data_loop_women$loop_ae_avg_degree) #yes

#MAZE
shapiro.test(data_maze_women$maze_accuracy_pct) #yes
shapiro.test(data_maze_women$maze_moves) #yes
shapiro.test(data_maze_women$maze_path_efficiency) #yes

#DSP
shapiro.test(data_dsp_women$dsp_success_pct) #no
shapiro.test(data_dsp_women$dsp_si_true_pct) #yes
shapiro.test(data_dsp_women$dsp_path_efficiency_grid_weighted) #yes

```
**Women:**

LOOP average angualr error, MAZE dependent variables, and DSP solution index and path efficiency were significantly different than normal. These dependent variables for women will be using Spearman rank correlation.



```{r men-distributions-qqplots}
#LOOP: normally distributed, no need to transform
h1 <- ggplot(data = data_loop_men, aes(x = loop_pe_avg_m)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Position Error (m)",
       y = "Count",
       title = "LOOP: Histogram \nPosition Error")
h2 <- ggplot(data = data_loop_men, aes(x = loop_de_avg_degree)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Degrees Traveled",
       y = "Count",
       title = "LOOP: Histogram \nDegrees Traveled")
h1a <- ggqqplot(data = data_loop_men$loop_pe_avg_m) +
  labs(title = "LOOP: QQ-plot \nPosition Error")
h2a <- ggqqplot(data = data_loop_men$loop_de_avg_degree) +
  labs(title = "LOOP: QQ-plot \nDegrees Traveled")


#MAZE:right and left skewed, log transform
h3 <- ggplot(data = data_maze_men, aes(x = maze_accuracy_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nAccuracy")
h3a <- ggplot(data = data_maze_men, aes(x = log(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nLog Accuracy")
h3b <- ggplot(data = data_maze_men, aes(x = sqrt(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Accuracy")
h3q <- ggqqplot(data = data_maze_men$maze_accuracy_pct) +
  labs(title = "MAZE: QQ-plot \nAccuracy")
h3aq <- ggqqplot(data = log(data_maze_men$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nLog Accuracy")
h3bq <- ggqqplot(data = sqrt(data_maze_men$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nSqrt Accuracy")

h4 <- ggplot(data = data_maze_men, aes(x = maze_moves)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nMoves")
h4a <- ggplot(data = data_maze_men, aes(x = log(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nLog Moves")
h4b <- ggplot(data = data_maze_men, aes(x = sqrt(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Moves")
h4q <- ggqqplot(data = data_maze_men$maze_moves) +
  labs(title = "MAZE: QQ-plot \nMoves")
h4aq <- ggqqplot(data = log(data_maze_men$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nLog Moves")
h4bq <- ggqqplot(data = sqrt(data_maze_men$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nSqrt Moves")



#DSP: slight left and right skew so apply transformation
h5 <- ggplot(data = data_dsp_men, aes(x = dsp_success_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSuccess")
h5a <- ggplot(data = data_dsp_men, aes(x = log(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Success")
h5b <- ggplot(data = data_dsp_men, aes(x = sqrt(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Success")
h5q <- ggqqplot(data = data_dsp_men$dsp_success_pct) +
  labs(title = "DSP: QQ-plot \nSuccess")
h5aq <- ggqqplot(data = log(data_dsp_men$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nLog Success")
h5bq <- ggqqplot(data = sqrt(data_dsp_men$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Success")


h6 <- ggplot(data = data_dsp_men, aes(x = dsp_si_true_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSolution Index")
h6a <- ggplot(data = data_dsp_men, aes(x = log(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Solution Index")
h6b <- ggplot(data = data_dsp_men, aes(x = sqrt(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Solution Index")
h6q <- ggqqplot(data = data_dsp_men$dsp_si_true_pct) +
  labs(title = "DSP: QQ-plot \nSolution Index")
h6aq <- ggqqplot(data = log(data_dsp_men$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nLog Solution Index")
h6bq <- ggqqplot(data = sqrt(data_dsp_men$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Solution Index")

#Present

#LOOP
(h1+h2)/(h1a+h2a)
#MAZE
(h3+h3a+h3b)/(h3q+h3aq+h3bq)
(h4+h4a+h4b)/(h4q+h4aq+h4bq)
#DSP
(h5+h5a+h5b)/(h5q+h5aq+h5bq)
(h6+h6a+h6b)/(h6q+h6aq+h6bq)
```

Like the overall distributions, LOOP DVs look normal but MAZE and DSP variables appear skewed.


```{r men-shapiro-check, results='hide'}
## is the DV significantly diffrent than normal?

#LOOP
shapiro.test(data_loop_men$loop_pe_rad3_m) #no
shapiro.test(data_loop_men$loop_de_rad3_degree) #yes
shapiro.test(data_loop_men$loop_de_avg_degree) #no
shapiro.test(data_loop_men$loop_ae_rad3_degree) #no
shapiro.test(data_loop_men$loop_ae_avg_degree) #no

#MAZE
shapiro.test(data_maze_men$maze_accuracy_pct) #yes
shapiro.test(data_maze_men$maze_moves) #no
shapiro.test(data_maze_men$maze_path_efficiency) #no


#DSP
shapiro.test(data_dsp_men$dsp_success_pct) #no
shapiro.test(data_dsp_men$dsp_si_true_pct) #yes
shapiro.test(data_dsp_men$dsp_path_efficiency_grid_weighted) #no
```


**Men:**

LOOP degrees traveled at 3.0m, MAZE accuracy, and DSP solution index were significantly different from normal. Spearman rank correlations will be applied for associations with GMV for men here.

## LOOP {.tabset}

### Position Error - 3.0m

```{r include=TRUE, echo=FALSE}
#All
c1 <- ggscatter(data_loop, x = "avg_t1_hipp", y = "loop_pe_rad3_m", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0 (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 


#By sex
c1a <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_pe_rad3_m", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_loop_men, x = "avg_t1_hipp", y = "loop_pe_rad3_m", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_pe_rad3_m", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0m") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")


#Present
c1
(c1a+c1b)/c1c
```

All are Pearson correlations. 

#### LEFT

```{r include=TRUE, echo=FALSE}
#All
c1 <- ggscatter(data_loop, x = "left_t1_hipp", y = "loop_pe_rad3_m", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0 (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 


#By sex
c1a <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_pe_rad3_m", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_loop_men, x = "left_t1_hipp", y = "loop_pe_rad3_m", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_pe_rad3_m", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0m") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")


#Present
c1
(c1a+c1b)/c1c
```


All are Pearson correlations.

#### RIGHT

```{r include=TRUE, echo=FALSE}
#All
c1 <- ggscatter(data_loop, x = "right_t1_hipp", y = "loop_pe_rad3_m", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0 (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 


#By sex
c1a <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_pe_rad3_m", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_loop_men, x = "right_t1_hipp", y = "loop_pe_rad3_m", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_pe_rad3_m", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at 3.0m") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")


#Present
c1
(c1a+c1b)/c1c
```

All are Pearson correlations.


### Degrees Traveled - 3.0m

```{r loop-de-3, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "avg_t1_hipp", y = "loop_de_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m", ) +
    theme(legend.position = "top", legend.title=element_blank()) +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#sex
c1a <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_de_rad3_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)
c1b <- ggscatter(data_loop_men, x = "avg_t1_hipp", y = "loop_de_rad3_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#By repo
c1c <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_de_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#Present
c1
(c1a+c1b)/c1c
```

All correlations were Spearman except for women (Pearson). Women with higher GMV marginally correlated with fewer degrees traveled at 3.0m (*p* = 0.07, Pearson). Pres who had higher GMV correlated with lower degrees traveled at 3.0m (*p* < 0.05, Pearson). 

#### LEFT


```{r loop-de-3-l, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "left_t1_hipp", y = "loop_de_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m", ) +
    theme(legend.position = "top", legend.title=element_blank()) +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#sex
c1a <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_de_rad3_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)
c1b <- ggscatter(data_loop_men, x = "left_t1_hipp", y = "loop_de_rad3_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#By repo
c1c <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_de_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#Present
c1
(c1a+c1b)/c1c
```


All correlations were Spearman except for women (Pearson).

#### RIGHT


```{r loop-de-3-r, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "right_t1_hipp", y = "loop_de_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m", ) +
    theme(legend.position = "top", legend.title=element_blank()) +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#sex
c1a <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_de_rad3_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)
c1b <- ggscatter(data_loop_men, x = "right_t1_hipp", y = "loop_de_rad3_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#By repo
c1c <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_de_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at 3.0m") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#Present
c1
(c1a+c1b)/c1c
```


All correlations were Spearman except for women (Pearson).

### Degrees Traveled - Averaged

```{r loop-de-avg, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "avg_t1_hipp", y = "loop_de_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#sex
c1a <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_de_avg_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)
c1b <- ggscatter(data_loop_men, x = "avg_t1_hipp", y = "loop_de_avg_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#By repo
c1c <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_de_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#Present
c1
(c1a+c1b)/c1c
```

All correlations are Pearson. Women with higher GMV correlated with fewer degrees traveled (*p* < 0.05, Pearson). Pres who had higher GMV correlated with lower degrees traveled (*p* < 0.01, Pearson). 

#### LEFT

```{r loop-de-avg-l, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "left_t1_hipp", y = "loop_de_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#sex
c1a <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_de_avg_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)
c1b <- ggscatter(data_loop_men, x = "left_t1_hipp", y = "loop_de_avg_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#By repo
c1c <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_de_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#Present
c1
(c1a+c1b)/c1c
```


All correlations are Pearson.

#### RIGHT

```{r loop-de-avg-r, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "right_t1_hipp", y = "loop_de_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#sex
c1a <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_de_avg_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)
c1b <- ggscatter(data_loop_men, x = "right_t1_hipp", y = "loop_de_avg_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#By repo
c1c <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_de_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") +
  geom_hline(yintercept=360, linetype="dashed", color = "green", size=1)

#Present
c1
(c1a+c1b)/c1c
```


All correlations are Pearson.


### Angular Error - 3.0m

```{r loop-ae-3, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "avg_t1_hipp", y = "loop_ae_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_ae_rad3_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none") 
c1b <- ggscatter(data_loop_men, x = "avg_t1_hipp", y = "loop_ae_rad3_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_ae_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") 

#Present
c1
(c1a+c1b)/c1c
```

All correlations were Pearson.

#### LEFT


```{r loop-ae-3-l, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "left_t1_hipp", y = "loop_ae_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_ae_rad3_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none") 
c1b <- ggscatter(data_loop_men, x = "left_t1_hipp", y = "loop_ae_rad3_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_ae_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") 

#Present
c1
(c1a+c1b)/c1c
```


All correlations were Pearson.

#### RIGHT


```{r loop-ae-3-r, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "right_t1_hipp", y = "loop_ae_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_ae_rad3_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none") 
c1b <- ggscatter(data_loop_men, x = "right_t1_hipp", y = "loop_ae_rad3_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_ae_rad3_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at 3.0m") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") 

#Present
c1
(c1a+c1b)/c1c
```



All correlations were Pearson.

### Angular Error - Averaged

```{r loop-ae-avg, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "avg_t1_hipp", y = "loop_ae_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_ae_avg_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
     theme_bw() +
     theme(legend.position = "none") 
c1b <- ggscatter(data_loop_men, x = "avg_t1_hipp", y = "loop_ae_avg_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_loop_women, x = "avg_t1_hipp", y = "loop_ae_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") 

#Present
c1
(c1a+c1b)/c1c
```


All correlations were Spearman except for men (Pearson)

#### LEFT


```{r loop-ae-avg-l, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "left_t1_hipp", y = "loop_ae_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_ae_avg_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
     theme_bw() +
     theme(legend.position = "none") 
c1b <- ggscatter(data_loop_men, x = "left_t1_hipp", y = "loop_ae_avg_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_loop_women, x = "left_t1_hipp", y = "loop_ae_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") 

#Present
c1
(c1a+c1b)/c1c
```


All correlations were Spearman except for men (Pearson)

#### RIGHT


```{r loop-ae-avg-r, include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_loop, x = "right_t1_hipp", y = "loop_ae_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_ae_avg_degree", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
     theme_bw() +
     theme(legend.position = "none") 
c1b <- ggscatter(data_loop_men, x = "right_t1_hipp", y = "loop_ae_avg_degree", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_loop_women, x = "right_t1_hipp", y = "loop_ae_avg_degree", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nAngular Error") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none") 

#Present
c1
(c1a+c1b)/c1c
```

All correlations were Spearman except for men (Pearson)

## {-}

## MAZE {.tabset}

### Accuracy

```{r include=TRUE, echo=FALSE}
#All
c1 <- ggscatter(data_maze, x = "avg_t1_hipp", y = "maze_accuracy_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#By sex
c1a <- ggscatter(data_maze_women, x = "avg_t1_hipp", y = "maze_accuracy_pct", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_maze_men, x = "avg_t1_hipp", y = "maze_accuracy_pct", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_maze_women, x = "avg_t1_hipp", y = "maze_accuracy_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations are Spearman.

#### LEFT

```{r include=TRUE, echo=FALSE}
#All
c1 <- ggscatter(data_maze, x = "left_t1_hipp", y = "maze_accuracy_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#By sex
c1a <- ggscatter(data_maze_women, x = "left_t1_hipp", y = "maze_accuracy_pct", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_maze_men, x = "left_t1_hipp", y = "maze_accuracy_pct", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_maze_women, x = "left_t1_hipp", y = "maze_accuracy_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations are Spearman.


#### RIGHT

```{r include=TRUE, echo=FALSE}
#All
c1 <- ggscatter(data_maze, x = "right_t1_hipp", y = "maze_accuracy_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#By sex
c1a <- ggscatter(data_maze_women, x = "right_t1_hipp", y = "maze_accuracy_pct", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_maze_men, x = "right_t1_hipp", y = "maze_accuracy_pct", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")

#By repo
c1c <- ggscatter(data_maze_women, x = "right_t1_hipp", y = "maze_accuracy_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations are Spearman.

### Moves

```{r include=TRUE, echo=FALSE}
#overall
c1 <- ggscatter(data_maze, x = "avg_t1_hipp", y = "maze_moves", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_maze_women, x = "avg_t1_hipp", y = "maze_moves", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_maze_men, x = "avg_t1_hipp", y = "maze_moves", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
     theme_bw() +
     theme(legend.position = "none")

#by repo
c1c <- ggscatter(data_maze_women, x = "avg_t1_hipp", y = "maze_moves", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All Spearman correlations except for men (Pearson)

#### LEFT


```{r include=TRUE, echo=FALSE}
#overall
c1 <- ggscatter(data_maze, x = "left_t1_hipp", y = "maze_moves", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_maze_women, x = "left_t1_hipp", y = "maze_moves", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_maze_men, x = "left_t1_hipp", y = "maze_moves", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
     theme_bw() +
     theme(legend.position = "none")

#by repo
c1c <- ggscatter(data_maze_women, x = "left_t1_hipp", y = "maze_moves", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All Spearman correlations except for men (Pearson)

#### RIGHT


```{r include=TRUE, echo=FALSE}
#overall
c1 <- ggscatter(data_maze, x = "right_t1_hipp", y = "maze_moves", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_maze_women, x = "right_t1_hipp", y = "maze_moves", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_maze_men, x = "right_t1_hipp", y = "maze_moves", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
     theme_bw() +
     theme(legend.position = "none")

#by repo
c1c <- ggscatter(data_maze_women, x = "right_t1_hipp", y = "maze_moves", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All Spearman correlations except for men (Pearson)


### Path Efficiency

```{r include=TRUE, echo=FALSE}
#overall
c1 <- ggscatter(data_maze, x = "avg_t1_hipp", y = "maze_path_efficiency", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_maze_women, x = "avg_t1_hipp", y = "maze_path_efficiency", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_maze_men, x = "avg_t1_hipp", y = "maze_path_efficiency", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")

#by repo
c1c <- ggscatter(data_maze_women, x = "avg_t1_hipp", y = "maze_path_efficiency", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All Spearman correlations except for men (Pearson). Higher average GMV volume was negatively correlated with path efficiency for peri-menopausal women (*p* < 0.05, Spearman)

#### LEFT

```{r include=TRUE, echo=FALSE}
#overall
c1 <- ggscatter(data_maze, x = "left_t1_hipp", y = "maze_path_efficiency", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_maze_women, x = "left_t1_hipp", y = "maze_path_efficiency", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_maze_men, x = "left_t1_hipp", y = "maze_path_efficiency", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")

#by repo
c1c <- ggscatter(data_maze_women, x = "left_t1_hipp", y = "maze_path_efficiency", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All Spearman correlations except for men (Pearson).


#### RIGHT

```{r include=TRUE, echo=FALSE}
#overall
c1 <- ggscatter(data_maze, x = "right_t1_hipp", y = "maze_path_efficiency", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_maze_women, x = "right_t1_hipp", y = "maze_path_efficiency", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_maze_men, x = "right_t1_hipp", y = "maze_path_efficiency", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")

#by repo
c1c <- ggscatter(data_maze_women, x = "right_t1_hipp", y = "maze_path_efficiency", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All Spearman correlations except for men (Pearson).

## {-}

## DSP {.tabset}

### Wayfinding Success

```{r include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_dsp, x = "avg_t1_hipp", y = "dsp_success_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp_women, x = "avg_t1_hipp", y = "dsp_success_pct", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_dsp_men, x = "avg_t1_hipp", y = "dsp_success_pct", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")

#repo
c1c <- ggscatter(data_dsp_women, x = "avg_t1_hipp", y = "dsp_success_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations were Pearson except for women groups (Spearman). Overall, larger T1 hipp GMV was associated with lower wayfinding success in DSP (*p* < 0.05, Pearson). This pattern was also observed marginally in men (*p* = 0.055, Pearson), but not in women (*p* = 0.84, Spearman).

#### LEFT

```{r include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_dsp, x = "left_t1_hipp", y = "dsp_success_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp_women, x = "left_t1_hipp", y = "dsp_success_pct", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_dsp_men, x = "left_t1_hipp", y = "dsp_success_pct", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")

#repo
c1c <- ggscatter(data_dsp_women, x = "left_t1_hipp", y = "dsp_success_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations were Pearson except for women groups (Spearman).

#### RIGHT

```{r include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_dsp, x = "right_t1_hipp", y = "dsp_success_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp_women, x = "right_t1_hipp", y = "dsp_success_pct", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_dsp_men, x = "right_t1_hipp", y = "dsp_success_pct", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
     theme_bw() +
     theme(legend.position = "none")

#repo
c1c <- ggscatter(data_dsp_women, x = "right_t1_hipp", y = "dsp_success_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations were Pearson except for women groups (Spearman).

### Solution Index

```{r include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_dsp, x = "avg_t1_hipp", y = "dsp_si_true_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp_women, x = "avg_t1_hipp", y = "dsp_si_true_pct", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_dsp_men, x = "avg_t1_hipp", y = "dsp_si_true_pct", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
     theme_bw() +
     theme(legend.position = "none")

#repo
c1c <- ggscatter(data_dsp_women, x = "avg_t1_hipp", y = "dsp_si_true_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations are Spearman except for women groups (Spearman). T1 volume is positively marginally associated with DSP solution index in pres (*p* = 0.051, Pearson).

#### LEFT

```{r include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_dsp, x = "left_t1_hipp", y = "dsp_si_true_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp_women, x = "left_t1_hipp", y = "dsp_si_true_pct", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_dsp_men, x = "left_t1_hipp", y = "dsp_si_true_pct", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
     theme_bw() +
     theme(legend.position = "none")

#repo
c1c <- ggscatter(data_dsp_women, x = "left_t1_hipp", y = "dsp_si_true_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations are Spearman except for women groups (Spearman).

#### RIGHT

```{r include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_dsp, x = "right_t1_hipp", y = "dsp_si_true_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp_women, x = "right_t1_hipp", y = "dsp_si_true_pct", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_dsp_men, x = "right_t1_hipp", y = "dsp_si_true_pct", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
     theme_bw() +
     theme(legend.position = "none")

#repo
c1c <- ggscatter(data_dsp_women, x = "right_t1_hipp", y = "dsp_si_true_pct", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations are Spearman except for women groups (Spearman).

### Path Efficiency

```{r include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_dsp, x = "avg_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp_women, x = "avg_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_dsp_men, x = "avg_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")

#repo
c1c <- ggscatter(data_dsp_women, x = "avg_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations were Pearson except for women (Spearman)

#### LEFT

```{r include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_dsp, x = "left_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp_women, x = "left_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_dsp_men, x = "left_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")

#repo
c1c <- ggscatter(data_dsp_women, x = "left_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations were Pearson except for women (Spearman)

#### RIGHT

```{r include=TRUE, echo=FALSE}
#all
c1 <- ggscatter(data_dsp, x = "right_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp_women, x = "right_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "red", alpha = 0.6, title = "Women",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")
c1b <- ggscatter(data_dsp_men, x = "right_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "#00AFBB", alpha = 0.6, title = "Men",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
     theme_bw() +
     theme(legend.position = "none")

#repo
c1c <- ggscatter(data_dsp_women, x = "right_t1_hipp", y = "dsp_path_efficiency_grid_weighted", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Path Efficiency") +
    facet_wrap(. ~ repo_status, scale = "free", ncol = 3) +
     theme_bw() +
     theme(legend.position = "none")

#Present
c1
(c1a+c1b)/c1c
```

All correlations were Pearson except for women (Spearman)

## {-}

# {-}


# P-value corrections

## T1

```{r}
#T1 and E, FSH, T
p = c(0.77, 0.82, 0.29)
p.adjust(p, 
         method = "BH")
```

```{r}
#T1 and DSP success overall, women, men
p = c(0.016, 0.84, 0.055)
p.adjust(p, 
         method = "BH")
```

# T2 HC

```{r}
#T2 and DSP solution index overall, women, men
p = c(0.35, 0.71, 0.052)
p.adjust(p, 
         method = "BH")
```

```{r}
#T2 and LOOP degrees overall, women, men
p = c(0.0017, 0.034, 0.097)
p.adjust(p, 
         method = "BH")
```

## Subfield



## Hormones

```{r}
#E for CA1, ...SUB
p = c(0.62, 0.32, 0.39, 0.94, 0.12, 0.37, 0.35)
p.adjust(p, 
         method = "BH")
```

```{r}
#FSH for CA1, ...SUB
p = c(0.61, 0.91, 0.59, 0.79, 0.72, 0.44, 0.29)
p.adjust(p, 
         method = "BH")
```
```{r}
#T for CA1, ...SUB
p = c(0.066, 0.64, 0.63, 0.96, 0.95, 0.57, 0.4)
p.adjust(p, 
         method = "BH")
```

## DSP

```{r}
#wayfinding overall
p = c(0.98, 0.98, 0.66, 0.045, 0.57, 0.32, 0.45)
p.adjust(p, 
         method = "BH")
```

```{r}
#SI overall
p = c(0.75, 0.41, 0.073, 0.69, 0.68, 0.71, 0.43)
p.adjust(p, 
         method = "BH")
```

```{r}
#MAZE
p = c(0.74, 0.81, 0.59, 0.43, 0.54, 0.35, 0.33)
p.adjust(p, 
         method = "BH")
```

```{r}
#LOO degrees traveled
p = c(0.00032, 0.0023, 0.012, 0.61, 0.75, 0.81, 0.0066)
p.adjust(p, 
         method = "BH")
```


```{r}
#LOOP position error
p = c(0.67, 0.61, 0.71, 0.43, 0.075, 0.82, 0.62)
p.adjust(p, 
         method = "BH")
```


# Summary

Sample included HAS participants who had a T1 scan and completed spatial navigation behavior

## Hormones

- Based on structural comparisons and after correcting for TIV, women have larger T1 hippocampal volume than men (*p* < 0.001). Correlations between brain structure and hormones among women were carried out using Spearman rank. All correlations with men were Pearson except for SHBG. 

- No significant correlations between hormone concentrations and T1 hippocampal volume were observed for men. DHEAS was negatively correlated with T1 hippocampal GMV for posts (*p* < 0.01, Spearman).

## Behavior

- For LOOP, women with higher GMV marginally correlated with fewer degrees traveled at 3.0m (*p* = 0.07, Pearson). Pres who had higher GMV correlated with lower degrees traveled at 3.0m (*p* < 0.05, Pearson). Similarly, women with higher GMV correlated with lower averaged degrees traveled (*p* < 0.05, Pearson). Pres who had higher GMV also correlated with lower averaged degrees traveled (*p* < 0.01, Pearson). 

- For MAZE, higher average GMV volume was negatively correlated with path efficiency for peri-menopausal women (*p* < 0.05, Spearman).

- For DSP, overall (women and men) higher T1 hipp GMV was associated with lower wayfinding success in DSP (*p* < 0.05, Pearson). This pattern was also observed marginally in men (*p* = 0.055, Pearson), but not in women (*p* = 0.84, Spearman). Higher DSP solution index was marginally positively associated with pres who had higher GMV (*p* = 0.051, Pearson). 


