---
title: 'Study 2: T1 and correlations for hormones and SNAG'
author: "Shuying Yu"
date: "11/26/2022"
output: html_document
---

```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.align = "center")

#Add libraries
library(tidyverse)
library(here)
library(janitor)
library(ggpubr)
library(patchwork)
library(readxl)
library(knitr)
library(broom)
library(purrr)
```


# Overview


This report provides exploratory and preliminary correlation analyses between sex hormones and T1 hippocampal ROI data extracted from AAL for the Healthy Aging Study sample. Mask was selected for left and right hippocampus, using 2D dilation 1 on registered (not smoothed) segmented grey matter.

**Cleaning data steps included (T1 hipp):**

1) Filter participants that have T1 data from scan

2) Select sex hormone measures from when scan was conducted

3) Correct left and right volumes with TIV

4) Average left and right volumes to get an average measure


```{r data_wrangling}
#Read in the data
data <- read_csv(here("data", "HAS_SNAG_mastersheet_tidy.csv"))



#Select and filter variables
data <- data %>%
  filter(age_group == "Midlife",
         t1_status == "Yes") %>% 
  select(subject_id, sex, age_scan_years, repo_status_scan,
         completed_scan, completed_spatial,
         loop_useable:testosterone_spatial_ng_dl,
         t1_vbm_tiv:t1_vol_right_hipp_aal_3d_d1_s) %>% 

  #Further exclude this subject:
  filter(!subject_id %in% c(
    #"309", #bad participant
    #"316", #vertigo/took Wellbutrin for mood and Lipitor for cholesterol 7 days/week of scan
     "329", #on prednisone 7 days/week of scan
    #"352", #current MDD/depression
     "372" #past neuroschistosomiasis at 24 years old
  ))



#Correct with TIV and average
#Create function for apply to variables
dividebyTIV <- function(x, na.rm = FALSE) (x/data$t1_vbm_tiv)

#Apply function to variables
data <- data %>% 
  
  #Correct using TIV from SPM VBM
  mutate_at(vars(t1_vol_left_hipp_aal_2d_d1_r, 
                 t1_vol_right_hipp_aal_2d_d1_r),
            dividebyTIV) %>%
  
  #Average left and right regions
  #No need to multiply since values are the same proportion
  mutate(avg_t1_hipp = ((t1_vol_left_hipp_aal_2d_d1_r + 
                        t1_vol_right_hipp_aal_2d_d1_r)/2)*1000)


#Create subsets
#Subset for women by repo status
data_repo <- data %>% 
  filter(sex == "Female") %>% 
  mutate(repo_status = fct_relevel(repo_status_scan, 
                                    c("Pre", "Peri", "Post")))

#Subset for men
data_men <- data %>% 
  filter(sex == "Male")
```


# Structural Distributions


```{r shapiro-tests, echo=FALSE, results='hide'}
#is DV significantly difference from normal?

shapiro.test(data$avg_t1_hipp) #no
shapiro.test(data_repo$avg_t1_hipp) #no
shapiro.test(data_men$avg_t1_hipp) #no
```

Shapiro-Wilks test reveals that the average T1 hipp volume for all groups were normally distributed.

## Structural Comparison: all with T1

```{r}
#Reproductive status
p1 <- ggplot(data = data_repo, aes(y = avg_t1_hipp,
                                 x = repo_status,
                                 fill = repo_status,
                                 color = repo_status)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Reproductive Status",
       y = "Grey Matter Volume",
       title = "Reproductive Status") + 
  theme(legend.position = "none") 

#Sex
p2 <- ggplot(data = data, aes(y = avg_t1_hipp,
                                 x = sex,
                                 fill = sex,
                                 color = sex)) + 
  geom_boxplot(alpha = 0.5,show.legend = FALSE) +
  geom_jitter(width = 0.1, show.legend = FALSE) +
  stat_summary(fun.y=mean, geom="point",
               shape=20, size=3, color="black", fill="black") +
  labs(x = "Sex",
       y = "Grey Matter Volume",
       title = "Sex") + 
  theme(legend.position = "none") 


#Total
p3 <- ggplot(data = data, aes(x = avg_t1_hipp)) + 
  geom_histogram(alpha = 0.5, position = "identity",
                 show.legend = FALSE) +
  labs(x = "Grey Matter Volume",
       y = "Count",
       title = "Total") 


#Combine
(p1+p2)/p3
```
 Interestingly, women show greater T1 hippocampal GMV than men.


```{r}
data_repo %>% 
  group_by(repo_status) %>% 
  summarize(mean_gmv = round(mean(avg_t1_hipp), digits = 3),
            std_gmv = round(sd(avg_t1_hipp), digits = 3)) %>% kable()

data %>% 
  group_by(sex) %>% 
  summarize(mean_gmv = round(mean(avg_t1_hipp), digits = 3),
            std_gmv = round(sd(avg_t1_hipp), digits = 3)) %>% kable()
```


```{r}
#ANOVA of GMV by repo stage
aov <- aov(avg_t1_hipp ~ repo_status, data = data_repo)
summary_aov <- summary(aov)
kable(summary_aov[[1]])
```

ANOVA results comparing GMV by reproductive status was not significant.

```{r}
#T-test of GMV by sex
ttest <- t.test(avg_t1_hipp ~ sex, data = data)
ttest
```


T-test results comparing GMV by sex was significant. Women have larger T1 hippocampal volume than men (*p* < 0.001)



# Hormone 


```{r echo=FALSE, results = 'hide'}
#Estradiol
shapiro.test(data$estradiol_scan_pg_ml) #yes
shapiro.test(log(data$estradiol_scan_pg_ml)) #yes


#Progesterone
shapiro.test(data$progesterone_scan_ng_ml) #yes
shapiro.test(log(data$progesterone_scan_ng_ml)) #yes

#FSH
shapiro.test(data$fsh_scan_miu_ml) #yes
shapiro.test(log(data$fsh_scan_miu_ml)) #yes

#Testosterone
shapiro.test(data_men$testosterone_scan_ng_dl) #no
```

We know that estradiol, progesterone, and FSH distributions are skewed, so we can either apply log transformations or move forward with Spearman rank correlations.

To be consistent, for women, all hormones will first be log transformed. Despite log transformations, hormones were still significant (different than normal), so correlations will be Spearman rank correlations with log-transformed hormones for women.

```{r}
#Convert to log for data_repo
data_repo <- data_repo %>% 
  mutate_at(vars(estradiol_scan_pg_ml:testosterone_spatial_ng_dl), log)
```



## Hormone Correlation by Reproductive Status

```{r}
#Estradiol
c1 <- ggscatter(data_repo, x = "estradiol_scan_pg_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none") 


#Estradiol facet
c1a <- ggscatter(data_repo, x = "estradiol_scan_pg_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Estradiol (pg/mL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free")+
     theme_bw() +
     theme(legend.position = "none")


#Progesterone
c2 <- ggscatter(data_repo, x = "progesterone_scan_ng_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none") 

#Progesterone facet
c2a <- ggscatter(data_repo, x = "progesterone_scan_ng_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Progesterone (ng/mL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")

#FSH
c3 <- ggscatter(data_repo, x = "fsh_scan_miu_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none") 

#FSH facet
c3a <- ggscatter(data_repo, x = "fsh_scan_miu_ml", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "FSH (mIU/mL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
    theme_bw() +
     theme(legend.position = "none")

#SHBG
c4 <- ggscatter(data_repo, x = "shbg_scan_nmol_l", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none")

#SHBG facet
c4a <- ggscatter(data_repo, x = "shbg_scan_nmol_l", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#DHEAS
c5 <- ggscatter(data_repo, x = "dheas_scan_ug_dl", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none")


#DHEAS facet
c5a <- ggscatter(data_repo, x = "dheas_scan_ug_dl", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Testosterone
c6 <- ggscatter(data_repo, x = "testosterone_scan_ng_dl", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Grey Matter Volume") +
    theme(legend.position = "none")


#Testosterone facet
c6a <- ggscatter(data_repo, x = "testosterone_scan_ng_dl", y = "avg_t1_hipp", color = "repo_status",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Grey Matter Volume") +
    facet_grid(repo_status ~ ., scale = "free") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
(c1 + c1a)
(c2 + c2a)
(c3 + c3a)
(c4 + c4a)
(c5 + c5a)
(c6 + c6a)
```


All correlations are Spearman rank.

## Hormone Correlation by Men

```{r}
#SHBG
c1 <- ggscatter(data_men, x = "shbg_scan_nmol_l", y = "avg_t1_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "SHBG (nmol/L)", ylab = "Grey Matter Volume") +
     theme_bw() +
     theme(legend.position = "none")

#DHEAS
c2 <- ggscatter(data_men, x = "dheas_scan_ug_dl", y = "avg_t1_hipp",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "DHEAS (ug/dL)", ylab = "Grey Matter Volume") +
     theme_bw() +
     theme(legend.position = "none")

#Testosterone
c3 <- ggscatter(data_men, x = "testosterone_scan_ng_dl", y = "avg_t1_hipp", 
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Testosterone (ng/dL)", ylab = "Grey Matter Volume") +
     theme_bw() +
     theme(legend.position = "none")


#Present as patchwork
c1+c2+c3
```

All correlations are Pearson

# Behavior

## Overall

Check to see if T1 GMV has any relationship with SNAG data

```{r}
#Further filter for SNAG
#Separate for SNAG
data_loop <- data %>% 
  filter(loop_useable == "Yes")
data_maze <- data %>% 
  filter(maze_useable == "Yes")
data_dsp <- data %>% 
  filter(dsp_useable == "Yes")


#Separate for women and men
data_loop_women <- data %>% 
  filter(sex == "Female", loop_useable == "Yes") 
data_maze_women <- data %>% 
  filter(sex == "Female", maze_useable == "Yes") 
data_dsp_women <- data %>% 
  filter(sex == "Female", dsp_useable == "Yes") 

data_loop_men <- data %>% 
  filter(sex == "Male", loop_useable == "Yes")
data_maze_men <- data %>% 
  filter(sex == "Male", maze_useable == "Yes")
data_dsp_men <- data %>% 
  filter(sex == "Male", dsp_useable == "Yes")
```


```{r distributions-qqplots}
#LOOP: normally distributed, no need to transform
h1 <- ggplot(data = data_loop, aes(x = loop_pe_avg_m)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Position Error (m)",
       y = "Count",
       title = "LOOP: Histogram \nPosition Error")
h2 <- ggplot(data = data_loop, aes(x = loop_de_avg_degree)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Degrees Traveled",
       y = "Count",
       title = "LOOP: Histogram \nDegrees Traveled")
h1a <- ggqqplot(data = data_loop$loop_pe_avg_m) +
  labs(title = "LOOP: QQ-plot \nPosition Error")
h2a <- ggqqplot(data = data_loop$loop_de_avg_degree) +
  labs(title = "LOOP: QQ-plot \nDegrees Traveled")


#MAZE:right and left skewed, log transform
h3 <- ggplot(data = data_maze, aes(x = maze_accuracy_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nAccuracy")
h3a <- ggplot(data = data_maze, aes(x = log(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nLog Accuracy")
h3b <- ggplot(data = data_maze, aes(x = sqrt(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Accuracy")
h3q <- ggqqplot(data = data_maze$maze_accuracy_pct) +
  labs(title = "MAZE: QQ-plot \nAccuracy")
h3aq <- ggqqplot(data = log(data_maze$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nLog Accuracy")
h3bq <- ggqqplot(data = sqrt(data_maze$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nSqrt Accuracy")

h4 <- ggplot(data = data_maze, aes(x = maze_moves)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nMoves")
h4a <- ggplot(data = data_maze, aes(x = log(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nLog Moves")
h4b <- ggplot(data = data_maze, aes(x = sqrt(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Moves")
h4q <- ggqqplot(data = data_maze$maze_moves) +
  labs(title = "MAZE: QQ-plot \nMoves")
h4aq <- ggqqplot(data = log(data_maze$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nLog Moves")
h4bq <- ggqqplot(data = sqrt(data_maze$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nSqrt Moves")



#DSP: slight left and right skew so apply transformation
h5 <- ggplot(data = data_dsp, aes(x = dsp_success_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSuccess")
h5a <- ggplot(data = data_dsp, aes(x = log(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Success")
h5b <- ggplot(data = data_dsp, aes(x = sqrt(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Success")
h5q <- ggqqplot(data = data_dsp$dsp_success_pct) +
  labs(title = "DSP: QQ-plot \nSuccess")
h5aq <- ggqqplot(data = log(data_dsp$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nLog Success")
h5bq <- ggqqplot(data = sqrt(data_dsp$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Success")


h6 <- ggplot(data = data_dsp, aes(x = dsp_si_true_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSolution Index")
h6a <- ggplot(data = data_dsp, aes(x = log(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Solution Index")
h6b <- ggplot(data = data_dsp, aes(x = sqrt(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Solution Index")
h6q <- ggqqplot(data = data_dsp$dsp_si_true_pct) +
  labs(title = "DSP: QQ-plot \nSolution Index")
h6aq <- ggqqplot(data = log(data_dsp$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nLog Solution Index")
h6bq <- ggqqplot(data = sqrt(data_dsp$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Solution Index")

#Present

#LOOP
(h1+h2)/(h1a+h2a)
#MAZE
(h3+h3a+h3b)/(h3q+h3aq+h3bq)
(h4+h4a+h4b)/(h4q+h4aq+h4bq)
#DSP
(h5+h5a+h5b)/(h5q+h5aq+h5bq)
(h6+h6a+h6b)/(h6q+h6aq+h6bq)
```

LOOP dependent variables appear normally distributed, but MAZE and DSP variables have slight skews. I applied log and square root transformations to these variables in MAZE and DSP to see whether the observed distribution looks normal.

We can check Shapiro-Wilk's to see if normality is violated for raw values and after transformation using log and square root.


```{r shapiro-check, results='hide'}
## is the DV significantly different than normal?

#LOOP
shapiro.test(data_loop$loop_pe_avg_m) #no
shapiro.test(data_loop$loop_de_avg_degree) #no

#MAZE
shapiro.test(data_maze$maze_accuracy_pct) #yes
shapiro.test(data_maze$maze_moves) #yes

shapiro.test(log(data_maze$maze_accuracy_pct)) #yes
shapiro.test(log(data_maze$maze_moves)) #yes

shapiro.test(sqrt(data_maze$maze_accuracy_pct)) #yes
shapiro.test(sqrt(data_maze$maze_moves)) #yes

#DSP
shapiro.test(data_dsp$dsp_success_pct) #no
shapiro.test(data_dsp$dsp_si_true_pct) #yes

shapiro.test(log(data_dsp$dsp_success_pct)) #yes
shapiro.test(log(data_dsp$dsp_si_true_pct)) #yes

shapiro.test(sqrt(data_dsp$dsp_success_pct)) #yes
shapiro.test(sqrt(data_dsp$dsp_si_true_pct)) #yes
```

Shapiro-Wilk's test reveal that LOOP dependent variables are normally distributed, but MAZE dependent variables and DSP solution index are not even after log and square root transformations. Thus, all correlations with GMV for these DV will be spearman rank correlations.


```{r log-transformation}
data_maze_log <- data_maze %>% 
  mutate_at(vars(maze_accuracy_pct,maze_moves), log)

data_dsp_log <- data_dsp %>% 
  mutate_at(vars(dsp_si_true_pct), log)
```


## By Women

```{r women-distributions-qqplots}
#LOOP: normally distributed, no need to transform
h1 <- ggplot(data = data_loop_women, aes(x = loop_pe_avg_m)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Position Error (m)",
       y = "Count",
       title = "LOOP: Histogram \nPosition Error")
h2 <- ggplot(data = data_loop_women, aes(x = loop_de_avg_degree)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Degrees Traveled",
       y = "Count",
       title = "LOOP: Histogram \nDegrees Traveled")
h1a <- ggqqplot(data = data_loop_women$loop_pe_avg_m) +
  labs(title = "LOOP: QQ-plot \nPosition Error")
h2a <- ggqqplot(data = data_loop_women$loop_de_avg_degree) +
  labs(title = "LOOP: QQ-plot \nDegrees Traveled")


#MAZE:right and left skewed, log transform
h3 <- ggplot(data = data_maze_women, aes(x = maze_accuracy_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nAccuracy")
h3a <- ggplot(data = data_maze_women, aes(x = log(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nLog Accuracy")
h3b <- ggplot(data = data_maze_women, aes(x = sqrt(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Accuracy")
h3q <- ggqqplot(data = data_maze_women$maze_accuracy_pct) +
  labs(title = "MAZE: QQ-plot \nAccuracy")
h3aq <- ggqqplot(data = log(data_maze_women$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nLog Accuracy")
h3bq <- ggqqplot(data = sqrt(data_maze_women$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nSqrt Accuracy")

h4 <- ggplot(data = data_maze_women, aes(x = maze_moves)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nMoves")
h4a <- ggplot(data = data_maze_women, aes(x = log(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nLog Moves")
h4b <- ggplot(data = data_maze_women, aes(x = sqrt(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Moves")
h4q <- ggqqplot(data = data_maze_women$maze_moves) +
  labs(title = "MAZE: QQ-plot \nMoves")
h4aq <- ggqqplot(data = log(data_maze_women$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nLog Moves")
h4bq <- ggqqplot(data = sqrt(data_maze_women$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nSqrt Moves")



#DSP: slight left and right skew so apply transformation
h5 <- ggplot(data = data_dsp_women, aes(x = dsp_success_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSuccess")
h5a <- ggplot(data = data_dsp_women, aes(x = log(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Success")
h5b <- ggplot(data = data_dsp_women, aes(x = sqrt(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Success")
h5q <- ggqqplot(data = data_dsp_women$dsp_success_pct) +
  labs(title = "DSP: QQ-plot \nSuccess")
h5aq <- ggqqplot(data = log(data_dsp_women$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nLog Success")
h5bq <- ggqqplot(data = sqrt(data_dsp_women$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Success")


h6 <- ggplot(data = data_dsp_women, aes(x = dsp_si_true_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSolution Index")
h6a <- ggplot(data = data_dsp_women, aes(x = log(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Solution Index")
h6b <- ggplot(data = data_dsp_women, aes(x = sqrt(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Solution Index")
h6q <- ggqqplot(data = data_dsp_women$dsp_si_true_pct) +
  labs(title = "DSP: QQ-plot \nSolution Index")
h6aq <- ggqqplot(data = log(data_dsp_women$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nLog Solution Index")
h6bq <- ggqqplot(data = sqrt(data_dsp_women$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Solution Index")

#Present

#LOOP
(h1+h2)/(h1a+h2a)
#MAZE
(h3+h3a+h3b)/(h3q+h3aq+h3bq)
(h4+h4a+h4b)/(h4q+h4aq+h4bq)
#DSP
(h5+h5a+h5b)/(h5q+h5aq+h5bq)
(h6+h6a+h6b)/(h6q+h6aq+h6bq)
```

Like the overall distributions, LOOP DVs look normal but MAZE and DSP variables appear skewed.

We can check Shapiro-Wilk's to see if normality is violated for raw values and after transformation using log and square root.


```{r women-shapiro-check, results='hide'}
## is the DV significantly diffrent than normal?

#LOOP
shapiro.test(data_loop_women$loop_pe_avg_m) #no
shapiro.test(data_loop_women$loop_de_avg_degree) #no

#MAZE
shapiro.test(data_maze_women$maze_accuracy_pct) #yes
shapiro.test(data_maze_women$maze_moves) #yes

shapiro.test(log(data_maze_women$maze_accuracy_pct)) #yes
shapiro.test(log(data_maze_women$maze_moves)) #yes

shapiro.test(sqrt(data_maze_women$maze_accuracy_pct)) #yes
shapiro.test(sqrt(data_maze_women$maze_moves)) #yes

#DSP
shapiro.test(data_dsp_women$dsp_success_pct) #no
shapiro.test(data_dsp_women$dsp_si_true_pct) #yes

shapiro.test(log(data_dsp_women$dsp_success_pct)) #yes
shapiro.test(log(data_dsp_women$dsp_si_true_pct)) #yes

shapiro.test(sqrt(data_dsp_women$dsp_success_pct)) #yes
shapiro.test(sqrt(data_dsp_women$dsp_si_true_pct)) #yes
```

DSP wayfinding success was not significantly different than normal. MAZ and DSP solution index was still skewed after transformations, so correlations with DSP solution index for women will be using Spearman rank correlation.


## By Men

```{r men-distributions-qqplots}
#LOOP: normally distributed, no need to transform
h1 <- ggplot(data = data_loop_men, aes(x = loop_pe_avg_m)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Position Error (m)",
       y = "Count",
       title = "LOOP: Histogram \nPosition Error")
h2 <- ggplot(data = data_loop_men, aes(x = loop_de_avg_degree)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Average Degrees Traveled",
       y = "Count",
       title = "LOOP: Histogram \nDegrees Traveled")
h1a <- ggqqplot(data = data_loop_men$loop_pe_avg_m) +
  labs(title = "LOOP: QQ-plot \nPosition Error")
h2a <- ggqqplot(data = data_loop_men$loop_de_avg_degree) +
  labs(title = "LOOP: QQ-plot \nDegrees Traveled")


#MAZE:right and left skewed, log transform
h3 <- ggplot(data = data_maze_men, aes(x = maze_accuracy_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nAccuracy")
h3a <- ggplot(data = data_maze_men, aes(x = log(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nLog Accuracy")
h3b <- ggplot(data = data_maze_men, aes(x = sqrt(maze_accuracy_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Accuracy")
h3q <- ggqqplot(data = data_maze_men$maze_accuracy_pct) +
  labs(title = "MAZE: QQ-plot \nAccuracy")
h3aq <- ggqqplot(data = log(data_maze_men$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nLog Accuracy")
h3bq <- ggqqplot(data = sqrt(data_maze_men$maze_accuracy_pct)) +
  labs(title = "MAZE: QQ-plot \nSqrt Accuracy")

h4 <- ggplot(data = data_maze_men, aes(x = maze_moves)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nMoves")
h4a <- ggplot(data = data_maze_men, aes(x = log(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nLog Moves")
h4b <- ggplot(data = data_maze_men, aes(x = sqrt(maze_moves))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Number of Moves",
       y = "Count",
       title = "MAZE: Histogram \nSqrt Moves")
h4q <- ggqqplot(data = data_maze_men$maze_moves) +
  labs(title = "MAZE: QQ-plot \nMoves")
h4aq <- ggqqplot(data = log(data_maze_men$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nLog Moves")
h4bq <- ggqqplot(data = sqrt(data_maze_men$maze_moves)) +
  labs(title = "MAZE: QQ-plot \nSqrt Moves")



#DSP: slight left and right skew so apply transformation
h5 <- ggplot(data = data_dsp_men, aes(x = dsp_success_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSuccess")
h5a <- ggplot(data = data_dsp_men, aes(x = log(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Success")
h5b <- ggplot(data = data_dsp_men, aes(x = sqrt(dsp_success_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Wayfinding Success (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Success")
h5q <- ggqqplot(data = data_dsp_men$dsp_success_pct) +
  labs(title = "DSP: QQ-plot \nSuccess")
h5aq <- ggqqplot(data = log(data_dsp_men$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nLog Success")
h5bq <- ggqqplot(data = sqrt(data_dsp_men$dsp_success_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Success")


h6 <- ggplot(data = data_dsp_men, aes(x = dsp_si_true_pct)) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSolution Index")
h6a <- ggplot(data = data_dsp_men, aes(x = log(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nLog Solution Index")
h6b <- ggplot(data = data_dsp_men, aes(x = sqrt(dsp_si_true_pct))) +
  geom_histogram(alpha = 0.5, color = "black", position = "identity") +
  labs(x = "Solution Index (%)",
       y = "Count",
       title = "DSP: Histogram \nSqrt Solution Index")
h6q <- ggqqplot(data = data_dsp_men$dsp_si_true_pct) +
  labs(title = "DSP: QQ-plot \nSolution Index")
h6aq <- ggqqplot(data = log(data_dsp_men$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nLog Solution Index")
h6bq <- ggqqplot(data = sqrt(data_dsp_men$dsp_si_true_pct)) +
  labs(title = "DSP: QQ-plot \nSqrt Solution Index")

#Present

#LOOP
(h1+h2)/(h1a+h2a)
#MAZE
(h3+h3a+h3b)/(h3q+h3aq+h3bq)
(h4+h4a+h4b)/(h4q+h4aq+h4bq)
#DSP
(h5+h5a+h5b)/(h5q+h5aq+h5bq)
(h6+h6a+h6b)/(h6q+h6aq+h6bq)
```

Like the overall distributions, LOOP DVs look normal but MAZE and DSP variables appear skewed.


```{r men-shapiro-check, results='hide'}
## is the DV significantly diffrent than normal?

#LOOP
shapiro.test(data_loop_men$loop_pe_avg_m) #no
shapiro.test(data_loop_men$loop_de_avg_degree) #no

#MAZE
shapiro.test(data_maze_men$maze_accuracy_pct) #yes
shapiro.test(data_maze_men$maze_moves) #no

shapiro.test(log(data_maze_men$maze_accuracy_pct)) #yes
shapiro.test(log(data_maze_men$maze_moves)) #yes

shapiro.test(sqrt(data_maze_men$maze_accuracy_pct)) #yes
shapiro.test(sqrt(data_maze_men$maze_moves)) #yes

#DSP
shapiro.test(data_dsp_men$dsp_success_pct) #no
shapiro.test(data_dsp_men$dsp_si_true_pct) #yes

shapiro.test(log(data_dsp_men$dsp_success_pct)) #no
shapiro.test(log(data_dsp_men$dsp_si_true_pct)) #yes
```

LOOP and DSP success and MAZE moves variables were not significantly different than normal, but MAZE accuracy and DSP soluion index was. Despite transformations, MAZE moves and DSP solution index accuracy was still pretty skewed so Spearman rank correlations will be applied for associations with GMV for men here.

## LOOP

### Position Error

```{r}
#All
c1 <- ggscatter(data_loop, x = "avg_t1_hipp", y = "loop_pe_avg_m", color = "repo_status_scan",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nPosition Error (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 


#By sex
c1a <- ggscatter(data_loop, x = "avg_t1_hipp", y = "loop_pe_avg_m", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nPosition Error (m)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")


#Present
c1+c1a
```
All others are Pearson correlations.

### Degrees Traveled

```{r}
#all
c1 <- ggscatter(data_loop, x = "avg_t1_hipp", y = "loop_de_avg_degree", color = "repo_status_scan",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_loop, x = "avg_t1_hipp", y = "loop_de_avg_degree", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nDegrees Traveled") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

c1+c1a
```

All correlations are pearson

## MAZE

### Accuracy

```{r}
#CA1
c1 <- ggscatter(data_maze, x = "avg_t1_hipp", y = "maze_accuracy_pct", color = "repo_status_scan",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

c1a <- ggscatter(data_maze, x = "avg_t1_hipp", y = "maze_accuracy_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

c1+c1a
```

All correlations are Spearman

### Moves

```{r}
#overall
c1 <- ggscatter(data_maze, x = "avg_t1_hipp", y = "maze_moves", color = "repo_status_scan",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nNumber of Moves") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_maze, x = "avg_t1_hipp", y = "maze_moves", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Subfield Volume", ylab = "Averaged \nNumber of Moves") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

c1+c1a
```


Women and men correlations are pearson. 

## DSP

### Wayfinding Success

```{r}
#all
c1 <- ggscatter(data_dsp, x = "avg_t1_hipp", y = "dsp_success_pct", color = "repo_status_scan",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp, x = "avg_t1_hipp", y = "dsp_success_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nWayfinding Success (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

c1+c1a
```

All correlations were pearson. Overall, lower T1 hipp GMV was associated with lower wayfinding success in DSP (*p* < 0.05). This pattern was also observed marginally in men (*p* = 0.055), but not in women (*p* = 0.89).

### Solution Index

```{r}
#all
c1 <- ggscatter(data_dsp, x = "avg_t1_hipp", y = "dsp_si_true_pct", color = "repo_status_scan",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
    theme(legend.position = "top", legend.title=element_blank()) 

#sex
c1a <- ggscatter(data_dsp, x = "avg_t1_hipp", y = "dsp_si_true_pct", color = "sex",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Averaged \nSolution Index (%)") +
    facet_wrap(. ~ sex, scale = "free", ncol = 1) +
     theme_bw() +
     theme(legend.position = "none")

c1+c1a
```

All correlations are spearman. For women, T1 volume was also marginally associated with DSP solution index (Spearman, *p* = 0.079).


# Summary

Results reveal that:

- For all HAS participants who had a T1 scan, Based on structural comparisons and after correcting for TIV, women have larger T1 hippocampal volume than men (*p* < 0.001). Sex hormones for women were log-transformed and correlations among women were carried out using Spearman rank. All correlations with men were Pearson. No significant correlations between hormone concentrations and T1 hippocampal volume were observed for any groups.

- For LOOP, women with lower GMV correlated with lower degrees traveled (Pearson, *p* < 0.05).  Overall, lower T1 hipp GMV was associated with lower wayfinding success in DSP (Pearson, *p* < 0.05). This pattern was also observed marginally in men (Pearson, *p* = 0.055), but not in women (Pearson, *p* = 0.89). DSP solution index was marginally positively associated with women with higher GMV (Spearman, *p* = 0.079).

Future:

- Will need to assess hormone-brain relationships among those with specific behavioral data


